==================== JOB STARTED ====================
Start time: 2025年 08月 04日 星期一 19:27:51 CST
Working directory: /home/fanggang_1/hk/nnunet/nnUNet
Job ID: 4415.mgt
Mon Aug  4 19:27:51 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.129.03             Driver Version: 535.129.03   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA GeForce RTX 4090        Off | 00000000:34:00.0 Off |                  Off |
|100%   89C    P2             319W / 450W |  12322MiB / 24564MiB |     99%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA GeForce RTX 4090        Off | 00000000:8E:00.0 Off |                  Off |
|  0%   41C    P8              28W / 450W |     34MiB / 24564MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A      3108      G   /usr/libexec/Xorg                             4MiB |
|    0   N/A  N/A    907242      C   python                                    12302MiB |
|    1   N/A  N/A      3108      G   /usr/libexec/Xorg                             9MiB |
|    1   N/A  N/A      3198      G   /usr/bin/gnome-shell                          8MiB |
+---------------------------------------------------------------------------------------+
Running nnUNet command with real-time logging...
[nnunet.lightweight_unet] INFO: 🚀 构建轻量级PlainConvUNet: 阶段数=4, 类别数=14
[nnunet.lightweight_unet] INFO: ⚡ 轻量级选项: 金字塔池化=True, 瓶颈比例=0.25
[nnunet.lightweight_unet] INFO: 🔧 使用轻量级编码器: 金字塔池化阶段=[1, 2]
[nnunet.lightweight_encoder] INFO: 🚀 初始化 LightweightPlainConvEncoder: 阶段数=4, 金字塔池化阶段=[1, 2], 瓶颈比例=0.25
[nnunet.lightweight_encoder] INFO: 🚀 初始化 PlainConvEncoder (轻量级模式): 阶段数=4, 使用金字塔池化=True
[nnunet.lightweight_conv] INFO: 🏗️ 初始化 LightweightStackedConvBlocks: 层数=1, 输入通道=1, 输出通道=16, 瓶颈=True
[nnunet.lightweight_conv] INFO: ✨ 初始化 LightweightConvDropoutNormReLU: 输入通道=1, 输出通道=16, 瓶颈=True, 深度可分离=True
[nnunet.lightweight_conv] INFO: 🏗️ 初始化 LightweightStackedConvBlocks: 层数=1, 输入通道=16, 输出通道=32, 瓶颈=True
[nnunet.lightweight_conv] INFO: ✨ 初始化 LightweightConvDropoutNormReLU: 输入通道=16, 输出通道=32, 瓶颈=True, 深度可分离=True
[nnunet.lightweight_conv] INFO: 🏗️ 初始化 LightweightStackedConvBlocks: 层数=2, 输入通道=32, 输出通道=64, 瓶颈=True
[nnunet.lightweight_conv] INFO: ✨ 初始化 LightweightConvDropoutNormReLU: 输入通道=32, 输出通道=64, 瓶颈=True, 深度可分离=True
[nnunet.lightweight_conv] INFO: ✨ 初始化 LightweightConvDropoutNormReLU: 输入通道=64, 输出通道=64, 瓶颈=True, 深度可分离=True
[nnunet.lightweight_conv] INFO: 🏗️ 初始化 LightweightStackedConvBlocks: 层数=2, 输入通道=64, 输出通道=128, 瓶颈=True
[nnunet.lightweight_conv] INFO: ✨ 初始化 LightweightConvDropoutNormReLU: 输入通道=64, 输出通道=128, 瓶颈=True, 深度可分离=True
[nnunet.lightweight_conv] INFO: ✨ 初始化 LightweightConvDropoutNormReLU: 输入通道=128, 输出通道=128, 瓶颈=True, 深度可分离=True

#######################################################################
Please cite the following paper when using nnU-Net:
Isensee, F., Jaeger, P. F., Kohl, S. A., Petersen, J., & Maier-Hein, K. H. (2021). nnU-Net: a self-configuring method for deep learning-based biomedical image segmentation. Nature methods, 18(2), 203-211.
#######################################################################

perform_everything_on_device=True is only supported for cuda devices! Setting this to False
⚠️  检测到torch.compile前缀，正在修复权重...
Running in non-multiprocessing mode
There are 200 cases in the source folder
I am processing 0 out of 1 (max process ID is 0, we start counting with 0!)
There are 200 cases that I would like to predict

=== Processing case 1/200: FLARETs_0001_0000.nii.gz ===
File FLARETs_0001_0000.nii.gz: 31.51 MB
Total file size: 31.51 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.32s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:16,  2.65it/s]  4%|▍         | 2/45 [00:00<00:15,  2.81it/s]  7%|▋         | 3/45 [00:01<00:14,  2.86it/s]  9%|▉         | 4/45 [00:01<00:14,  2.91it/s] 11%|█         | 5/45 [00:01<00:13,  2.93it/s] 13%|█▎        | 6/45 [00:02<00:13,  2.95it/s] 16%|█▌        | 7/45 [00:02<00:12,  2.97it/s] 18%|█▊        | 8/45 [00:02<00:12,  2.97it/s] 20%|██        | 9/45 [00:03<00:12,  2.99it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.01it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.01it/s] 27%|██▋       | 12/45 [00:04<00:10,  3.00it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.00it/s] 31%|███       | 14/45 [00:04<00:10,  3.00it/s] 33%|███▎      | 15/45 [00:05<00:09,  3.00it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.00it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.01it/s] 40%|████      | 18/45 [00:06<00:08,  3.02it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.02it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.02it/s] 47%|████▋     | 21/45 [00:07<00:07,  3.00it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.01it/s] 51%|█████     | 23/45 [00:07<00:07,  3.01it/s] 53%|█████▎    | 24/45 [00:08<00:06,  3.01it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.00it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.01it/s] 60%|██████    | 27/45 [00:09<00:05,  3.01it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.02it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.01it/s] 67%|██████▋   | 30/45 [00:10<00:04,  3.01it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.01it/s] 71%|███████   | 32/45 [00:10<00:04,  2.97it/s] 73%|███████▎  | 33/45 [00:11<00:04,  2.97it/s] 76%|███████▌  | 34/45 [00:11<00:03,  2.97it/s] 78%|███████▊  | 35/45 [00:11<00:03,  2.97it/s] 80%|████████  | 36/45 [00:12<00:03,  2.98it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.98it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.99it/s] 87%|████████▋ | 39/45 [00:13<00:02,  2.99it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.00it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.00it/s] 93%|█████████▎| 42/45 [00:14<00:00,  3.00it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.00it/s] 98%|█████████▊| 44/45 [00:14<00:00,  2.99it/s]100%|██████████| 45/45 [00:15<00:00,  3.00it/s]100%|██████████| 45/45 [00:15<00:00,  2.99it/s]
Inference completed in 15.22s
Step 3/4: Postprocessing (resampling to original resolution)...

======================================================================
  深度多线程后处理优化
======================================================================
物理CPU核心数: 16
逻辑CPU核心数: 16
系统内存: 251.5 GB
重采样线程数: 8
后处理线程数: 8
文件I/O线程数: 2
======================================================================
✨ 优化策略:
  • 并行重采样 - 按类别分割处理
  • 并行后处理 - 按空间分块处理
  • 并行文件保存 - 分割和概率同时保存
  • 内存优化 - 及时释放中间结果
======================================================================

🚀 启动深度多线程后处理优化...
初始内存使用: 1.13GB
输入形状: (14, 204, 210, 210)
目标形状: (102, 512, 512)
预估内存需求: 1.39GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.4380952380952383, 2.4380952380952383]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.58s
重采样后内存: 2.53GB (增加: 1.40GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 102, 512, 512), 内存占用: 1.39GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.25GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.06s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.58s
Case FLARETs_0001_0000.nii.gz completed in 20.12s total (preprocess: 2.32s, inference: 15.22s, postprocess: 2.58s)
Step 4/4: Ready for next case...

=== Processing case 2/200: FLARETs_0002_0000.nii.gz ===
File FLARETs_0002_0000.nii.gz: 35.89 MB
Total file size: 35.89 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.28s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  3.07it/s] 11%|█         | 2/18 [00:00<00:05,  3.05it/s] 17%|█▋        | 3/18 [00:00<00:04,  3.07it/s] 22%|██▏       | 4/18 [00:01<00:04,  3.06it/s] 28%|██▊       | 5/18 [00:01<00:04,  3.06it/s] 33%|███▎      | 6/18 [00:01<00:03,  3.06it/s] 39%|███▉      | 7/18 [00:02<00:03,  3.06it/s] 44%|████▍     | 8/18 [00:02<00:03,  3.05it/s] 50%|█████     | 9/18 [00:02<00:02,  3.06it/s] 56%|█████▌    | 10/18 [00:03<00:02,  3.06it/s] 61%|██████    | 11/18 [00:03<00:02,  3.06it/s] 67%|██████▋   | 12/18 [00:03<00:01,  3.06it/s] 72%|███████▏  | 13/18 [00:04<00:01,  3.04it/s] 78%|███████▊  | 14/18 [00:04<00:01,  3.05it/s] 83%|████████▎ | 15/18 [00:04<00:00,  3.04it/s] 89%|████████▉ | 16/18 [00:05<00:00,  3.04it/s] 94%|█████████▍| 17/18 [00:05<00:00,  3.03it/s]100%|██████████| 18/18 [00:05<00:00,  3.00it/s]100%|██████████| 18/18 [00:05<00:00,  3.04it/s]
Inference completed in 5.95s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.16GB
输入形状: (14, 118, 216, 216)
目标形状: (118, 512, 512)
预估内存需求: 1.61GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.3703703703703702, 2.3703703703703702]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.95s
重采样后内存: 2.77GB (增加: 1.61GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 118, 512, 512), 内存占用: 1.61GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.49s
处理完成后内存: 1.18GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.48s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.94s
Case FLARETs_0002_0000.nii.gz completed in 12.17s total (preprocess: 3.28s, inference: 5.95s, postprocess: 2.94s)
Step 4/4: Ready for next case...

=== Processing case 3/200: FLARETs_0003_0000.nii.gz ===
File FLARETs_0003_0000.nii.gz: 41.29 MB
Total file size: 41.29 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.68s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:12,  2.88it/s]  6%|▌         | 2/36 [00:00<00:11,  2.88it/s]  8%|▊         | 3/36 [00:01<00:11,  2.92it/s] 11%|█         | 4/36 [00:01<00:11,  2.91it/s] 14%|█▍        | 5/36 [00:01<00:10,  2.89it/s] 17%|█▋        | 6/36 [00:02<00:10,  2.87it/s] 19%|█▉        | 7/36 [00:02<00:10,  2.87it/s] 22%|██▏       | 8/36 [00:02<00:09,  2.86it/s] 25%|██▌       | 9/36 [00:03<00:09,  2.84it/s] 28%|██▊       | 10/36 [00:03<00:09,  2.84it/s] 31%|███       | 11/36 [00:03<00:08,  2.84it/s] 33%|███▎      | 12/36 [00:04<00:08,  2.84it/s] 36%|███▌      | 13/36 [00:04<00:08,  2.84it/s] 39%|███▉      | 14/36 [00:04<00:07,  2.84it/s] 42%|████▏     | 15/36 [00:05<00:07,  2.84it/s] 44%|████▍     | 16/36 [00:05<00:07,  2.84it/s] 47%|████▋     | 17/36 [00:05<00:06,  2.84it/s] 50%|█████     | 18/36 [00:06<00:06,  2.85it/s] 53%|█████▎    | 19/36 [00:06<00:05,  2.87it/s] 56%|█████▌    | 20/36 [00:06<00:05,  2.87it/s] 58%|█████▊    | 21/36 [00:07<00:05,  2.87it/s] 61%|██████    | 22/36 [00:07<00:04,  2.86it/s] 64%|██████▍   | 23/36 [00:08<00:04,  2.86it/s] 67%|██████▋   | 24/36 [00:08<00:04,  2.92it/s] 69%|██████▉   | 25/36 [00:08<00:03,  2.94it/s] 72%|███████▏  | 26/36 [00:09<00:03,  2.96it/s] 75%|███████▌  | 27/36 [00:09<00:03,  2.98it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.01it/s] 81%|████████  | 29/36 [00:10<00:02,  3.02it/s] 83%|████████▎ | 30/36 [00:10<00:01,  3.02it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.00it/s] 89%|████████▉ | 32/36 [00:11<00:01,  3.01it/s] 92%|█████████▏| 33/36 [00:11<00:00,  3.01it/s] 94%|█████████▍| 34/36 [00:11<00:00,  2.99it/s] 97%|█████████▋| 35/36 [00:12<00:00,  3.00it/s]100%|██████████| 36/36 [00:12<00:00,  3.01it/s]100%|██████████| 36/36 [00:12<00:00,  2.91it/s]
Inference completed in 12.40s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.29GB
输入形状: (14, 173, 210, 210)
目标形状: (144, 512, 512)
预估内存需求: 1.97GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8323699421965318, 2.4380952380952383, 2.4380952380952383]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.25s
重采样后内存: 3.22GB (增加: 1.93GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 144, 512, 512), 内存占用: 1.97GB
分块策略: 块大小=9, 预计块数=16
创建了 16 个处理块，每块约 9 切片
后处理进度: 4/16 块 (25.0%)
后处理进度: 8/16 块 (50.0%)
后处理进度: 12/16 块 (75.0%)
后处理进度: 16/16 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.50s
处理完成后内存: 1.32GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.79s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.25s
Case FLARETs_0003_0000.nii.gz completed in 18.33s total (preprocess: 2.68s, inference: 12.40s, postprocess: 3.25s)
Step 4/4: Ready for next case...

=== Processing case 4/200: FLARETs_0004_0000.nii.gz ===
File FLARETs_0004_0000.nii.gz: 39.17 MB
Total file size: 39.17 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.47s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:08,  3.05it/s]  7%|▋         | 2/27 [00:00<00:08,  3.07it/s] 11%|█         | 3/27 [00:00<00:07,  3.08it/s] 15%|█▍        | 4/27 [00:01<00:07,  3.08it/s] 19%|█▊        | 5/27 [00:01<00:07,  3.08it/s] 22%|██▏       | 6/27 [00:01<00:06,  3.08it/s] 26%|██▌       | 7/27 [00:02<00:06,  3.07it/s] 30%|██▉       | 8/27 [00:02<00:06,  3.08it/s] 33%|███▎      | 9/27 [00:02<00:05,  3.08it/s] 37%|███▋      | 10/27 [00:03<00:05,  3.07it/s] 41%|████      | 11/27 [00:03<00:05,  3.08it/s] 44%|████▍     | 12/27 [00:03<00:04,  3.07it/s] 48%|████▊     | 13/27 [00:04<00:04,  3.08it/s] 52%|█████▏    | 14/27 [00:04<00:04,  3.09it/s] 56%|█████▌    | 15/27 [00:04<00:03,  3.08it/s] 59%|█████▉    | 16/27 [00:05<00:03,  3.07it/s] 63%|██████▎   | 17/27 [00:05<00:03,  3.08it/s] 67%|██████▋   | 18/27 [00:05<00:02,  3.08it/s] 70%|███████   | 19/27 [00:06<00:02,  3.07it/s] 74%|███████▍  | 20/27 [00:06<00:02,  3.07it/s] 78%|███████▊  | 21/27 [00:06<00:01,  3.06it/s] 81%|████████▏ | 22/27 [00:07<00:01,  3.06it/s] 85%|████████▌ | 23/27 [00:07<00:01,  3.06it/s] 89%|████████▉ | 24/27 [00:07<00:00,  3.06it/s] 93%|█████████▎| 25/27 [00:08<00:00,  3.06it/s] 96%|█████████▋| 26/27 [00:08<00:00,  3.07it/s]100%|██████████| 27/27 [00:08<00:00,  3.06it/s]100%|██████████| 27/27 [00:08<00:00,  3.07it/s]
Inference completed in 8.82s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.28GB
输入形状: (14, 125, 216, 216)
目标形状: (125, 512, 512)
预估内存需求: 1.71GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.3703703703703702, 2.3703703703703702]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.92s
重采样后内存: 2.99GB (增加: 1.71GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 125, 512, 512), 内存占用: 1.71GB
分块策略: 块大小=7, 预计块数=18
创建了 18 个处理块，每块约 7 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.51s
处理完成后内存: 1.31GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.47s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.90s
Case FLARETs_0004_0000.nii.gz completed in 15.19s total (preprocess: 3.47s, inference: 8.82s, postprocess: 2.90s)
Step 4/4: Ready for next case...

=== Processing case 5/200: FLARETs_0005_0000.nii.gz ===
File FLARETs_0005_0000.nii.gz: 39.91 MB
Total file size: 39.91 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.71s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:08,  3.08it/s]  7%|▋         | 2/27 [00:00<00:08,  3.08it/s] 11%|█         | 3/27 [00:00<00:07,  3.08it/s] 15%|█▍        | 4/27 [00:01<00:07,  3.08it/s] 19%|█▊        | 5/27 [00:01<00:07,  3.07it/s] 22%|██▏       | 6/27 [00:01<00:06,  3.06it/s] 26%|██▌       | 7/27 [00:02<00:06,  3.06it/s] 30%|██▉       | 8/27 [00:02<00:06,  3.07it/s] 33%|███▎      | 9/27 [00:02<00:05,  3.05it/s] 37%|███▋      | 10/27 [00:03<00:05,  3.05it/s] 41%|████      | 11/27 [00:03<00:05,  3.06it/s] 44%|████▍     | 12/27 [00:03<00:04,  3.06it/s] 48%|████▊     | 13/27 [00:04<00:04,  3.07it/s] 52%|█████▏    | 14/27 [00:04<00:04,  3.07it/s] 56%|█████▌    | 15/27 [00:04<00:03,  3.08it/s] 59%|█████▉    | 16/27 [00:05<00:03,  3.07it/s] 63%|██████▎   | 17/27 [00:05<00:03,  3.07it/s] 67%|██████▋   | 18/27 [00:05<00:02,  3.06it/s] 70%|███████   | 19/27 [00:06<00:02,  3.07it/s] 74%|███████▍  | 20/27 [00:06<00:02,  3.07it/s] 78%|███████▊  | 21/27 [00:06<00:01,  3.04it/s] 81%|████████▏ | 22/27 [00:07<00:01,  3.05it/s] 85%|████████▌ | 23/27 [00:07<00:01,  3.05it/s] 89%|████████▉ | 24/27 [00:07<00:00,  3.05it/s] 93%|█████████▎| 25/27 [00:08<00:00,  3.06it/s] 96%|█████████▋| 26/27 [00:08<00:00,  3.05it/s]100%|██████████| 27/27 [00:08<00:00,  3.06it/s]100%|██████████| 27/27 [00:08<00:00,  3.06it/s]
Inference completed in 8.85s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.29GB
输入形状: (14, 124, 205, 205)
目标形状: (124, 512, 512)
预估内存需求: 1.70GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.497560975609756, 2.497560975609756]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.97s
重采样后内存: 2.98GB (增加: 1.70GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 124, 512, 512), 内存占用: 1.70GB
分块策略: 块大小=7, 预计块数=18
创建了 18 个处理块，每块约 7 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.51s
处理完成后内存: 1.32GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 2.53s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.94s
Case FLARETs_0005_0000.nii.gz completed in 13.49s total (preprocess: 1.71s, inference: 8.85s, postprocess: 2.94s)
Step 4/4: Ready for next case...

=== Processing case 6/200: FLARETs_0006_0000.nii.gz ===
File FLARETs_0006_0000.nii.gz: 43.05 MB
Total file size: 43.05 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.78s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.03it/s]  6%|▌         | 2/36 [00:00<00:11,  3.03it/s]  8%|▊         | 3/36 [00:00<00:10,  3.03it/s] 11%|█         | 4/36 [00:01<00:10,  3.03it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.04it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.05it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.03it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.04it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.05it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.04it/s] 31%|███       | 11/36 [00:03<00:08,  3.04it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.04it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.05it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.06it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.05it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.06it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.05it/s] 50%|█████     | 18/36 [00:05<00:05,  3.04it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.03it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.03it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.02it/s] 61%|██████    | 22/36 [00:07<00:04,  3.02it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.01it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.01it/s] 69%|██████▉   | 25/36 [00:08<00:03,  2.98it/s] 72%|███████▏  | 26/36 [00:08<00:03,  2.95it/s] 75%|███████▌  | 27/36 [00:08<00:03,  2.95it/s] 78%|███████▊  | 28/36 [00:09<00:02,  2.92it/s] 81%|████████  | 29/36 [00:09<00:02,  2.92it/s] 83%|████████▎ | 30/36 [00:09<00:02,  2.93it/s] 86%|████████▌ | 31/36 [00:10<00:01,  2.93it/s] 89%|████████▉ | 32/36 [00:10<00:01,  2.92it/s] 92%|█████████▏| 33/36 [00:11<00:01,  2.90it/s] 94%|█████████▍| 34/36 [00:11<00:00,  2.89it/s] 97%|█████████▋| 35/36 [00:11<00:00,  2.88it/s]100%|██████████| 36/36 [00:12<00:00,  2.89it/s]100%|██████████| 36/36 [00:12<00:00,  2.99it/s]
Inference completed in 12.10s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.44GB
输入形状: (14, 186, 213, 213)
目标形状: (155, 512, 512)
预估内存需求: 2.12GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8333333333333334, 2.403755868544601, 2.403755868544601]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.54s
重采样后内存: 3.56GB (增加: 2.12GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 155, 512, 512), 内存占用: 2.12GB
分块策略: 块大小=6, 预计块数=26
创建了 26 个处理块，每块约 6 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.48GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.18s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.70s
Case FLARETs_0006_0000.nii.gz completed in 18.58s total (preprocess: 2.78s, inference: 12.10s, postprocess: 3.70s)
Step 4/4: Ready for next case...

=== Processing case 7/200: FLARETs_0007_0000.nii.gz ===
File FLARETs_0007_0000.nii.gz: 61.12 MB
Total file size: 61.12 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.06s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.98it/s]  6%|▌         | 2/36 [00:00<00:11,  2.98it/s]  8%|▊         | 3/36 [00:01<00:11,  3.00it/s] 11%|█         | 4/36 [00:01<00:10,  3.01it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.03it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.04it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.04it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.03it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.02it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.03it/s] 31%|███       | 11/36 [00:03<00:08,  3.04it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.05it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.05it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.05it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.04it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.05it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.05it/s] 50%|█████     | 18/36 [00:05<00:05,  3.05it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.05it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.05it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.05it/s] 61%|██████    | 22/36 [00:07<00:04,  3.05it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.05it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.03it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.03it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.03it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.01it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.02it/s] 81%|████████  | 29/36 [00:09<00:02,  3.03it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.03it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.01it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.01it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.02it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.02it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.00it/s]100%|██████████| 36/36 [00:11<00:00,  3.02it/s]100%|██████████| 36/36 [00:11<00:00,  3.03it/s]
Inference completed in 11.92s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.40GB
输入形状: (14, 172, 208, 208)
目标形状: (215, 512, 512)
预估内存需求: 2.94GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.25, 2.4615384615384617, 2.4615384615384617]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.33s
重采样后内存: 4.34GB (增加: 2.94GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 215, 512, 512), 内存占用: 2.94GB
分块策略: 块大小=8, 预计块数=27
创建了 27 个处理块，每块约 8 切片
后处理进度: 6/27 块 (22.2%)
后处理进度: 12/27 块 (44.4%)
后处理进度: 18/27 块 (66.7%)
后处理进度: 24/27 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.81s
处理完成后内存: 1.46GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 4.20s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.66s
Case FLARETs_0007_0000.nii.gz completed in 21.64s total (preprocess: 5.06s, inference: 11.92s, postprocess: 4.66s)
Step 4/4: Ready for next case...

=== Processing case 8/200: FLARETs_0008_0000.nii.gz ===
File FLARETs_0008_0000.nii.gz: 58.60 MB
Total file size: 58.60 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.55s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.02it/s]  4%|▍         | 2/45 [00:00<00:14,  3.05it/s]  7%|▋         | 3/45 [00:00<00:13,  3.10it/s]  9%|▉         | 4/45 [00:01<00:13,  3.04it/s] 11%|█         | 5/45 [00:01<00:13,  3.03it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.03it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.02it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.05it/s] 20%|██        | 9/45 [00:02<00:11,  3.04it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.02it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.01it/s] 27%|██▋       | 12/45 [00:03<00:11,  3.00it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.00it/s] 31%|███       | 14/45 [00:04<00:10,  3.01it/s] 33%|███▎      | 15/45 [00:04<00:10,  2.99it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.01it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.01it/s] 40%|████      | 18/45 [00:05<00:08,  3.07it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.06it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.05it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.04it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.02it/s] 51%|█████     | 23/45 [00:07<00:07,  3.02it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.02it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.01it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.01it/s] 60%|██████    | 27/45 [00:08<00:05,  3.03it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.03it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.02it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.02it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.05it/s] 71%|███████   | 32/45 [00:10<00:04,  3.05it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.04it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.04it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.02it/s] 80%|████████  | 36/45 [00:11<00:02,  3.02it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.02it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.00it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.01it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.05it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.05it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.05it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.04it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.05it/s]100%|██████████| 45/45 [00:14<00:00,  3.04it/s]100%|██████████| 45/45 [00:14<00:00,  3.03it/s]
Inference completed in 14.90s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.53GB
输入形状: (14, 203, 220, 220)
目标形状: (203, 512, 512)
预估内存需求: 2.78GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.327272727272727, 2.327272727272727]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.11s
重采样后内存: 4.31GB (增加: 2.78GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 203, 512, 512), 内存占用: 2.78GB
分块策略: 块大小=8, 预计块数=26
创建了 26 个处理块，每块约 8 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.80s
处理完成后内存: 1.58GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.96s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.47s
Case FLARETs_0008_0000.nii.gz completed in 24.92s total (preprocess: 5.55s, inference: 14.90s, postprocess: 4.47s)
Step 4/4: Ready for next case...

=== Processing case 9/200: FLARETs_0009_0000.nii.gz ===
File FLARETs_0009_0000.nii.gz: 78.81 MB
Total file size: 78.81 MB
⚠️  File size (78.81 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0009.nii.gz with shape (512, 512, 251)
✅ Dummy results generated: FLARETs_0009.nii.gz
Case FLARETs_0009_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 10/200: FLARETs_0010_0000.nii.gz ===
File FLARETs_0010_0000.nii.gz: 66.92 MB
Total file size: 66.92 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.34s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.02it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.04it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.03it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.02it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.02it/s] 38%|███▊      | 6/16 [00:01<00:03,  2.99it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.01it/s] 50%|█████     | 8/16 [00:02<00:02,  3.00it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.01it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.01it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.02it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.02it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.03it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.03it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.03it/s]100%|██████████| 16/16 [00:05<00:00,  3.03it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]
Inference completed in 5.33s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.40GB
输入形状: (14, 176, 170, 170)
目标形状: (220, 512, 512)
预估内存需求: 3.01GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.25, 3.011764705882353, 3.011764705882353]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.41s
重采样后内存: 4.40GB (增加: 3.01GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 220, 512, 512), 内存占用: 3.01GB
分块策略: 块大小=9, 预计块数=25
创建了 25 个处理块，每块约 9 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.79s
处理完成后内存: 1.45GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 4.25s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.66s
Case FLARETs_0010_0000.nii.gz completed in 13.33s total (preprocess: 3.34s, inference: 5.33s, postprocess: 4.66s)
Step 4/4: Ready for next case...

=== Processing case 11/200: FLARETs_0011_0000.nii.gz ===
File FLARETs_0011_0000.nii.gz: 59.30 MB
Total file size: 59.30 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.63s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.93it/s]  6%|▌         | 2/36 [00:00<00:11,  2.98it/s]  8%|▊         | 3/36 [00:01<00:10,  3.00it/s] 11%|█         | 4/36 [00:01<00:10,  3.05it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.07it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.06it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.05it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.05it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.05it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.04it/s] 31%|███       | 11/36 [00:03<00:08,  3.05it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.05it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.06it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.04it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.05it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.05it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.03it/s] 50%|█████     | 18/36 [00:05<00:05,  3.03it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.04it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.06it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.06it/s] 61%|██████    | 22/36 [00:07<00:04,  3.06it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.05it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.03it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.03it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.04it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.05it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.04it/s] 81%|████████  | 29/36 [00:09<00:02,  3.04it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.04it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.05it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.05it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.05it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.05it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.05it/s]100%|██████████| 36/36 [00:11<00:00,  3.05it/s]100%|██████████| 36/36 [00:11<00:00,  3.05it/s]
Inference completed in 11.86s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.50GB
输入形状: (14, 194, 200, 200)
目标形状: (194, 512, 512)
预估内存需求: 2.65GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.56, 2.56]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.97s
重采样后内存: 4.15GB (增加: 2.65GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 194, 512, 512), 内存占用: 2.65GB
分块策略: 块大小=8, 预计块数=25
创建了 25 个处理块，每块约 8 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.67s
处理完成后内存: 1.52GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.69s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.16s
Case FLARETs_0011_0000.nii.gz completed in 18.66s total (preprocess: 2.63s, inference: 11.86s, postprocess: 4.16s)
Step 4/4: Ready for next case...

=== Processing case 12/200: FLARETs_0012_0000.nii.gz ===
File FLARETs_0012_0000.nii.gz: 79.92 MB
Total file size: 79.92 MB
⚠️  File size (79.92 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0012.nii.gz with shape (512, 512, 254)
✅ Dummy results generated: FLARETs_0012.nii.gz
Case FLARETs_0012_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 13/200: FLARETs_0013_0000.nii.gz ===
File FLARETs_0013_0000.nii.gz: 43.39 MB
Total file size: 43.39 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.98s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.03it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.03it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.05it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.07it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.10it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.09it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.08it/s] 50%|█████     | 8/16 [00:02<00:02,  3.07it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.08it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.07it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.05it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.05it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.05it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.09it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.07it/s]100%|██████████| 16/16 [00:05<00:00,  3.07it/s]100%|██████████| 16/16 [00:05<00:00,  3.07it/s]
Inference completed in 5.24s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.41GB
输入形状: (14, 162, 140, 140)
目标形状: (135, 512, 512)
预估内存需求: 1.85GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8333333333333334, 3.657142857142857, 3.657142857142857]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.10s
重采样后内存: 3.25GB (增加: 1.85GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 135, 512, 512), 内存占用: 1.85GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.56s
处理完成后内存: 1.41GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.71s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.07s
Case FLARETs_0013_0000.nii.gz completed in 10.29s total (preprocess: 1.98s, inference: 5.24s, postprocess: 3.07s)
Step 4/4: Ready for next case...

=== Processing case 14/200: FLARETs_0014_0000.nii.gz ===
File FLARETs_0014_0000.nii.gz: 71.23 MB
Total file size: 71.23 MB
⚠️  File size (71.23 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0014.nii.gz with shape (512, 512, 230)
✅ Dummy results generated: FLARETs_0014.nii.gz
Case FLARETs_0014_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 15/200: FLARETs_0015_0000.nii.gz ===
File FLARETs_0015_0000.nii.gz: 63.16 MB
Total file size: 63.16 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.80s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:06,  2.95it/s] 10%|█         | 2/20 [00:00<00:06,  2.98it/s] 15%|█▌        | 3/20 [00:01<00:05,  2.99it/s] 20%|██        | 4/20 [00:01<00:05,  3.02it/s] 25%|██▌       | 5/20 [00:01<00:04,  3.01it/s] 30%|███       | 6/20 [00:02<00:04,  3.00it/s] 35%|███▌      | 7/20 [00:02<00:04,  3.02it/s] 40%|████      | 8/20 [00:02<00:03,  3.02it/s] 45%|████▌     | 9/20 [00:02<00:03,  3.03it/s] 50%|█████     | 10/20 [00:03<00:03,  3.02it/s] 55%|█████▌    | 11/20 [00:03<00:02,  3.01it/s] 60%|██████    | 12/20 [00:03<00:02,  3.02it/s] 65%|██████▌   | 13/20 [00:04<00:02,  3.02it/s] 70%|███████   | 14/20 [00:04<00:01,  3.02it/s] 75%|███████▌  | 15/20 [00:04<00:01,  3.01it/s] 80%|████████  | 16/20 [00:05<00:01,  3.01it/s] 85%|████████▌ | 17/20 [00:05<00:00,  3.01it/s] 90%|█████████ | 18/20 [00:05<00:00,  3.02it/s] 95%|█████████▌| 19/20 [00:06<00:00,  3.02it/s]100%|██████████| 20/20 [00:06<00:00,  3.03it/s]100%|██████████| 20/20 [00:06<00:00,  3.01it/s]
Inference completed in 6.67s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.52GB
输入形状: (14, 209, 180, 180)
目标形状: (209, 512, 512)
预估内存需求: 2.86GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.8444444444444446, 2.8444444444444446]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.22s
重采样后内存: 4.38GB (增加: 2.86GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 209, 512, 512), 内存占用: 2.86GB
分块策略: 块大小=8, 预计块数=27
创建了 27 个处理块，每块约 8 切片
后处理进度: 6/27 块 (22.2%)
后处理进度: 12/27 块 (44.4%)
后处理进度: 18/27 块 (66.7%)
后处理进度: 24/27 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.80s
处理完成后内存: 1.51GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 4.07s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.52s
Case FLARETs_0015_0000.nii.gz completed in 13.98s total (preprocess: 2.80s, inference: 6.67s, postprocess: 4.52s)
Step 4/4: Ready for next case...

=== Processing case 16/200: FLARETs_0016_0000.nii.gz ===
File FLARETs_0016_0000.nii.gz: 45.69 MB
Total file size: 45.69 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.36s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.01it/s]  6%|▌         | 2/36 [00:00<00:11,  3.03it/s]  8%|▊         | 3/36 [00:00<00:10,  3.02it/s] 11%|█         | 4/36 [00:01<00:10,  3.03it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.03it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.04it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.05it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.05it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.05it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.04it/s] 31%|███       | 11/36 [00:03<00:08,  3.05it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.06it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.06it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.06it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.06it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.07it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.07it/s] 50%|█████     | 18/36 [00:05<00:05,  3.07it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.08it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.06it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.06it/s] 61%|██████    | 22/36 [00:07<00:04,  3.05it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.05it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.05it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.04it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.00it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.01it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.01it/s] 81%|████████  | 29/36 [00:09<00:02,  3.01it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.02it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.03it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.04it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.03it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.03it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.05it/s]100%|██████████| 36/36 [00:11<00:00,  3.04it/s]100%|██████████| 36/36 [00:11<00:00,  3.04it/s]
Inference completed in 11.87s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.47GB
输入形状: (14, 194, 198, 198)
目标形状: (194, 512, 512)
预估内存需求: 2.65GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.585858585858586, 2.585858585858586]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.03s
重采样后内存: 4.12GB (增加: 2.65GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 194, 512, 512), 内存占用: 2.65GB
分块策略: 块大小=8, 预计块数=25
创建了 25 个处理块，每块约 8 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.66s
处理完成后内存: 1.59GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.75s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.20s
Case FLARETs_0016_0000.nii.gz completed in 18.44s total (preprocess: 2.36s, inference: 11.87s, postprocess: 4.20s)
Step 4/4: Ready for next case...

=== Processing case 17/200: FLARETs_0017_0000.nii.gz ===
File FLARETs_0017_0000.nii.gz: 55.94 MB
Total file size: 55.94 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.41s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.98it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.04it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.05it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.06it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.06it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.06it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.06it/s] 50%|█████     | 8/16 [00:02<00:02,  3.07it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.08it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.07it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.06it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.06it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.06it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.06it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.04it/s]100%|██████████| 16/16 [00:05<00:00,  3.04it/s]100%|██████████| 16/16 [00:05<00:00,  3.05it/s]
Inference completed in 5.27s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.45GB
输入形状: (14, 181, 190, 190)
目标形状: (181, 512, 512)
预估内存需求: 2.47GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.82s
重采样后内存: 3.93GB (增加: 2.47GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 181, 512, 512), 内存占用: 2.47GB
分块策略: 块大小=7, 预计块数=26
创建了 26 个处理块，每块约 7 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.70s
处理完成后内存: 1.43GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.58s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.02s
Case FLARETs_0017_0000.nii.gz completed in 11.70s total (preprocess: 2.41s, inference: 5.27s, postprocess: 4.02s)
Step 4/4: Ready for next case...

=== Processing case 18/200: FLARETs_0018_0000.nii.gz ===
File FLARETs_0018_0000.nii.gz: 66.65 MB
Total file size: 66.65 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.92s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:06,  3.09it/s] 10%|█         | 2/20 [00:00<00:05,  3.13it/s] 15%|█▌        | 3/20 [00:00<00:05,  3.15it/s] 20%|██        | 4/20 [00:01<00:05,  3.17it/s] 25%|██▌       | 5/20 [00:01<00:04,  3.18it/s] 30%|███       | 6/20 [00:01<00:04,  3.16it/s] 35%|███▌      | 7/20 [00:02<00:04,  3.15it/s] 40%|████      | 8/20 [00:02<00:03,  3.14it/s] 45%|████▌     | 9/20 [00:02<00:03,  3.14it/s] 50%|█████     | 10/20 [00:03<00:03,  3.16it/s] 55%|█████▌    | 11/20 [00:03<00:02,  3.17it/s] 60%|██████    | 12/20 [00:03<00:02,  3.17it/s] 65%|██████▌   | 13/20 [00:04<00:02,  3.18it/s] 70%|███████   | 14/20 [00:04<00:01,  3.17it/s] 75%|███████▌  | 15/20 [00:04<00:01,  3.17it/s] 80%|████████  | 16/20 [00:05<00:01,  3.17it/s] 85%|████████▌ | 17/20 [00:05<00:00,  3.18it/s] 90%|█████████ | 18/20 [00:05<00:00,  3.17it/s] 95%|█████████▌| 19/20 [00:06<00:00,  3.17it/s]100%|██████████| 20/20 [00:06<00:00,  3.15it/s]100%|██████████| 20/20 [00:06<00:00,  3.16it/s]
Inference completed in 6.37s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.54GB
输入形状: (14, 220, 188, 188)
目标形状: (220, 512, 512)
预估内存需求: 3.01GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.723404255319149, 2.723404255319149]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.37s
重采样后内存: 4.54GB (增加: 3.01GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 220, 512, 512), 内存占用: 3.01GB
分块策略: 块大小=9, 预计块数=25
创建了 25 个处理块，每块约 9 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.80s
处理完成后内存: 1.56GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 4.22s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.69s
Case FLARETs_0018_0000.nii.gz completed in 13.98s total (preprocess: 2.92s, inference: 6.37s, postprocess: 4.69s)
Step 4/4: Ready for next case...

=== Processing case 19/200: FLARETs_0019_0000.nii.gz ===
File FLARETs_0019_0000.nii.gz: 52.40 MB
Total file size: 52.40 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.74s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.97it/s]  6%|▌         | 2/36 [00:00<00:11,  3.01it/s]  8%|▊         | 3/36 [00:00<00:10,  3.01it/s] 11%|█         | 4/36 [00:01<00:10,  3.02it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.03it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.03it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.05it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.03it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.05it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.06it/s] 31%|███       | 11/36 [00:03<00:08,  3.06it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.06it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.06it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.06it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.07it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.06it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.06it/s] 50%|█████     | 18/36 [00:05<00:05,  3.06it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.06it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.06it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.05it/s] 61%|██████    | 22/36 [00:07<00:04,  3.05it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.04it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.05it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.05it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.04it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.04it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.03it/s] 81%|████████  | 29/36 [00:09<00:02,  3.04it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.04it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.03it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.03it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.02it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.02it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.03it/s]100%|██████████| 36/36 [00:11<00:00,  3.02it/s]100%|██████████| 36/36 [00:11<00:00,  3.04it/s]
Inference completed in 11.90s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.57GB
输入形状: (14, 193, 243, 243)
目标形状: (193, 512, 512)
预估内存需求: 2.64GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.1069958847736627, 2.1069958847736627]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.01s
重采样后内存: 4.21GB (增加: 2.64GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 193, 512, 512), 内存占用: 2.64GB
分块策略: 块大小=8, 预计块数=25
创建了 25 个处理块，每块约 8 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.66s
处理完成后内存: 1.56GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.71s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.26s
Case FLARETs_0019_0000.nii.gz completed in 21.90s total (preprocess: 5.74s, inference: 11.90s, postprocess: 4.26s)
Step 4/4: Ready for next case...

=== Processing case 20/200: FLARETs_0020_0000.nii.gz ===
File FLARETs_0020_0000.nii.gz: 56.40 MB
Total file size: 56.40 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.26s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.14it/s]  6%|▌         | 2/36 [00:00<00:10,  3.13it/s]  8%|▊         | 3/36 [00:00<00:10,  3.07it/s] 11%|█         | 4/36 [00:01<00:10,  3.10it/s] 14%|█▍        | 5/36 [00:01<00:09,  3.10it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.14it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.15it/s] 22%|██▏       | 8/36 [00:02<00:08,  3.12it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.14it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.12it/s] 31%|███       | 11/36 [00:03<00:08,  3.12it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.15it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.13it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.12it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.12it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.12it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.11it/s] 50%|█████     | 18/36 [00:05<00:05,  3.11it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.12it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.11it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.09it/s] 61%|██████    | 22/36 [00:07<00:04,  3.10it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.12it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.12it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.15it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.14it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.13it/s] 78%|███████▊  | 28/36 [00:08<00:02,  3.14it/s] 81%|████████  | 29/36 [00:09<00:02,  3.13it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.11it/s] 86%|████████▌ | 31/36 [00:09<00:01,  3.11it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.13it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.15it/s] 94%|█████████▍| 34/36 [00:10<00:00,  3.14it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.14it/s]100%|██████████| 36/36 [00:11<00:00,  3.13it/s]100%|██████████| 36/36 [00:11<00:00,  3.12it/s]
Inference completed in 11.57s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.66GB
输入形状: (14, 193, 217, 217)
目标形状: (193, 512, 512)
预估内存需求: 2.64GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.359447004608295, 2.359447004608295]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.00s
重采样后内存: 4.30GB (增加: 2.64GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 193, 512, 512), 内存占用: 2.64GB
分块策略: 块大小=8, 预计块数=25
创建了 25 个处理块，每块约 8 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.65s
处理完成后内存: 1.66GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.70s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.19s
Case FLARETs_0020_0000.nii.gz completed in 21.02s total (preprocess: 5.26s, inference: 11.57s, postprocess: 4.19s)
Step 4/4: Ready for next case...

=== Processing case 21/200: FLARETs_0021_0000.nii.gz ===
File FLARETs_0021_0000.nii.gz: 39.33 MB
Total file size: 39.33 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.40s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:07,  3.24it/s]  8%|▊         | 2/24 [00:00<00:06,  3.23it/s] 12%|█▎        | 3/24 [00:00<00:06,  3.24it/s] 17%|█▋        | 4/24 [00:01<00:06,  3.25it/s] 21%|██        | 5/24 [00:01<00:05,  3.21it/s] 25%|██▌       | 6/24 [00:01<00:05,  3.21it/s] 29%|██▉       | 7/24 [00:02<00:05,  3.22it/s] 33%|███▎      | 8/24 [00:02<00:04,  3.22it/s] 38%|███▊      | 9/24 [00:02<00:04,  3.21it/s] 42%|████▏     | 10/24 [00:03<00:04,  3.21it/s] 46%|████▌     | 11/24 [00:03<00:04,  3.19it/s] 50%|█████     | 12/24 [00:03<00:03,  3.20it/s] 54%|█████▍    | 13/24 [00:04<00:03,  3.21it/s] 58%|█████▊    | 14/24 [00:04<00:03,  3.23it/s] 62%|██████▎   | 15/24 [00:04<00:02,  3.22it/s] 67%|██████▋   | 16/24 [00:04<00:02,  3.22it/s] 71%|███████   | 17/24 [00:05<00:02,  3.22it/s] 75%|███████▌  | 18/24 [00:05<00:01,  3.23it/s] 79%|███████▉  | 19/24 [00:05<00:01,  3.23it/s] 83%|████████▎ | 20/24 [00:06<00:01,  3.23it/s] 88%|████████▊ | 21/24 [00:06<00:00,  3.23it/s] 92%|█████████▏| 22/24 [00:06<00:00,  3.23it/s] 96%|█████████▌| 23/24 [00:07<00:00,  3.23it/s]100%|██████████| 24/24 [00:07<00:00,  3.24it/s]100%|██████████| 24/24 [00:07<00:00,  3.22it/s]
Inference completed in 7.49s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.59GB
输入形状: (14, 256, 180, 180)
目标形状: (128, 512, 512)
预估内存需求: 1.75GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.8444444444444446, 2.8444444444444446]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.02s
重采样后内存: 3.34GB (增加: 1.75GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 128, 512, 512), 内存占用: 1.75GB
分块策略: 块大小=8, 预计块数=16
创建了 16 个处理块，每块约 8 切片
后处理进度: 4/16 块 (25.0%)
后处理进度: 8/16 块 (50.0%)
后处理进度: 12/16 块 (75.0%)
后处理进度: 16/16 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.59GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.49s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.96s
Case FLARETs_0021_0000.nii.gz completed in 12.85s total (preprocess: 2.40s, inference: 7.49s, postprocess: 2.96s)
Step 4/4: Ready for next case...

=== Processing case 22/200: FLARETs_0022_0000.nii.gz ===
File FLARETs_0022_0000.nii.gz: 36.56 MB
Total file size: 36.56 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.98s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.04it/s]  6%|▌         | 2/36 [00:00<00:11,  3.00it/s]  8%|▊         | 3/36 [00:00<00:10,  3.02it/s] 11%|█         | 4/36 [00:01<00:10,  3.03it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.03it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.02it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.03it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.04it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.04it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.03it/s] 31%|███       | 11/36 [00:03<00:08,  3.03it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.04it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.04it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.04it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.04it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.04it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.04it/s] 50%|█████     | 18/36 [00:05<00:05,  3.03it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.04it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.02it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.01it/s] 61%|██████    | 22/36 [00:07<00:04,  3.02it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.03it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.02it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.02it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.02it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.02it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.02it/s] 81%|████████  | 29/36 [00:09<00:02,  3.02it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.03it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.01it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.01it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.02it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.01it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.02it/s]100%|██████████| 36/36 [00:11<00:00,  3.02it/s]100%|██████████| 36/36 [00:11<00:00,  3.03it/s]
Inference completed in 11.95s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.57GB
输入形状: (14, 200, 236, 236)
目标形状: (133, 512, 512)
预估内存需求: 1.82GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.665, 2.169491525423729, 2.169491525423729]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.09s
重采样后内存: 3.39GB (增加: 1.82GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 133, 512, 512), 内存占用: 1.82GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.53s
处理完成后内存: 1.60GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.66s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.19s
Case FLARETs_0022_0000.nii.gz completed in 18.13s total (preprocess: 2.98s, inference: 11.95s, postprocess: 3.19s)
Step 4/4: Ready for next case...

=== Processing case 23/200: FLARETs_0023_0000.nii.gz ===
File FLARETs_0023_0000.nii.gz: 43.98 MB
Total file size: 43.98 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.70s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.01it/s]  6%|▌         | 2/36 [00:00<00:11,  3.03it/s]  8%|▊         | 3/36 [00:00<00:10,  3.01it/s] 11%|█         | 4/36 [00:01<00:10,  3.01it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.01it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.02it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.03it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.02it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.03it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.03it/s] 31%|███       | 11/36 [00:03<00:08,  3.03it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.03it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.03it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.03it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.03it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.02it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.03it/s] 50%|█████     | 18/36 [00:05<00:05,  3.02it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.02it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.02it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.01it/s] 61%|██████    | 22/36 [00:07<00:04,  3.02it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.02it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.03it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.03it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.02it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.02it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.03it/s] 81%|████████  | 29/36 [00:09<00:02,  3.04it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.03it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.02it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.03it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.04it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.03it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.04it/s]100%|██████████| 36/36 [00:11<00:00,  3.04it/s]100%|██████████| 36/36 [00:11<00:00,  3.03it/s]
Inference completed in 11.93s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.45GB
输入形状: (14, 188, 201, 201)
目标形状: (157, 512, 512)
预估内存需求: 2.15GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8351063829787234, 2.5472636815920398, 2.5472636815920398]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.44s
重采样后内存: 3.59GB (增加: 2.15GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 157, 512, 512), 内存占用: 2.15GB
分块策略: 块大小=6, 预计块数=27
创建了 27 个处理块，每块约 6 切片
后处理进度: 6/27 块 (22.2%)
后处理进度: 12/27 块 (44.4%)
后处理进度: 18/27 块 (66.7%)
后处理进度: 24/27 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.60s
处理完成后内存: 1.43GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.08s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.54s
Case FLARETs_0023_0000.nii.gz completed in 18.16s total (preprocess: 2.70s, inference: 11.93s, postprocess: 3.54s)
Step 4/4: Ready for next case...

=== Processing case 24/200: FLARETs_0024_0000.nii.gz ===
File FLARETs_0024_0000.nii.gz: 23.25 MB
Total file size: 23.25 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.54s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  2.95it/s] 11%|█         | 2/18 [00:00<00:05,  2.98it/s] 17%|█▋        | 3/18 [00:01<00:05,  2.98it/s] 22%|██▏       | 4/18 [00:01<00:04,  2.99it/s] 28%|██▊       | 5/18 [00:01<00:04,  3.00it/s] 33%|███▎      | 6/18 [00:02<00:03,  3.00it/s] 39%|███▉      | 7/18 [00:02<00:03,  3.01it/s] 44%|████▍     | 8/18 [00:02<00:03,  3.00it/s] 50%|█████     | 9/18 [00:03<00:02,  3.01it/s] 56%|█████▌    | 10/18 [00:03<00:02,  3.01it/s] 61%|██████    | 11/18 [00:03<00:02,  3.02it/s] 67%|██████▋   | 12/18 [00:03<00:01,  3.03it/s] 72%|███████▏  | 13/18 [00:04<00:01,  3.01it/s] 78%|███████▊  | 14/18 [00:04<00:01,  3.00it/s] 83%|████████▎ | 15/18 [00:04<00:01,  2.99it/s] 89%|████████▉ | 16/18 [00:05<00:00,  2.99it/s] 94%|█████████▍| 17/18 [00:05<00:00,  2.99it/s]100%|██████████| 18/18 [00:06<00:00,  3.00it/s]100%|██████████| 18/18 [00:06<00:00,  3.00it/s]
Inference completed in 6.03s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.33GB
输入形状: (14, 95, 214, 214)
目标形状: (95, 512, 512)
预估内存需求: 1.30GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.392523364485981, 2.392523364485981]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.47s
重采样后内存: 2.63GB (增加: 1.30GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 95, 512, 512), 内存占用: 1.30GB
分块策略: 块大小=5, 预计块数=19
创建了 19 个处理块，每块约 5 切片
后处理进度: 4/19 块 (21.1%)
后处理进度: 8/19 块 (42.1%)
后处理进度: 12/19 块 (63.2%)
后处理进度: 16/19 块 (84.2%)
✅ 并行后处理完成
后处理耗时: 0.37s
处理完成后内存: 1.34GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.87s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.26s
Case FLARETs_0024_0000.nii.gz completed in 10.83s total (preprocess: 2.54s, inference: 6.03s, postprocess: 2.26s)
Step 4/4: Ready for next case...

=== Processing case 25/200: FLARETs_0025_0000.nii.gz ===
File FLARETs_0025_0000.nii.gz: 49.17 MB
Total file size: 49.17 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.34s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.99it/s]  6%|▌         | 2/36 [00:00<00:11,  2.97it/s]  8%|▊         | 3/36 [00:01<00:11,  2.97it/s] 11%|█         | 4/36 [00:01<00:10,  2.97it/s] 14%|█▍        | 5/36 [00:01<00:10,  2.97it/s] 17%|█▋        | 6/36 [00:02<00:10,  2.99it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.00it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.01it/s] 25%|██▌       | 9/36 [00:03<00:08,  3.01it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.00it/s] 31%|███       | 11/36 [00:03<00:08,  3.00it/s] 33%|███▎      | 12/36 [00:04<00:07,  3.01it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.00it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.01it/s] 42%|████▏     | 15/36 [00:05<00:06,  3.02it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.02it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.02it/s] 50%|█████     | 18/36 [00:05<00:05,  3.02it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.02it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.03it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.03it/s] 61%|██████    | 22/36 [00:07<00:04,  3.03it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.02it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.02it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.02it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.01it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.00it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.01it/s] 81%|████████  | 29/36 [00:09<00:02,  3.01it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.01it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.01it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.02it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.00it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.01it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.00it/s]100%|██████████| 36/36 [00:11<00:00,  3.01it/s]100%|██████████| 36/36 [00:11<00:00,  3.01it/s]
Inference completed in 12.00s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.42GB
输入形状: (14, 169, 209, 209)
目标形状: (169, 512, 512)
预估内存需求: 2.31GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.449760765550239, 2.449760765550239]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.62s
重采样后内存: 3.73GB (增加: 2.31GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 169, 512, 512), 内存占用: 2.31GB
分块策略: 块大小=7, 预计块数=25
创建了 25 个处理块，每块约 7 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.57s
处理完成后内存: 1.47GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.23s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.68s
Case FLARETs_0025_0000.nii.gz completed in 18.02s total (preprocess: 2.34s, inference: 12.00s, postprocess: 3.68s)
Step 4/4: Ready for next case...

=== Processing case 26/200: FLARETs_0026_0000.nii.gz ===
File FLARETs_0026_0000.nii.gz: 37.35 MB
Total file size: 37.35 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.81s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:02,  3.00it/s] 25%|██▌       | 2/8 [00:00<00:01,  3.00it/s] 38%|███▊      | 3/8 [00:01<00:01,  3.00it/s] 50%|█████     | 4/8 [00:01<00:01,  2.98it/s] 62%|██████▎   | 5/8 [00:01<00:01,  2.98it/s] 75%|███████▌  | 6/8 [00:02<00:00,  2.98it/s] 88%|████████▊ | 7/8 [00:02<00:00,  2.98it/s]100%|██████████| 8/8 [00:02<00:00,  3.02it/s]100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
Inference completed in 2.69s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.32GB
输入形状: (14, 98, 190, 190)
目标形状: (123, 512, 512)
预估内存需求: 1.68GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.2551020408163265, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.94s
重采样后内存: 3.01GB (增加: 1.68GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 123, 512, 512), 内存占用: 1.68GB
分块策略: 块大小=7, 预计块数=18
创建了 18 个处理块，每块约 7 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.51s
处理完成后内存: 1.35GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 2.49s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.87s
Case FLARETs_0026_0000.nii.gz completed in 8.37s total (preprocess: 2.81s, inference: 2.69s, postprocess: 2.87s)
Step 4/4: Ready for next case...

=== Processing case 27/200: FLARETs_0027_0000.nii.gz ===
File FLARETs_0027_0000.nii.gz: 51.33 MB
Total file size: 51.33 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.21s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.99it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.99it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.01it/s] 25%|██▌       | 4/16 [00:01<00:04,  3.00it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.00it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.99it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.98it/s] 50%|█████     | 8/16 [00:02<00:02,  2.99it/s] 56%|█████▋    | 9/16 [00:03<00:02,  3.00it/s] 62%|██████▎   | 10/16 [00:03<00:02,  3.00it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.99it/s] 75%|███████▌  | 12/16 [00:04<00:01,  3.00it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.01it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.98it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.97it/s]100%|██████████| 16/16 [00:05<00:00,  2.97it/s]100%|██████████| 16/16 [00:05<00:00,  2.99it/s]
Inference completed in 5.39s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.36GB
输入形状: (14, 169, 170, 170)
目标形状: (169, 512, 512)
预估内存需求: 2.31GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 3.011764705882353, 3.011764705882353]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.64s
重采样后内存: 3.67GB (增加: 2.31GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 169, 512, 512), 内存占用: 2.31GB
分块策略: 块大小=7, 预计块数=25
创建了 25 个处理块，每块约 7 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.56s
处理完成后内存: 1.41GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.25s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.65s
Case FLARETs_0027_0000.nii.gz completed in 11.25s total (preprocess: 2.21s, inference: 5.39s, postprocess: 3.65s)
Step 4/4: Ready for next case...

=== Processing case 28/200: FLARETs_0028_0000.nii.gz ===
File FLARETs_0028_0000.nii.gz: 21.30 MB
Total file size: 21.30 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.66s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.95it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.99it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.97it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.96it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.97it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.98it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.98it/s] 50%|█████     | 8/16 [00:02<00:02,  2.99it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.99it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.00it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.00it/s] 75%|███████▌  | 12/16 [00:04<00:01,  3.00it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.99it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.99it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.99it/s]100%|██████████| 16/16 [00:05<00:00,  2.99it/s]100%|██████████| 16/16 [00:05<00:00,  2.99it/s]
Inference completed in 5.39s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.44GB
输入形状: (14, 182, 183, 183)
目标形状: (91, 512, 512)
预估内存需求: 1.24GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.797814207650273, 2.797814207650273]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.45s
重采样后内存: 2.69GB (增加: 1.24GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 91, 512, 512), 内存占用: 1.24GB
分块策略: 块大小=5, 预计块数=19
创建了 19 个处理块，每块约 5 切片
后处理进度: 4/19 块 (21.1%)
后处理进度: 8/19 块 (42.1%)
后处理进度: 12/19 块 (63.2%)
后处理进度: 16/19 块 (84.2%)
✅ 并行后处理完成
后处理耗时: 0.36s
处理完成后内存: 1.44GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.84s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.27s
Case FLARETs_0028_0000.nii.gz completed in 9.32s total (preprocess: 1.66s, inference: 5.39s, postprocess: 2.27s)
Step 4/4: Ready for next case...

=== Processing case 29/200: FLARETs_0029_0000.nii.gz ===
File FLARETs_0029_0000.nii.gz: 51.92 MB
Total file size: 51.92 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.23s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.98it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.96it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.98it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.98it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.99it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.99it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.99it/s] 50%|█████     | 8/16 [00:02<00:02,  3.00it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.99it/s] 62%|██████▎   | 10/16 [00:03<00:02,  3.00it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.01it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.99it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.98it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.98it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.97it/s]100%|██████████| 16/16 [00:05<00:00,  2.96it/s]100%|██████████| 16/16 [00:05<00:00,  2.98it/s]
Inference completed in 5.39s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.36GB
输入形状: (14, 171, 163, 163)
目标形状: (171, 512, 512)
预估内存需求: 2.34GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 3.1411042944785277, 3.1411042944785277]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.63s
重采样后内存: 3.70GB (增加: 2.34GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 171, 512, 512), 内存占用: 2.34GB
分块策略: 块大小=7, 预计块数=25
创建了 25 个处理块，每块约 7 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.60s
处理完成后内存: 1.40GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.28s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.68s
Case FLARETs_0029_0000.nii.gz completed in 11.30s total (preprocess: 2.23s, inference: 5.39s, postprocess: 3.68s)
Step 4/4: Ready for next case...

=== Processing case 30/200: FLARETs_0030_0000.nii.gz ===
File FLARETs_0030_0000.nii.gz: 38.75 MB
Total file size: 38.75 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.15s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.99it/s]  6%|▌         | 2/36 [00:00<00:11,  3.00it/s]  8%|▊         | 3/36 [00:01<00:10,  3.00it/s] 11%|█         | 4/36 [00:01<00:10,  3.00it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.01it/s] 17%|█▋        | 6/36 [00:02<00:10,  2.99it/s] 19%|█▉        | 7/36 [00:02<00:09,  2.98it/s] 22%|██▏       | 8/36 [00:02<00:09,  2.99it/s] 25%|██▌       | 9/36 [00:03<00:09,  2.99it/s] 28%|██▊       | 10/36 [00:03<00:08,  2.99it/s] 31%|███       | 11/36 [00:03<00:08,  2.99it/s] 33%|███▎      | 12/36 [00:04<00:08,  3.00it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.00it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.00it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.02it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.02it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.03it/s] 50%|█████     | 18/36 [00:05<00:05,  3.04it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.03it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.04it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.04it/s] 61%|██████    | 22/36 [00:07<00:04,  3.04it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.05it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.03it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.04it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.03it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.03it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.03it/s] 81%|████████  | 29/36 [00:09<00:02,  3.02it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.03it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.04it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.03it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.04it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.05it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.06it/s]100%|██████████| 36/36 [00:11<00:00,  3.07it/s]100%|██████████| 36/36 [00:11<00:00,  3.03it/s]
Inference completed in 11.96s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.63GB
输入形状: (14, 181, 250, 250)
目标形状: (151, 512, 512)
预估内存需求: 2.06GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8342541436464088, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.37s
重采样后内存: 3.58GB (增加: 1.96GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 151, 512, 512), 内存占用: 2.06GB
分块策略: 块大小=6, 预计块数=26
创建了 26 个处理块，每块约 6 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.51GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.00s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.54s
Case FLARETs_0030_0000.nii.gz completed in 18.65s total (preprocess: 3.15s, inference: 11.96s, postprocess: 3.54s)
Step 4/4: Ready for next case...

=== Processing case 31/200: FLARETs_0031_0000.nii.gz ===
File FLARETs_0031_0000.nii.gz: 60.43 MB
Total file size: 60.43 MB
Step 1/4: Preprocessing...
Preprocessing completed in 4.45s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.98it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.97it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.99it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.99it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.99it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.98it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.99it/s] 50%|█████     | 8/16 [00:02<00:02,  2.99it/s] 56%|█████▋    | 9/16 [00:03<00:02,  3.00it/s] 62%|██████▎   | 10/16 [00:03<00:02,  3.00it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.00it/s] 75%|███████▌  | 12/16 [00:04<00:01,  3.01it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.02it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.01it/s] 94%|█████████▍| 15/16 [00:05<00:00,  3.00it/s]100%|██████████| 16/16 [00:05<00:00,  2.99it/s]100%|██████████| 16/16 [00:05<00:00,  3.00it/s]
Inference completed in 5.37s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.29GB
输入形状: (14, 161, 188, 188)
目标形状: (201, 512, 512)
预估内存需求: 2.75GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.2484472049689441, 2.723404255319149, 2.723404255319149]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.13s
重采样后内存: 4.04GB (增加: 2.75GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 201, 512, 512), 内存占用: 2.75GB
分块策略: 块大小=8, 预计块数=26
创建了 26 个处理块，每块约 8 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.80s
处理完成后内存: 1.41GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.06s
🎯 深度优化总耗时: 3.98s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.41s
Case FLARETs_0031_0000.nii.gz completed in 14.23s total (preprocess: 4.45s, inference: 5.37s, postprocess: 4.41s)
Step 4/4: Ready for next case...

=== Processing case 32/200: FLARETs_0032_0000.nii.gz ===
File FLARETs_0032_0000.nii.gz: 34.86 MB
Total file size: 34.86 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.50s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:02,  2.98it/s] 25%|██▌       | 2/8 [00:00<00:01,  3.00it/s] 38%|███▊      | 3/8 [00:00<00:01,  3.02it/s] 50%|█████     | 4/8 [00:01<00:01,  3.04it/s] 62%|██████▎   | 5/8 [00:01<00:00,  3.03it/s] 75%|███████▌  | 6/8 [00:01<00:00,  3.04it/s] 88%|████████▊ | 7/8 [00:02<00:00,  3.01it/s]100%|██████████| 8/8 [00:02<00:00,  3.02it/s]100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
Inference completed in 2.67s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.29GB
输入形状: (14, 116, 150, 150)
目标形状: (97, 512, 512)
预估内存需求: 1.33GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8362068965517241, 3.4133333333333336, 3.4133333333333336]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.50s
重采样后内存: 2.62GB (增加: 1.33GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 97, 512, 512), 内存占用: 1.33GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.33s
处理完成后内存: 1.32GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.86s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.21s
Case FLARETs_0032_0000.nii.gz completed in 6.38s total (preprocess: 1.50s, inference: 2.67s, postprocess: 2.21s)
Step 4/4: Ready for next case...

=== Processing case 33/200: FLARETs_0033_0000.nii.gz ===
File FLARETs_0033_0000.nii.gz: 54.53 MB
Total file size: 54.53 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.65s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.04it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.03it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.04it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.02it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.03it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.03it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.02it/s] 50%|█████     | 8/16 [00:02<00:02,  3.03it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.04it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.04it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.04it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.05it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.04it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.02it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.04it/s]100%|██████████| 16/16 [00:05<00:00,  3.04it/s]100%|██████████| 16/16 [00:05<00:00,  3.04it/s]
Inference completed in 5.30s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.40GB
输入形状: (14, 184, 180, 180)
目标形状: (153, 512, 512)
预估内存需求: 2.09GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8315217391304348, 2.8444444444444446, 2.8444444444444446]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.39s
重采样后内存: 3.50GB (增加: 2.09GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 153, 512, 512), 内存占用: 2.09GB
分块策略: 块大小=6, 预计块数=26
创建了 26 个处理块，每块约 6 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.44GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.02s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.44s
Case FLARETs_0033_0000.nii.gz completed in 11.39s total (preprocess: 2.65s, inference: 5.30s, postprocess: 3.44s)
Step 4/4: Ready for next case...

=== Processing case 34/200: FLARETs_0034_0000.nii.gz ===
File FLARETs_0034_0000.nii.gz: 56.55 MB
Total file size: 56.55 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.91s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.01it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.03it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.05it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.05it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.06it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.03it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.04it/s] 50%|█████     | 8/16 [00:02<00:02,  3.06it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.06it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.06it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.06it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.05it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.05it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.05it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.06it/s]100%|██████████| 16/16 [00:05<00:00,  3.05it/s]100%|██████████| 16/16 [00:05<00:00,  3.05it/s]
Inference completed in 5.28s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.45GB
输入形状: (14, 193, 190, 190)
目标形状: (161, 512, 512)
预估内存需求: 2.20GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8341968911917098, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.51s
重采样后内存: 3.59GB (增加: 2.14GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 161, 512, 512), 内存占用: 2.20GB
分块策略: 块大小=6, 预计块数=27
创建了 27 个处理块，每块约 6 切片
后处理进度: 6/27 块 (22.2%)
后处理进度: 12/27 块 (44.4%)
后处理进度: 18/27 块 (66.7%)
后处理进度: 24/27 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.45GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.15s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.60s
Case FLARETs_0034_0000.nii.gz completed in 11.79s total (preprocess: 2.91s, inference: 5.28s, postprocess: 3.60s)
Step 4/4: Ready for next case...

=== Processing case 35/200: FLARETs_0035_0000.nii.gz ===
File FLARETs_0035_0000.nii.gz: 52.33 MB
Total file size: 52.33 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.63s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.01it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.03it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.02it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.02it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.02it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.01it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.00it/s] 50%|█████     | 8/16 [00:02<00:02,  3.01it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.01it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.02it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.03it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.02it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.02it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.03it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]
Inference completed in 5.34s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.41GB
输入形状: (14, 175, 190, 190)
目标形状: (146, 512, 512)
预估内存需求: 2.00GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8342857142857143, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.25s
重采样后内存: 3.41GB (增加: 2.00GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 146, 512, 512), 内存占用: 2.00GB
分块策略: 块大小=9, 预计块数=17
创建了 17 个处理块，每块约 9 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.52s
处理完成后内存: 1.45GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.81s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.24s
Case FLARETs_0035_0000.nii.gz completed in 11.21s total (preprocess: 2.63s, inference: 5.34s, postprocess: 3.24s)
Step 4/4: Ready for next case...

=== Processing case 36/200: FLARETs_0036_0000.nii.gz ===
File FLARETs_0036_0000.nii.gz: 31.56 MB
Total file size: 31.56 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.53s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:02,  2.98it/s] 25%|██▌       | 2/8 [00:00<00:01,  3.04it/s] 38%|███▊      | 3/8 [00:00<00:01,  3.05it/s] 50%|█████     | 4/8 [00:01<00:01,  3.07it/s] 62%|██████▎   | 5/8 [00:01<00:00,  3.05it/s] 75%|███████▌  | 6/8 [00:01<00:00,  3.06it/s] 88%|████████▊ | 7/8 [00:02<00:00,  3.07it/s]100%|██████████| 8/8 [00:02<00:00,  3.06it/s]100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
Inference completed in 2.64s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.43GB
输入形状: (14, 109, 180, 180)
目标形状: (91, 512, 512)
预估内存需求: 1.24GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8348623853211009, 2.8444444444444446, 2.8444444444444446]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.42s
重采样后内存: 2.67GB (增加: 1.24GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 91, 512, 512), 内存占用: 1.24GB
分块策略: 块大小=5, 预计块数=19
创建了 19 个处理块，每块约 5 切片
后处理进度: 4/19 块 (21.1%)
后处理进度: 8/19 块 (42.1%)
后处理进度: 12/19 块 (63.2%)
后处理进度: 16/19 块 (84.2%)
✅ 并行后处理完成
后处理耗时: 0.36s
处理完成后内存: 1.43GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.82s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.19s
Case FLARETs_0036_0000.nii.gz completed in 6.37s total (preprocess: 1.53s, inference: 2.64s, postprocess: 2.19s)
Step 4/4: Ready for next case...

=== Processing case 37/200: FLARETs_0037_0000.nii.gz ===
File FLARETs_0037_0000.nii.gz: 50.87 MB
Total file size: 50.87 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.64s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.94it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.99it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.99it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.97it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.96it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.97it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.98it/s] 50%|█████     | 8/16 [00:02<00:02,  3.00it/s] 56%|█████▋    | 9/16 [00:03<00:02,  3.00it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.02it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.01it/s] 75%|███████▌  | 12/16 [00:04<00:01,  3.02it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.02it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.04it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.04it/s]100%|██████████| 16/16 [00:05<00:00,  3.04it/s]100%|██████████| 16/16 [00:05<00:00,  3.01it/s]
Inference completed in 5.35s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.45GB
输入形状: (14, 176, 190, 190)
目标形状: (147, 512, 512)
预估内存需求: 2.01GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8352272727272727, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.30s
重采样后内存: 3.46GB (增加: 2.01GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 147, 512, 512), 内存占用: 2.01GB
分块策略: 块大小=6, 预计块数=25
创建了 25 个处理块，每块约 6 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.52s
处理完成后内存: 1.48GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.86s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.29s
Case FLARETs_0037_0000.nii.gz completed in 11.29s total (preprocess: 2.64s, inference: 5.35s, postprocess: 3.29s)
Step 4/4: Ready for next case...

=== Processing case 38/200: FLARETs_0038_0000.nii.gz ===
File FLARETs_0038_0000.nii.gz: 77.68 MB
Total file size: 77.68 MB
⚠️  File size (77.68 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0038.nii.gz with shape (512, 512, 209)
✅ Dummy results generated: FLARETs_0038.nii.gz
Case FLARETs_0038_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 39/200: FLARETs_0039_0000.nii.gz ===
File FLARETs_0039_0000.nii.gz: 78.53 MB
Total file size: 78.53 MB
⚠️  File size (78.53 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0039.nii.gz with shape (512, 512, 208)
✅ Dummy results generated: FLARETs_0039.nii.gz
Case FLARETs_0039_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 40/200: FLARETs_0040_0000.nii.gz ===
File FLARETs_0040_0000.nii.gz: 48.76 MB
Total file size: 48.76 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.24s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.05it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.06it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.05it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.05it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.04it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.03it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.04it/s] 50%|█████     | 8/16 [00:02<00:02,  3.04it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.04it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.05it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.04it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.04it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.03it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.03it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.03it/s]100%|██████████| 16/16 [00:05<00:00,  3.04it/s]100%|██████████| 16/16 [00:05<00:00,  3.04it/s]
Inference completed in 5.29s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.39GB
输入形状: (14, 168, 160, 160)
目标形状: (140, 512, 512)
预估内存需求: 1.91GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8333333333333334, 3.2, 3.2]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.17s
重采样后内存: 3.30GB (增加: 1.91GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 140, 512, 512), 内存占用: 1.91GB
分块策略: 块大小=8, 预计块数=18
创建了 18 个处理块，每块约 8 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.42GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.80s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.19s
Case FLARETs_0040_0000.nii.gz completed in 10.72s total (preprocess: 2.24s, inference: 5.29s, postprocess: 3.19s)
Step 4/4: Ready for next case...

=== Processing case 41/200: FLARETs_0041_0000.nii.gz ===
File FLARETs_0041_0000.nii.gz: 48.19 MB
Total file size: 48.19 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.28s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.06it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.05it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.07it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.07it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.06it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.06it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.05it/s] 50%|█████     | 8/16 [00:02<00:02,  3.05it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.05it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.06it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.06it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.04it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.04it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.03it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]100%|██████████| 16/16 [00:05<00:00,  3.04it/s]
Inference completed in 5.29s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.41GB
输入形状: (14, 163, 175, 175)
目标形状: (136, 512, 512)
预估内存需求: 1.86GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8343558282208589, 2.9257142857142857, 2.9257142857142857]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.08s
重采样后内存: 3.26GB (增加: 1.86GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 136, 512, 512), 内存占用: 1.86GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.44GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.70s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.11s
Case FLARETs_0041_0000.nii.gz completed in 10.68s total (preprocess: 2.28s, inference: 5.29s, postprocess: 3.11s)
Step 4/4: Ready for next case...

=== Processing case 42/200: FLARETs_0042_0000.nii.gz ===
File FLARETs_0042_0000.nii.gz: 46.52 MB
Total file size: 46.52 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.32s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:03,  2.95it/s] 17%|█▋        | 2/12 [00:00<00:03,  2.98it/s] 25%|██▌       | 3/12 [00:01<00:03,  2.97it/s] 33%|███▎      | 4/12 [00:01<00:02,  2.96it/s] 42%|████▏     | 5/12 [00:01<00:02,  2.98it/s] 50%|█████     | 6/12 [00:02<00:02,  2.98it/s] 58%|█████▊    | 7/12 [00:02<00:01,  2.97it/s] 67%|██████▋   | 8/12 [00:02<00:01,  2.96it/s] 75%|███████▌  | 9/12 [00:03<00:01,  2.96it/s] 83%|████████▎ | 10/12 [00:03<00:00,  2.98it/s] 92%|█████████▏| 11/12 [00:03<00:00,  2.98it/s]100%|██████████| 12/12 [00:04<00:00,  2.97it/s]100%|██████████| 12/12 [00:04<00:00,  2.97it/s]
Inference completed in 4.07s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.42GB
输入形状: (14, 157, 190, 190)
目标形状: (131, 512, 512)
预估内存需求: 1.79GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8343949044585988, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.06s
重采样后内存: 3.21GB (增加: 1.79GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 131, 512, 512), 内存占用: 1.79GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.48s
处理完成后内存: 1.46GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.57s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.99s
Case FLARETs_0042_0000.nii.gz completed in 9.38s total (preprocess: 2.32s, inference: 4.07s, postprocess: 2.99s)
Step 4/4: Ready for next case...

=== Processing case 43/200: FLARETs_0043_0000.nii.gz ===
File FLARETs_0043_0000.nii.gz: 53.14 MB
Total file size: 53.14 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.49s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.98it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.97it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.99it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.00it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.99it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.99it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.98it/s] 50%|█████     | 8/16 [00:02<00:02,  2.97it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.97it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.97it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.97it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.98it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.98it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.99it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.99it/s]100%|██████████| 16/16 [00:05<00:00,  3.00it/s]100%|██████████| 16/16 [00:05<00:00,  2.98it/s]
Inference completed in 5.39s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.41GB
输入形状: (14, 179, 170, 170)
目标形状: (149, 512, 512)
预估内存需求: 2.04GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8324022346368715, 3.011764705882353, 3.011764705882353]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.29s
重采样后内存: 3.45GB (增加: 2.04GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 149, 512, 512), 内存占用: 2.04GB
分块策略: 块大小=6, 预计块数=25
创建了 25 个处理块，每块约 6 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.56s
处理完成后内存: 1.45GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.88s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.29s
Case FLARETs_0043_0000.nii.gz completed in 11.18s total (preprocess: 2.49s, inference: 5.39s, postprocess: 3.29s)
Step 4/4: Ready for next case...

=== Processing case 44/200: FLARETs_0044_0000.nii.gz ===
File FLARETs_0044_0000.nii.gz: 57.76 MB
Total file size: 57.76 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.70s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.95it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.99it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.97it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.97it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.96it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.95it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.96it/s] 50%|█████     | 8/16 [00:02<00:02,  2.95it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.95it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.96it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.97it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.97it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.97it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.97it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.97it/s]100%|██████████| 16/16 [00:05<00:00,  2.97it/s]100%|██████████| 16/16 [00:05<00:00,  2.96it/s]
Inference completed in 5.43s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.43GB
输入形状: (14, 197, 170, 170)
目标形状: (164, 512, 512)
预估内存需求: 2.24GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8324873096446701, 3.011764705882353, 3.011764705882353]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.52s
重采样后内存: 3.67GB (增加: 2.24GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 164, 512, 512), 内存占用: 2.24GB
分块策略: 块大小=6, 预计块数=28
创建了 28 个处理块，每块约 6 切片
后处理进度: 7/28 块 (25.0%)
后处理进度: 14/28 块 (50.0%)
后处理进度: 21/28 块 (75.0%)
后处理进度: 28/28 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.60s
处理完成后内存: 1.47GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.17s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.59s
Case FLARETs_0044_0000.nii.gz completed in 11.72s total (preprocess: 2.70s, inference: 5.43s, postprocess: 3.59s)
Step 4/4: Ready for next case...

=== Processing case 45/200: FLARETs_0045_0000.nii.gz ===
File FLARETs_0045_0000.nii.gz: 55.87 MB
Total file size: 55.87 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.41s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.02it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.01it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.01it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.01it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.99it/s] 38%|███▊      | 6/16 [00:01<00:03,  2.99it/s] 44%|████▍     | 7/16 [00:02<00:03,  3.00it/s] 50%|█████     | 8/16 [00:02<00:02,  2.99it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.98it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.99it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.98it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.98it/s] 81%|████████▏ | 13/16 [00:04<00:01,  3.00it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.01it/s] 94%|█████████▍| 15/16 [00:05<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]100%|██████████| 16/16 [00:05<00:00,  3.00it/s]
Inference completed in 5.36s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.51GB
输入形状: (14, 176, 160, 160)
目标形状: (147, 512, 512)
预估内存需求: 2.01GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8352272727272727, 3.2, 3.2]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.27s
重采样后内存: 3.52GB (增加: 2.01GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 147, 512, 512), 内存占用: 2.01GB
分块策略: 块大小=6, 预计块数=25
创建了 25 个处理块，每块约 6 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.52s
处理完成后内存: 1.51GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.83s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.23s
Case FLARETs_0045_0000.nii.gz completed in 10.99s total (preprocess: 2.41s, inference: 5.36s, postprocess: 3.23s)
Step 4/4: Ready for next case...

=== Processing case 46/200: FLARETs_0046_0000.nii.gz ===
File FLARETs_0046_0000.nii.gz: 73.59 MB
Total file size: 73.59 MB
⚠️  File size (73.59 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0046.nii.gz with shape (512, 512, 203)
✅ Dummy results generated: FLARETs_0046.nii.gz
Case FLARETs_0046_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 47/200: FLARETs_0047_0000.nii.gz ===
File FLARETs_0047_0000.nii.gz: 54.64 MB
Total file size: 54.64 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.53s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.94it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.97it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.98it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.98it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.99it/s] 38%|███▊      | 6/16 [00:02<00:03,  3.00it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.01it/s] 50%|█████     | 8/16 [00:02<00:02,  3.01it/s] 56%|█████▋    | 9/16 [00:03<00:02,  3.00it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.99it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.00it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.99it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.00it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.01it/s] 94%|█████████▍| 15/16 [00:05<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.00it/s]
Inference completed in 5.37s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.45GB
输入形状: (14, 182, 170, 170)
目标形状: (152, 512, 512)
预估内存需求: 2.08GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8351648351648352, 3.011764705882353, 3.011764705882353]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.35s
重采样后内存: 3.53GB (增加: 2.08GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 152, 512, 512), 内存占用: 2.08GB
分块策略: 块大小=6, 预计块数=26
创建了 26 个处理块，每块约 6 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.58s
处理完成后内存: 1.49GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.97s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.38s
Case FLARETs_0047_0000.nii.gz completed in 11.28s total (preprocess: 2.53s, inference: 5.37s, postprocess: 3.38s)
Step 4/4: Ready for next case...

=== Processing case 48/200: FLARETs_0048_0000.nii.gz ===
File FLARETs_0048_0000.nii.gz: 47.44 MB
Total file size: 47.44 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.13s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.99it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.01it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.03it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.02it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.02it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.02it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.00it/s] 50%|█████     | 8/16 [00:02<00:02,  3.01it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.02it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.01it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.95it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.91it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.89it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.94it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.98it/s]100%|██████████| 16/16 [00:05<00:00,  3.00it/s]100%|██████████| 16/16 [00:05<00:00,  2.99it/s]
Inference completed in 5.38s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.50GB
输入形状: (14, 161, 160, 160)
目标形状: (134, 512, 512)
预估内存需求: 1.83GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8322981366459627, 3.2, 3.2]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.05s
重采样后内存: 3.33GB (增加: 1.83GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 134, 512, 512), 内存占用: 1.83GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.54s
处理完成后内存: 1.50GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.62s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.00s
Case FLARETs_0048_0000.nii.gz completed in 10.52s total (preprocess: 2.13s, inference: 5.38s, postprocess: 3.00s)
Step 4/4: Ready for next case...

=== Processing case 49/200: FLARETs_0049_0000.nii.gz ===
File FLARETs_0049_0000.nii.gz: 54.52 MB
Total file size: 54.52 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.85s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  2.99it/s]  4%|▍         | 2/45 [00:00<00:14,  3.02it/s]  7%|▋         | 3/45 [00:00<00:13,  3.03it/s]  9%|▉         | 4/45 [00:01<00:13,  3.03it/s] 11%|█         | 5/45 [00:01<00:13,  3.04it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.04it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.04it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.04it/s] 20%|██        | 9/45 [00:02<00:11,  3.04it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.03it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.02it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.02it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.01it/s] 31%|███       | 14/45 [00:04<00:10,  3.01it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.02it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.03it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.03it/s] 40%|████      | 18/45 [00:05<00:08,  3.03it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.03it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.03it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.04it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.04it/s] 51%|█████     | 23/45 [00:07<00:07,  3.05it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.05it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.04it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.04it/s] 60%|██████    | 27/45 [00:08<00:05,  3.03it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.03it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.03it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.04it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.04it/s] 71%|███████   | 32/45 [00:10<00:04,  3.03it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.03it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.01it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.00it/s] 80%|████████  | 36/45 [00:11<00:03,  3.00it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.99it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.98it/s] 87%|████████▋ | 39/45 [00:12<00:02,  2.99it/s] 89%|████████▉ | 40/45 [00:13<00:01,  2.99it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.01it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.01it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.00it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.01it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]100%|██████████| 45/45 [00:14<00:00,  3.02it/s]
Inference completed in 14.96s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.72GB
输入形状: (14, 210, 250, 250)
目标形状: (175, 512, 512)
预估内存需求: 2.39GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8333333333333334, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.70s
重采样后内存: 4.11GB (增加: 2.39GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 175, 512, 512), 内存占用: 2.39GB
分块策略: 块大小=7, 预计块数=25
创建了 25 个处理块，每块约 7 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.69s
处理完成后内存: 1.76GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.43s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.00s
Case FLARETs_0049_0000.nii.gz completed in 22.81s total (preprocess: 3.85s, inference: 14.96s, postprocess: 4.00s)
Step 4/4: Ready for next case...

=== Processing case 50/200: FLARETs_0050_0000.nii.gz ===
File FLARETs_0050_0000.nii.gz: 55.88 MB
Total file size: 55.88 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.92s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.94it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.95it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.97it/s] 25%|██▌       | 4/16 [00:01<00:04,  3.00it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.00it/s] 38%|███▊      | 6/16 [00:02<00:03,  3.01it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.03it/s] 50%|█████     | 8/16 [00:02<00:02,  3.04it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.03it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.03it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.03it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.03it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.03it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.02it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.03it/s]100%|██████████| 16/16 [00:05<00:00,  3.04it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]
Inference completed in 5.34s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.50GB
输入形状: (14, 196, 190, 190)
目标形状: (163, 512, 512)
预估内存需求: 2.23GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8316326530612245, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.53s
重采样后内存: 3.73GB (增加: 2.23GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 163, 512, 512), 内存占用: 2.23GB
分块策略: 块大小=6, 预计块数=28
创建了 28 个处理块，每块约 6 切片
后处理进度: 7/28 块 (25.0%)
后处理进度: 14/28 块 (50.0%)
后处理进度: 21/28 块 (75.0%)
后处理进度: 28/28 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.60s
处理完成后内存: 1.58GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.17s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.62s
Case FLARETs_0050_0000.nii.gz completed in 11.88s total (preprocess: 2.92s, inference: 5.34s, postprocess: 3.62s)
Step 4/4: Ready for next case...

=== Processing case 51/200: FLARETs_0051_0000.nii.gz ===
File FLARETs_0051_0000.nii.gz: 56.07 MB
Total file size: 56.07 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.65s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:08,  3.14it/s]  7%|▋         | 2/27 [00:00<00:07,  3.15it/s] 11%|█         | 3/27 [00:00<00:07,  3.12it/s] 15%|█▍        | 4/27 [00:01<00:07,  3.13it/s] 19%|█▊        | 5/27 [00:01<00:07,  3.14it/s] 22%|██▏       | 6/27 [00:01<00:06,  3.12it/s] 26%|██▌       | 7/27 [00:02<00:06,  3.14it/s] 30%|██▉       | 8/27 [00:02<00:06,  3.15it/s] 33%|███▎      | 9/27 [00:02<00:05,  3.20it/s] 37%|███▋      | 10/27 [00:03<00:05,  3.17it/s] 41%|████      | 11/27 [00:03<00:05,  3.14it/s] 44%|████▍     | 12/27 [00:03<00:04,  3.12it/s] 48%|████▊     | 13/27 [00:04<00:04,  3.11it/s] 52%|█████▏    | 14/27 [00:04<00:04,  3.10it/s] 56%|█████▌    | 15/27 [00:04<00:03,  3.09it/s] 59%|█████▉    | 16/27 [00:05<00:03,  3.09it/s] 63%|██████▎   | 17/27 [00:05<00:03,  3.08it/s] 67%|██████▋   | 18/27 [00:05<00:02,  3.09it/s] 70%|███████   | 19/27 [00:06<00:02,  3.09it/s] 74%|███████▍  | 20/27 [00:06<00:02,  3.09it/s] 78%|███████▊  | 21/27 [00:06<00:01,  3.08it/s] 81%|████████▏ | 22/27 [00:07<00:01,  3.08it/s] 85%|████████▌ | 23/27 [00:07<00:01,  3.08it/s] 89%|████████▉ | 24/27 [00:07<00:00,  3.09it/s] 93%|█████████▎| 25/27 [00:08<00:00,  3.09it/s] 96%|█████████▋| 26/27 [00:08<00:00,  3.09it/s]100%|██████████| 27/27 [00:08<00:00,  3.09it/s]100%|██████████| 27/27 [00:08<00:00,  3.11it/s]
Inference completed in 8.73s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.62GB
输入形状: (14, 144, 250, 250)
目标形状: (240, 512, 512)
预估内存需求: 3.28GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.6666666666666667, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.73s
重采样后内存: 4.90GB (增加: 3.28GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 240, 512, 512), 内存占用: 3.28GB
分块策略: 块大小=10, 预计块数=24
创建了 24 个处理块，每块约 10 切片
后处理进度: 6/24 块 (25.0%)
后处理进度: 12/24 块 (50.0%)
后处理进度: 18/24 块 (75.0%)
后处理进度: 24/24 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.83s
处理完成后内存: 1.68GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.08s
🎯 深度优化总耗时: 4.64s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 5.14s
Case FLARETs_0051_0000.nii.gz completed in 19.53s total (preprocess: 5.65s, inference: 8.73s, postprocess: 5.14s)
Step 4/4: Ready for next case...

=== Processing case 52/200: FLARETs_0052_0000.nii.gz ===
File FLARETs_0052_0000.nii.gz: 20.67 MB
Total file size: 20.67 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.71s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.99it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.88it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.85it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.83it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.82it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.88it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.91it/s] 50%|█████     | 8/16 [00:02<00:02,  2.94it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.96it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.98it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.98it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.98it/s] 81%|████████▏ | 13/16 [00:04<00:01,  3.00it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.01it/s] 94%|█████████▍| 15/16 [00:05<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.00it/s]100%|██████████| 16/16 [00:05<00:00,  2.95it/s]
Inference completed in 5.46s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.55GB
输入形状: (14, 179, 192, 192)
目标形状: (90, 512, 512)
预估内存需求: 1.23GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5027932960893855, 2.6666666666666665, 2.6666666666666665]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.39s
重采样后内存: 2.78GB (增加: 1.23GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 90, 512, 512), 内存占用: 1.23GB
分块策略: 块大小=5, 预计块数=18
创建了 18 个处理块，每块约 5 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.36s
处理完成后内存: 1.55GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.78s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.22s
Case FLARETs_0052_0000.nii.gz completed in 9.39s total (preprocess: 1.71s, inference: 5.46s, postprocess: 2.22s)
Step 4/4: Ready for next case...

=== Processing case 53/200: FLARETs_0053_0000.nii.gz ===
File FLARETs_0053_0000.nii.gz: 31.43 MB
Total file size: 31.43 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.89s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/54 [00:00<?, ?it/s]  2%|▏         | 1/54 [00:00<00:17,  3.05it/s]  4%|▎         | 2/54 [00:00<00:17,  3.01it/s]  6%|▌         | 3/54 [00:00<00:16,  3.02it/s]  7%|▋         | 4/54 [00:01<00:16,  3.01it/s]  9%|▉         | 5/54 [00:01<00:16,  3.02it/s] 11%|█         | 6/54 [00:01<00:15,  3.01it/s] 13%|█▎        | 7/54 [00:02<00:15,  3.01it/s] 15%|█▍        | 8/54 [00:02<00:15,  3.01it/s] 17%|█▋        | 9/54 [00:02<00:14,  3.01it/s] 19%|█▊        | 10/54 [00:03<00:14,  3.02it/s] 20%|██        | 11/54 [00:03<00:14,  3.01it/s] 22%|██▏       | 12/54 [00:03<00:13,  3.01it/s] 24%|██▍       | 13/54 [00:04<00:13,  3.02it/s] 26%|██▌       | 14/54 [00:04<00:13,  3.02it/s] 28%|██▊       | 15/54 [00:04<00:12,  3.03it/s] 30%|██▉       | 16/54 [00:05<00:12,  3.04it/s] 31%|███▏      | 17/54 [00:05<00:12,  3.04it/s] 33%|███▎      | 18/54 [00:05<00:11,  3.04it/s] 35%|███▌      | 19/54 [00:06<00:11,  3.04it/s] 37%|███▋      | 20/54 [00:06<00:11,  3.05it/s] 39%|███▉      | 21/54 [00:06<00:10,  3.04it/s] 41%|████      | 22/54 [00:07<00:10,  3.04it/s] 43%|████▎     | 23/54 [00:07<00:10,  3.05it/s] 44%|████▍     | 24/54 [00:07<00:09,  3.05it/s] 46%|████▋     | 25/54 [00:08<00:09,  3.05it/s] 48%|████▊     | 26/54 [00:08<00:09,  3.04it/s] 50%|█████     | 27/54 [00:08<00:08,  3.03it/s] 52%|█████▏    | 28/54 [00:09<00:08,  3.02it/s] 54%|█████▎    | 29/54 [00:09<00:08,  3.01it/s] 56%|█████▌    | 30/54 [00:09<00:07,  3.02it/s] 57%|█████▋    | 31/54 [00:10<00:07,  3.02it/s] 59%|█████▉    | 32/54 [00:10<00:07,  3.02it/s] 61%|██████    | 33/54 [00:10<00:06,  3.00it/s] 63%|██████▎   | 34/54 [00:11<00:06,  3.00it/s] 65%|██████▍   | 35/54 [00:11<00:06,  3.01it/s] 67%|██████▋   | 36/54 [00:11<00:05,  3.01it/s] 69%|██████▊   | 37/54 [00:12<00:05,  2.99it/s] 70%|███████   | 38/54 [00:12<00:05,  3.00it/s] 72%|███████▏  | 39/54 [00:12<00:04,  3.01it/s] 74%|███████▍  | 40/54 [00:13<00:04,  3.02it/s] 76%|███████▌  | 41/54 [00:13<00:04,  3.02it/s] 78%|███████▊  | 42/54 [00:13<00:03,  3.03it/s] 80%|███████▉  | 43/54 [00:14<00:03,  3.02it/s] 81%|████████▏ | 44/54 [00:14<00:03,  3.03it/s] 83%|████████▎ | 45/54 [00:14<00:02,  3.01it/s] 85%|████████▌ | 46/54 [00:15<00:02,  3.02it/s] 87%|████████▋ | 47/54 [00:15<00:02,  3.02it/s] 89%|████████▉ | 48/54 [00:15<00:01,  3.03it/s] 91%|█████████ | 49/54 [00:16<00:01,  3.02it/s] 93%|█████████▎| 50/54 [00:16<00:01,  3.01it/s] 94%|█████████▍| 51/54 [00:16<00:00,  3.01it/s] 96%|█████████▋| 52/54 [00:17<00:00,  3.02it/s] 98%|█████████▊| 53/54 [00:17<00:00,  3.02it/s]100%|██████████| 54/54 [00:17<00:00,  3.03it/s]100%|██████████| 54/54 [00:17<00:00,  3.02it/s]
Inference completed in 17.93s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.77GB
输入形状: (14, 258, 220, 220)
目标形状: (129, 512, 512)
预估内存需求: 1.76GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.327272727272727, 2.327272727272727]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.02s
重采样后内存: 3.49GB (增加: 1.72GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 129, 512, 512), 内存占用: 1.76GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.76GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.49s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.06s
Case FLARETs_0053_0000.nii.gz completed in 23.88s total (preprocess: 2.89s, inference: 17.93s, postprocess: 3.06s)
Step 4/4: Ready for next case...

=== Processing case 54/200: FLARETs_0054_0000.nii.gz ===
File FLARETs_0054_0000.nii.gz: 22.38 MB
Total file size: 22.38 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.56s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.97it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.99it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.99it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.02it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.02it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.00it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.00it/s] 50%|█████     | 8/16 [00:02<00:02,  3.02it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.00it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.02it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.02it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.03it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.02it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.02it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]100%|██████████| 16/16 [00:05<00:00,  3.01it/s]
Inference completed in 5.34s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.59GB
输入形状: (14, 162, 190, 190)
目标形状: (81, 512, 512)
预估内存需求: 1.11GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.27s
重采样后内存: 2.69GB (增加: 1.11GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 81, 512, 512), 内存占用: 1.11GB
分块策略: 块大小=5, 预计块数=17
创建了 17 个处理块，每块约 5 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.27s
处理完成后内存: 1.59GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.56s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 1.99s
Case FLARETs_0054_0000.nii.gz completed in 8.90s total (preprocess: 1.56s, inference: 5.34s, postprocess: 1.99s)
Step 4/4: Ready for next case...

=== Processing case 55/200: FLARETs_0055_0000.nii.gz ===
File FLARETs_0055_0000.nii.gz: 27.14 MB
Total file size: 27.14 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.86s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.93it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.01it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.99it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.01it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.01it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.04it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.04it/s] 50%|█████     | 8/16 [00:02<00:02,  3.04it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.03it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.03it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.02it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.03it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.02it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.02it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.02it/s]100%|██████████| 16/16 [00:05<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]
Inference completed in 5.34s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.58GB
输入形状: (14, 190, 190, 190)
目标形状: (95, 512, 512)
预估内存需求: 1.30GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.50s
重采样后内存: 2.88GB (增加: 1.30GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 95, 512, 512), 内存占用: 1.30GB
分块策略: 块大小=5, 预计块数=19
创建了 19 个处理块，每块约 5 切片
后处理进度: 4/19 块 (21.1%)
后处理进度: 8/19 块 (42.1%)
后处理进度: 12/19 块 (63.2%)
后处理进度: 16/19 块 (84.2%)
✅ 并行后处理完成
后处理耗时: 0.37s
处理完成后内存: 1.58GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.90s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.35s
Case FLARETs_0055_0000.nii.gz completed in 9.54s total (preprocess: 1.86s, inference: 5.34s, postprocess: 2.35s)
Step 4/4: Ready for next case...

=== Processing case 56/200: FLARETs_0056_0000.nii.gz ===
File FLARETs_0056_0000.nii.gz: 24.68 MB
Total file size: 24.68 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.81s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.02it/s]  6%|▌         | 2/36 [00:00<00:11,  3.04it/s]  8%|▊         | 3/36 [00:00<00:10,  3.02it/s] 11%|█         | 4/36 [00:01<00:10,  3.05it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.05it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.06it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.07it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.07it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.07it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.07it/s] 31%|███       | 11/36 [00:03<00:08,  3.07it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.06it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.07it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.07it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.04it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.05it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.04it/s] 50%|█████     | 18/36 [00:05<00:05,  3.03it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.03it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.04it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.05it/s] 61%|██████    | 22/36 [00:07<00:04,  3.05it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.06it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.06it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.06it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.06it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.06it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.06it/s] 81%|████████  | 29/36 [00:09<00:02,  3.06it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.06it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.04it/s] 89%|████████▉ | 32/36 [00:10<00:01,  2.99it/s] 92%|█████████▏| 33/36 [00:10<00:01,  2.95it/s] 94%|█████████▍| 34/36 [00:11<00:00,  2.93it/s] 97%|█████████▋| 35/36 [00:11<00:00,  2.91it/s]100%|██████████| 36/36 [00:11<00:00,  2.96it/s]100%|██████████| 36/36 [00:11<00:00,  3.03it/s]
Inference completed in 11.91s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.56GB
输入形状: (14, 168, 211, 211)
目标形状: (84, 512, 512)
预估内存需求: 1.15GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.4265402843601898, 2.4265402843601898]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.30s
重采样后内存: 2.71GB (增加: 1.15GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 84, 512, 512), 内存占用: 1.15GB
分块策略: 块大小=5, 预计块数=17
创建了 17 个处理块，每块约 5 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.33s
处理完成后内存: 1.57GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.66s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.11s
Case FLARETs_0056_0000.nii.gz completed in 15.84s total (preprocess: 1.81s, inference: 11.91s, postprocess: 2.11s)
Step 4/4: Ready for next case...

=== Processing case 57/200: FLARETs_0057_0000.nii.gz ===
File FLARETs_0057_0000.nii.gz: 23.14 MB
Total file size: 23.14 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.43s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:03,  3.08it/s] 17%|█▋        | 2/12 [00:00<00:03,  3.08it/s] 25%|██▌       | 3/12 [00:00<00:02,  3.05it/s] 33%|███▎      | 4/12 [00:01<00:02,  3.04it/s] 42%|████▏     | 5/12 [00:01<00:02,  3.04it/s] 50%|█████     | 6/12 [00:01<00:01,  3.05it/s] 58%|█████▊    | 7/12 [00:02<00:01,  3.06it/s] 67%|██████▋   | 8/12 [00:02<00:01,  3.06it/s] 75%|███████▌  | 9/12 [00:02<00:00,  3.06it/s] 83%|████████▎ | 10/12 [00:03<00:00,  3.05it/s] 92%|█████████▏| 11/12 [00:03<00:00,  3.04it/s]100%|██████████| 12/12 [00:03<00:00,  3.05it/s]100%|██████████| 12/12 [00:03<00:00,  3.05it/s]
Inference completed in 3.96s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.52GB
输入形状: (14, 160, 173, 173)
目标形状: (80, 512, 512)
预估内存需求: 1.09GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.959537572254335, 2.959537572254335]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.24s
重采样后内存: 2.61GB (增加: 1.09GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 80, 512, 512), 内存占用: 1.09GB
分块策略: 块大小=5, 预计块数=16
创建了 16 个处理块，每块约 5 切片
后处理进度: 4/16 块 (25.0%)
后处理进度: 8/16 块 (50.0%)
后处理进度: 12/16 块 (75.0%)
后处理进度: 16/16 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.27s
处理完成后内存: 1.52GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.53s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 1.93s
Case FLARETs_0057_0000.nii.gz completed in 7.32s total (preprocess: 1.43s, inference: 3.96s, postprocess: 1.93s)
Step 4/4: Ready for next case...

=== Processing case 58/200: FLARETs_0058_0000.nii.gz ===
File FLARETs_0058_0000.nii.gz: 16.17 MB
Total file size: 16.17 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.16s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  3.01it/s] 11%|█         | 2/18 [00:00<00:05,  2.99it/s] 17%|█▋        | 3/18 [00:00<00:04,  3.00it/s] 22%|██▏       | 4/18 [00:01<00:04,  3.00it/s] 28%|██▊       | 5/18 [00:01<00:04,  3.01it/s] 33%|███▎      | 6/18 [00:01<00:03,  3.01it/s] 39%|███▉      | 7/18 [00:02<00:03,  3.02it/s] 44%|████▍     | 8/18 [00:02<00:03,  3.03it/s] 50%|█████     | 9/18 [00:02<00:02,  3.02it/s] 56%|█████▌    | 10/18 [00:03<00:02,  3.01it/s] 61%|██████    | 11/18 [00:03<00:02,  3.01it/s] 67%|██████▋   | 12/18 [00:03<00:01,  3.01it/s] 72%|███████▏  | 13/18 [00:04<00:01,  3.02it/s] 78%|███████▊  | 14/18 [00:04<00:01,  3.02it/s] 83%|████████▎ | 15/18 [00:04<00:00,  3.01it/s] 89%|████████▉ | 16/18 [00:05<00:00,  3.01it/s] 94%|█████████▍| 17/18 [00:05<00:00,  3.00it/s]100%|██████████| 18/18 [00:05<00:00,  3.00it/s]100%|██████████| 18/18 [00:05<00:00,  3.01it/s]
Inference completed in 6.01s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.48GB
输入形状: (14, 112, 207, 207)
目标形状: (56, 512, 512)
预估内存需求: 0.77GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.473429951690821, 2.473429951690821]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 0.88s
重采样后内存: 2.25GB (增加: 0.77GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 56, 512, 512), 内存占用: 0.77GB
分块策略: 块大小=3, 预计块数=19
创建了 19 个处理块，每块约 3 切片
后处理进度: 4/19 块 (21.1%)
后处理进度: 8/19 块 (42.1%)
后处理进度: 12/19 块 (63.2%)
后处理进度: 16/19 块 (84.2%)
✅ 并行后处理完成
后处理耗时: 0.20s
处理完成后内存: 1.54GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.10s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 1.50s
Case FLARETs_0058_0000.nii.gz completed in 8.67s total (preprocess: 1.16s, inference: 6.01s, postprocess: 1.50s)
Step 4/4: Ready for next case...

=== Processing case 59/200: FLARETs_0059_0000.nii.gz ===
File FLARETs_0059_0000.nii.gz: 15.58 MB
Total file size: 15.58 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.18s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  2.96it/s] 11%|█         | 2/18 [00:00<00:05,  2.97it/s] 17%|█▋        | 3/18 [00:01<00:05,  2.98it/s] 22%|██▏       | 4/18 [00:01<00:04,  2.98it/s] 28%|██▊       | 5/18 [00:01<00:04,  2.98it/s] 33%|███▎      | 6/18 [00:02<00:04,  2.97it/s] 39%|███▉      | 7/18 [00:02<00:03,  2.99it/s] 44%|████▍     | 8/18 [00:02<00:03,  2.98it/s] 50%|█████     | 9/18 [00:03<00:03,  2.99it/s] 56%|█████▌    | 10/18 [00:03<00:02,  2.99it/s] 61%|██████    | 11/18 [00:03<00:02,  2.99it/s] 67%|██████▋   | 12/18 [00:04<00:02,  3.00it/s] 72%|███████▏  | 13/18 [00:04<00:01,  3.00it/s] 78%|███████▊  | 14/18 [00:04<00:01,  3.01it/s] 83%|████████▎ | 15/18 [00:05<00:01,  3.00it/s] 89%|████████▉ | 16/18 [00:05<00:00,  2.99it/s] 94%|█████████▍| 17/18 [00:05<00:00,  2.99it/s]100%|██████████| 18/18 [00:06<00:00,  2.97it/s]100%|██████████| 18/18 [00:06<00:00,  2.98it/s]
Inference completed in 6.06s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.49GB
输入形状: (14, 110, 216, 216)
目标形状: (55, 512, 512)
预估内存需求: 0.75GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.3703703703703702, 2.3703703703703702]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 0.85s
重采样后内存: 2.24GB (增加: 0.75GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 55, 512, 512), 内存占用: 0.75GB
分块策略: 块大小=3, 预计块数=19
创建了 19 个处理块，每块约 3 切片
后处理进度: 4/19 块 (21.1%)
后处理进度: 8/19 块 (42.1%)
后处理进度: 12/19 块 (63.2%)
后处理进度: 16/19 块 (84.2%)
✅ 并行后处理完成
后处理耗时: 0.20s
处理完成后内存: 1.50GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.07s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 1.48s
Case FLARETs_0059_0000.nii.gz completed in 8.71s total (preprocess: 1.18s, inference: 6.06s, postprocess: 1.48s)
Step 4/4: Ready for next case...

=== Processing case 60/200: FLARETs_0060_0000.nii.gz ===
File FLARETs_0060_0000.nii.gz: 15.67 MB
Total file size: 15.67 MB
Step 1/4: Preprocessing...
Preprocessing completed in 0.95s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:02,  2.95it/s] 25%|██▌       | 2/8 [00:00<00:01,  3.00it/s] 38%|███▊      | 3/8 [00:01<00:01,  2.99it/s] 50%|█████     | 4/8 [00:01<00:01,  3.02it/s] 62%|██████▎   | 5/8 [00:01<00:00,  3.02it/s] 75%|███████▌  | 6/8 [00:01<00:00,  3.02it/s] 88%|████████▊ | 7/8 [00:02<00:00,  3.00it/s]100%|██████████| 8/8 [00:02<00:00,  3.03it/s]100%|██████████| 8/8 [00:02<00:00,  3.01it/s]
Inference completed in 2.68s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.57GB
输入形状: (14, 102, 190, 190)
目标形状: (51, 512, 512)
预估内存需求: 0.70GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 0.80s
重采样后内存: 2.27GB (增加: 0.70GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 51, 512, 512), 内存占用: 0.70GB
分块策略: 块大小=3, 预计块数=17
创建了 17 个处理块，每块约 3 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.20s
处理完成后内存: 1.57GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.02s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 1.39s
Case FLARETs_0060_0000.nii.gz completed in 5.02s total (preprocess: 0.95s, inference: 2.68s, postprocess: 1.39s)
Step 4/4: Ready for next case...

=== Processing case 61/200: FLARETs_0061_0000.nii.gz ===
File FLARETs_0061_0000.nii.gz: 30.49 MB
Total file size: 30.49 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.99s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.96it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.99it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.96it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.97it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.98it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.99it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.99it/s] 50%|█████     | 8/16 [00:02<00:02,  2.98it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.98it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.99it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.97it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.98it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.99it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.00it/s] 94%|█████████▍| 15/16 [00:05<00:00,  3.00it/s]100%|██████████| 16/16 [00:05<00:00,  2.99it/s]100%|██████████| 16/16 [00:05<00:00,  2.98it/s]
Inference completed in 5.40s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.55GB
输入形状: (14, 198, 192, 192)
目标形状: (99, 512, 512)
预估内存需求: 1.35GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.6666666666666665, 2.6666666666666665]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.54s
重采样后内存: 2.90GB (增加: 1.35GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 99, 512, 512), 内存占用: 1.35GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.37s
处理完成后内存: 1.57GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.93s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.38s
Case FLARETs_0061_0000.nii.gz completed in 9.77s total (preprocess: 1.99s, inference: 5.40s, postprocess: 2.38s)
Step 4/4: Ready for next case...

=== Processing case 62/200: FLARETs_0062_0000.nii.gz ===
File FLARETs_0062_0000.nii.gz: 30.56 MB
Total file size: 30.56 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.89s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.06it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.12it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.10it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.12it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.10it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.10it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.09it/s] 50%|█████     | 8/16 [00:02<00:02,  3.09it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.09it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.10it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.08it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.08it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.07it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.09it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.08it/s]100%|██████████| 16/16 [00:05<00:00,  3.10it/s]100%|██████████| 16/16 [00:05<00:00,  3.09it/s]
Inference completed in 5.21s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.57GB
输入形状: (14, 194, 180, 180)
目标形状: (97, 512, 512)
预估内存需求: 1.33GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.8444444444444446, 2.8444444444444446]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.52s
重采样后内存: 2.89GB (增加: 1.33GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 97, 512, 512), 内存占用: 1.33GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.33s
处理完成后内存: 1.57GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.88s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.31s
Case FLARETs_0062_0000.nii.gz completed in 9.41s total (preprocess: 1.89s, inference: 5.21s, postprocess: 2.31s)
Step 4/4: Ready for next case...

=== Processing case 63/200: FLARETs_0063_0000.nii.gz ===
File FLARETs_0063_0000.nii.gz: 113.12 MB
Total file size: 113.12 MB
⚠️  File size (113.12 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0063.nii.gz with shape (512, 512, 361)
✅ Dummy results generated: FLARETs_0063.nii.gz
Case FLARETs_0063_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 64/200: FLARETs_0064_0000.nii.gz ===
File FLARETs_0064_0000.nii.gz: 42.43 MB
Total file size: 42.43 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.50s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/63 [00:00<?, ?it/s]  2%|▏         | 1/63 [00:00<00:20,  2.98it/s]  3%|▎         | 2/63 [00:00<00:20,  3.00it/s]  5%|▍         | 3/63 [00:01<00:20,  3.00it/s]  6%|▋         | 4/63 [00:01<00:19,  3.01it/s]  8%|▊         | 5/63 [00:01<00:19,  2.98it/s] 10%|▉         | 6/63 [00:02<00:19,  3.00it/s] 11%|█         | 7/63 [00:02<00:18,  3.02it/s] 13%|█▎        | 8/63 [00:02<00:18,  3.03it/s] 14%|█▍        | 9/63 [00:02<00:17,  3.04it/s] 16%|█▌        | 10/63 [00:03<00:17,  3.01it/s] 17%|█▋        | 11/63 [00:03<00:17,  3.00it/s] 19%|█▉        | 12/63 [00:03<00:16,  3.02it/s] 21%|██        | 13/63 [00:04<00:16,  2.98it/s] 22%|██▏       | 14/63 [00:04<00:16,  2.92it/s] 24%|██▍       | 15/63 [00:05<00:16,  2.88it/s] 25%|██▌       | 16/63 [00:05<00:16,  2.85it/s] 27%|██▋       | 17/63 [00:05<00:16,  2.84it/s] 29%|██▊       | 18/63 [00:06<00:15,  2.85it/s] 30%|███       | 19/63 [00:06<00:15,  2.89it/s] 32%|███▏      | 20/63 [00:06<00:14,  2.92it/s] 33%|███▎      | 21/63 [00:07<00:14,  2.95it/s] 35%|███▍      | 22/63 [00:07<00:13,  2.98it/s] 37%|███▋      | 23/63 [00:07<00:13,  3.00it/s] 38%|███▊      | 24/63 [00:08<00:12,  3.01it/s] 40%|███▉      | 25/63 [00:08<00:12,  3.00it/s] 41%|████▏     | 26/63 [00:08<00:12,  3.02it/s] 43%|████▎     | 27/63 [00:09<00:11,  3.02it/s] 44%|████▍     | 28/63 [00:09<00:11,  3.02it/s] 46%|████▌     | 29/63 [00:09<00:11,  3.02it/s] 48%|████▊     | 30/63 [00:10<00:10,  3.02it/s] 49%|████▉     | 31/63 [00:10<00:10,  3.00it/s] 51%|█████     | 32/63 [00:10<00:10,  3.01it/s] 52%|█████▏    | 33/63 [00:11<00:09,  3.01it/s] 54%|█████▍    | 34/63 [00:11<00:09,  3.01it/s] 56%|█████▌    | 35/63 [00:11<00:09,  3.01it/s] 57%|█████▋    | 36/63 [00:12<00:08,  3.02it/s] 59%|█████▊    | 37/63 [00:12<00:08,  3.01it/s] 60%|██████    | 38/63 [00:12<00:08,  2.99it/s] 62%|██████▏   | 39/63 [00:13<00:08,  2.99it/s] 63%|██████▎   | 40/63 [00:13<00:07,  3.00it/s] 65%|██████▌   | 41/63 [00:13<00:07,  2.98it/s] 67%|██████▋   | 42/63 [00:14<00:07,  3.00it/s] 68%|██████▊   | 43/63 [00:14<00:06,  3.00it/s] 70%|██████▉   | 44/63 [00:14<00:06,  3.00it/s] 71%|███████▏  | 45/63 [00:15<00:05,  3.00it/s] 73%|███████▎  | 46/63 [00:15<00:05,  3.00it/s] 75%|███████▍  | 47/63 [00:15<00:05,  3.00it/s] 76%|███████▌  | 48/63 [00:16<00:04,  3.01it/s] 78%|███████▊  | 49/63 [00:16<00:04,  3.01it/s] 79%|███████▉  | 50/63 [00:16<00:04,  3.02it/s] 81%|████████  | 51/63 [00:17<00:03,  3.02it/s] 83%|████████▎ | 52/63 [00:17<00:03,  3.03it/s] 84%|████████▍ | 53/63 [00:17<00:03,  3.00it/s] 86%|████████▌ | 54/63 [00:18<00:03,  3.00it/s] 87%|████████▋ | 55/63 [00:18<00:02,  3.00it/s] 89%|████████▉ | 56/63 [00:18<00:02,  3.01it/s] 90%|█████████ | 57/63 [00:19<00:01,  3.00it/s] 92%|█████████▏| 58/63 [00:19<00:01,  3.01it/s] 94%|█████████▎| 59/63 [00:19<00:01,  3.02it/s] 95%|█████████▌| 60/63 [00:20<00:00,  3.02it/s] 97%|█████████▋| 61/63 [00:20<00:00,  3.03it/s] 98%|█████████▊| 62/63 [00:20<00:00,  3.02it/s]100%|██████████| 63/63 [00:21<00:00,  3.01it/s]100%|██████████| 63/63 [00:21<00:00,  2.99it/s]
Inference completed in 21.13s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.83GB
输入形状: (14, 286, 229, 229)
目标形状: (143, 512, 512)
预估内存需求: 1.96GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.2358078602620086, 2.2358078602620086]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.24s
重采样后内存: 3.79GB (增加: 1.96GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 143, 512, 512), 内存占用: 1.96GB
分块策略: 块大小=8, 预计块数=18
创建了 18 个处理块，每块约 8 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.87GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.86s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.48s
Case FLARETs_0064_0000.nii.gz completed in 28.11s total (preprocess: 3.50s, inference: 21.13s, postprocess: 3.48s)
Step 4/4: Ready for next case...

=== Processing case 65/200: FLARETs_0065_0000.nii.gz ===
File FLARETs_0065_0000.nii.gz: 25.23 MB
Total file size: 25.23 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.70s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.07it/s]  4%|▍         | 2/45 [00:00<00:13,  3.08it/s]  7%|▋         | 3/45 [00:00<00:13,  3.07it/s]  9%|▉         | 4/45 [00:01<00:13,  3.08it/s] 11%|█         | 5/45 [00:01<00:13,  3.07it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.06it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.07it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.06it/s] 20%|██        | 9/45 [00:02<00:11,  3.07it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.07it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.06it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.06it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.04it/s] 31%|███       | 14/45 [00:04<00:10,  3.04it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.03it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.02it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.02it/s] 40%|████      | 18/45 [00:05<00:08,  3.02it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.03it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.04it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.03it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.03it/s] 51%|█████     | 23/45 [00:07<00:07,  3.03it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.03it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.04it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.02it/s] 60%|██████    | 27/45 [00:08<00:05,  3.03it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.03it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.03it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.02it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.01it/s] 71%|███████   | 32/45 [00:10<00:04,  3.02it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.03it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.04it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.03it/s] 80%|████████  | 36/45 [00:11<00:02,  3.02it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.02it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.04it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.03it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.04it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.03it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.02it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.99it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.00it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]100%|██████████| 45/45 [00:14<00:00,  3.03it/s]
Inference completed in 14.90s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.74GB
输入形状: (14, 208, 250, 250)
目标形状: (104, 512, 512)
预估内存需求: 1.42GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.63s
重采样后内存: 3.17GB (增加: 1.42GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 104, 512, 512), 内存占用: 1.42GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.80GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 2.09s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.67s
Case FLARETs_0065_0000.nii.gz completed in 20.26s total (preprocess: 2.70s, inference: 14.90s, postprocess: 2.67s)
Step 4/4: Ready for next case...

=== Processing case 66/200: FLARETs_0066_0000.nii.gz ===
File FLARETs_0066_0000.nii.gz: 26.94 MB
Total file size: 26.94 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.65s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.01it/s]  4%|▍         | 2/45 [00:00<00:14,  2.97it/s]  7%|▋         | 3/45 [00:01<00:14,  2.99it/s]  9%|▉         | 4/45 [00:01<00:13,  2.98it/s] 11%|█         | 5/45 [00:01<00:13,  2.99it/s] 13%|█▎        | 6/45 [00:02<00:12,  3.00it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.00it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.01it/s] 20%|██        | 9/45 [00:03<00:11,  3.01it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.01it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.02it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.02it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.01it/s] 31%|███       | 14/45 [00:04<00:10,  3.00it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.00it/s] 36%|███▌      | 16/45 [00:05<00:09,  2.99it/s] 38%|███▊      | 17/45 [00:05<00:09,  2.99it/s] 40%|████      | 18/45 [00:06<00:09,  2.99it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.00it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.00it/s] 47%|████▋     | 21/45 [00:07<00:08,  2.98it/s] 49%|████▉     | 22/45 [00:07<00:07,  2.98it/s] 51%|█████     | 23/45 [00:07<00:07,  2.98it/s] 53%|█████▎    | 24/45 [00:08<00:07,  2.99it/s] 56%|█████▌    | 25/45 [00:08<00:06,  2.99it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.00it/s] 60%|██████    | 27/45 [00:09<00:06,  3.00it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.00it/s] 64%|██████▍   | 29/45 [00:09<00:05,  2.99it/s] 67%|██████▋   | 30/45 [00:10<00:05,  3.00it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.00it/s] 71%|███████   | 32/45 [00:10<00:04,  3.00it/s] 73%|███████▎  | 33/45 [00:11<00:03,  3.01it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.01it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.02it/s] 80%|████████  | 36/45 [00:11<00:02,  3.02it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.01it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.01it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.01it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.00it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.00it/s] 93%|█████████▎| 42/45 [00:14<00:01,  2.99it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.99it/s] 98%|█████████▊| 44/45 [00:14<00:00,  2.99it/s]100%|██████████| 45/45 [00:15<00:00,  2.99it/s]100%|██████████| 45/45 [00:15<00:00,  3.00it/s]
Inference completed in 15.07s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.73GB
输入形状: (14, 218, 239, 239)
目标形状: (109, 512, 512)
预估内存需求: 1.49GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.1422594142259412, 2.1422594142259412]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.70s
重采样后内存: 3.22GB (增加: 1.49GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 109, 512, 512), 内存占用: 1.49GB
分块策略: 块大小=6, 预计块数=19
创建了 19 个处理块，每块约 6 切片
后处理进度: 4/19 块 (21.1%)
后处理进度: 8/19 块 (42.1%)
后处理进度: 12/19 块 (63.2%)
后处理进度: 16/19 块 (84.2%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.75GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.07s
🎯 深度优化总耗时: 2.21s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.77s
Case FLARETs_0066_0000.nii.gz completed in 20.49s total (preprocess: 2.65s, inference: 15.07s, postprocess: 2.77s)
Step 4/4: Ready for next case...

=== Processing case 67/200: FLARETs_0067_0000.nii.gz ===
File FLARETs_0067_0000.nii.gz: 25.30 MB
Total file size: 25.30 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.55s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:15,  2.91it/s]  4%|▍         | 2/45 [00:00<00:14,  2.96it/s]  7%|▋         | 3/45 [00:01<00:14,  2.99it/s]  9%|▉         | 4/45 [00:01<00:13,  2.99it/s] 11%|█         | 5/45 [00:01<00:13,  2.99it/s] 13%|█▎        | 6/45 [00:02<00:13,  3.00it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.00it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.00it/s] 20%|██        | 9/45 [00:03<00:11,  3.01it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.01it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.02it/s] 27%|██▋       | 12/45 [00:04<00:11,  3.00it/s] 29%|██▉       | 13/45 [00:04<00:10,  2.99it/s] 31%|███       | 14/45 [00:04<00:10,  2.99it/s] 33%|███▎      | 15/45 [00:05<00:10,  2.99it/s] 36%|███▌      | 16/45 [00:05<00:09,  2.99it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.00it/s] 40%|████      | 18/45 [00:06<00:09,  2.99it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.00it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.01it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.02it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.01it/s] 51%|█████     | 23/45 [00:07<00:07,  3.02it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.01it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.02it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.02it/s] 60%|██████    | 27/45 [00:08<00:05,  3.03it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.02it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.02it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.02it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.03it/s] 71%|███████   | 32/45 [00:10<00:04,  3.02it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.02it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.01it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.02it/s] 80%|████████  | 36/45 [00:11<00:02,  3.01it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.99it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.99it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.01it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.02it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.01it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.01it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.99it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.00it/s]100%|██████████| 45/45 [00:14<00:00,  2.99it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]
Inference completed in 15.03s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.71GB
输入形状: (14, 206, 240, 240)
目标形状: (103, 512, 512)
预估内存需求: 1.41GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.1333333333333333, 2.1333333333333333]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.60s
重采样后内存: 3.12GB (增加: 1.41GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 103, 512, 512), 内存占用: 1.41GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.71GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 2.06s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.61s
Case FLARETs_0067_0000.nii.gz completed in 20.20s total (preprocess: 2.55s, inference: 15.03s, postprocess: 2.61s)
Step 4/4: Ready for next case...

=== Processing case 68/200: FLARETs_0068_0000.nii.gz ===
File FLARETs_0068_0000.nii.gz: 31.34 MB
Total file size: 31.34 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.71s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  2.96it/s]  4%|▍         | 2/45 [00:00<00:14,  2.97it/s]  7%|▋         | 3/45 [00:01<00:14,  2.99it/s]  9%|▉         | 4/45 [00:01<00:13,  2.98it/s] 11%|█         | 5/45 [00:01<00:13,  3.00it/s] 13%|█▎        | 6/45 [00:02<00:13,  2.99it/s] 16%|█▌        | 7/45 [00:02<00:12,  2.99it/s] 18%|█▊        | 8/45 [00:02<00:12,  2.98it/s] 20%|██        | 9/45 [00:03<00:12,  2.98it/s] 22%|██▏       | 10/45 [00:03<00:11,  2.98it/s] 24%|██▍       | 11/45 [00:03<00:11,  2.99it/s] 27%|██▋       | 12/45 [00:04<00:11,  2.98it/s] 29%|██▉       | 13/45 [00:04<00:10,  2.99it/s] 31%|███       | 14/45 [00:04<00:10,  2.99it/s] 33%|███▎      | 15/45 [00:05<00:10,  2.99it/s] 36%|███▌      | 16/45 [00:05<00:09,  2.98it/s] 38%|███▊      | 17/45 [00:05<00:09,  2.99it/s] 40%|████      | 18/45 [00:06<00:09,  2.98it/s] 42%|████▏     | 19/45 [00:06<00:08,  2.98it/s] 44%|████▍     | 20/45 [00:06<00:08,  2.98it/s] 47%|████▋     | 21/45 [00:07<00:08,  2.99it/s] 49%|████▉     | 22/45 [00:07<00:07,  2.97it/s] 51%|█████     | 23/45 [00:07<00:07,  2.96it/s] 53%|█████▎    | 24/45 [00:08<00:07,  2.95it/s] 56%|█████▌    | 25/45 [00:08<00:06,  2.96it/s] 58%|█████▊    | 26/45 [00:08<00:06,  2.96it/s] 60%|██████    | 27/45 [00:09<00:06,  2.95it/s] 62%|██████▏   | 28/45 [00:09<00:05,  2.94it/s] 64%|██████▍   | 29/45 [00:09<00:05,  2.96it/s] 67%|██████▋   | 30/45 [00:10<00:05,  2.95it/s] 69%|██████▉   | 31/45 [00:10<00:04,  2.96it/s] 71%|███████   | 32/45 [00:10<00:04,  2.97it/s] 73%|███████▎  | 33/45 [00:11<00:04,  2.97it/s] 76%|███████▌  | 34/45 [00:11<00:03,  2.98it/s] 78%|███████▊  | 35/45 [00:11<00:03,  2.99it/s] 80%|████████  | 36/45 [00:12<00:03,  2.99it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.99it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.98it/s] 87%|████████▋ | 39/45 [00:13<00:02,  2.98it/s] 89%|████████▉ | 40/45 [00:13<00:01,  2.97it/s] 91%|█████████ | 41/45 [00:13<00:01,  2.98it/s] 93%|█████████▎| 42/45 [00:14<00:01,  2.98it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.99it/s] 98%|█████████▊| 44/45 [00:14<00:00,  2.98it/s]100%|██████████| 45/45 [00:15<00:00,  2.98it/s]100%|██████████| 45/45 [00:15<00:00,  2.98it/s]
Inference completed in 15.18s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.71GB
输入形状: (14, 234, 226, 226)
目标形状: (117, 512, 512)
预估内存需求: 1.60GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.265486725663717, 2.265486725663717]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.80s
重采样后内存: 3.31GB (增加: 1.60GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 117, 512, 512), 内存占用: 1.60GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.47s
处理完成后内存: 1.74GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.30s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.86s
Case FLARETs_0068_0000.nii.gz completed in 20.74s total (preprocess: 2.71s, inference: 15.18s, postprocess: 2.86s)
Step 4/4: Ready for next case...

=== Processing case 69/200: FLARETs_0069_0000.nii.gz ===
File FLARETs_0069_0000.nii.gz: 24.81 MB
Total file size: 24.81 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.56s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.92it/s]  6%|▌         | 2/36 [00:00<00:11,  2.94it/s]  8%|▊         | 3/36 [00:01<00:11,  2.95it/s] 11%|█         | 4/36 [00:01<00:10,  2.94it/s] 14%|█▍        | 5/36 [00:01<00:10,  2.97it/s] 17%|█▋        | 6/36 [00:02<00:10,  2.98it/s] 19%|█▉        | 7/36 [00:02<00:09,  2.97it/s] 22%|██▏       | 8/36 [00:02<00:09,  2.98it/s] 25%|██▌       | 9/36 [00:03<00:09,  2.98it/s] 28%|██▊       | 10/36 [00:03<00:08,  2.99it/s] 31%|███       | 11/36 [00:03<00:08,  2.99it/s] 33%|███▎      | 12/36 [00:04<00:08,  2.97it/s] 36%|███▌      | 13/36 [00:04<00:07,  2.98it/s] 39%|███▉      | 14/36 [00:04<00:07,  2.98it/s] 42%|████▏     | 15/36 [00:05<00:07,  2.97it/s] 44%|████▍     | 16/36 [00:05<00:06,  2.98it/s] 47%|████▋     | 17/36 [00:05<00:06,  2.99it/s] 50%|█████     | 18/36 [00:06<00:06,  2.99it/s] 53%|█████▎    | 19/36 [00:06<00:05,  2.98it/s] 56%|█████▌    | 20/36 [00:06<00:05,  2.97it/s] 58%|█████▊    | 21/36 [00:07<00:05,  2.98it/s] 61%|██████    | 22/36 [00:07<00:04,  2.97it/s] 64%|██████▍   | 23/36 [00:07<00:04,  2.96it/s] 67%|██████▋   | 24/36 [00:08<00:04,  2.96it/s] 69%|██████▉   | 25/36 [00:08<00:03,  2.95it/s] 72%|███████▏  | 26/36 [00:08<00:03,  2.94it/s] 75%|███████▌  | 27/36 [00:09<00:03,  2.95it/s] 78%|███████▊  | 28/36 [00:09<00:02,  2.96it/s] 81%|████████  | 29/36 [00:09<00:02,  2.95it/s] 83%|████████▎ | 30/36 [00:10<00:02,  2.95it/s] 86%|████████▌ | 31/36 [00:10<00:01,  2.95it/s] 89%|████████▉ | 32/36 [00:10<00:01,  2.96it/s] 92%|█████████▏| 33/36 [00:11<00:01,  2.98it/s] 94%|█████████▍| 34/36 [00:11<00:00,  2.99it/s] 97%|█████████▋| 35/36 [00:11<00:00,  2.99it/s]100%|██████████| 36/36 [00:12<00:00,  3.00it/s]100%|██████████| 36/36 [00:12<00:00,  2.97it/s]
Inference completed in 12.17s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.72GB
输入形状: (14, 200, 247, 247)
目标形状: (100, 512, 512)
预估内存需求: 1.37GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.0728744939271255, 2.0728744939271255]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.52s
重采样后内存: 3.09GB (增加: 1.37GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 100, 512, 512), 内存占用: 1.37GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.39s
处理完成后内存: 1.72GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.93s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.49s
Case FLARETs_0069_0000.nii.gz completed in 17.23s total (preprocess: 2.56s, inference: 12.17s, postprocess: 2.49s)
Step 4/4: Ready for next case...

=== Processing case 70/200: FLARETs_0070_0000.nii.gz ===
File FLARETs_0070_0000.nii.gz: 62.68 MB
Total file size: 62.68 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.46s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.94it/s]  6%|▌         | 2/36 [00:00<00:11,  3.02it/s]  8%|▊         | 3/36 [00:00<00:10,  3.05it/s] 11%|█         | 4/36 [00:01<00:10,  3.02it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.01it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.03it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.02it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.04it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.05it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.04it/s] 31%|███       | 11/36 [00:03<00:08,  3.03it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.01it/s] 36%|███▌      | 13/36 [00:04<00:07,  2.99it/s] 39%|███▉      | 14/36 [00:04<00:07,  2.99it/s] 42%|████▏     | 15/36 [00:04<00:07,  2.97it/s] 44%|████▍     | 16/36 [00:05<00:06,  2.96it/s] 47%|████▋     | 17/36 [00:05<00:06,  2.96it/s] 50%|█████     | 18/36 [00:06<00:06,  2.96it/s] 53%|█████▎    | 19/36 [00:06<00:05,  2.96it/s] 56%|█████▌    | 20/36 [00:06<00:05,  2.97it/s] 58%|█████▊    | 21/36 [00:07<00:05,  2.97it/s] 61%|██████    | 22/36 [00:07<00:04,  2.97it/s] 64%|██████▍   | 23/36 [00:07<00:04,  2.97it/s] 67%|██████▋   | 24/36 [00:08<00:04,  2.96it/s] 69%|██████▉   | 25/36 [00:08<00:03,  2.96it/s] 72%|███████▏  | 26/36 [00:08<00:03,  2.96it/s] 75%|███████▌  | 27/36 [00:09<00:03,  2.96it/s] 78%|███████▊  | 28/36 [00:09<00:02,  2.95it/s] 81%|████████  | 29/36 [00:09<00:02,  2.95it/s] 83%|████████▎ | 30/36 [00:10<00:02,  2.95it/s] 86%|████████▌ | 31/36 [00:10<00:01,  2.96it/s] 89%|████████▉ | 32/36 [00:10<00:01,  2.94it/s] 92%|█████████▏| 33/36 [00:11<00:01,  2.94it/s] 94%|█████████▍| 34/36 [00:11<00:00,  2.95it/s] 97%|█████████▋| 35/36 [00:11<00:00,  2.93it/s]100%|██████████| 36/36 [00:12<00:00,  2.93it/s]100%|██████████| 36/36 [00:12<00:00,  2.97it/s]
Inference completed in 12.15s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.63GB
输入形状: (14, 199, 216, 216)
目标形状: (199, 512, 512)
预估内存需求: 2.72GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.3703703703703702, 2.3703703703703702]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.10s
重采样后内存: 4.36GB (增加: 2.72GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 199, 512, 512), 内存占用: 2.72GB
分块策略: 块大小=8, 预计块数=25
创建了 25 个处理块，每块约 8 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.77s
处理完成后内存: 1.68GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.92s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.41s
Case FLARETs_0070_0000.nii.gz completed in 22.02s total (preprocess: 5.46s, inference: 12.15s, postprocess: 4.41s)
Step 4/4: Ready for next case...

=== Processing case 71/200: FLARETs_0071_0000.nii.gz ===
File FLARETs_0071_0000.nii.gz: 33.95 MB
Total file size: 33.95 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.04s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  2.99it/s] 11%|█         | 2/18 [00:00<00:05,  2.99it/s] 17%|█▋        | 3/18 [00:01<00:05,  3.00it/s] 22%|██▏       | 4/18 [00:01<00:04,  3.00it/s] 28%|██▊       | 5/18 [00:01<00:04,  3.01it/s] 33%|███▎      | 6/18 [00:02<00:04,  3.00it/s] 39%|███▉      | 7/18 [00:02<00:03,  2.99it/s] 44%|████▍     | 8/18 [00:02<00:03,  3.00it/s] 50%|█████     | 9/18 [00:03<00:03,  2.99it/s] 56%|█████▌    | 10/18 [00:03<00:02,  2.99it/s] 61%|██████    | 11/18 [00:03<00:02,  3.00it/s] 67%|██████▋   | 12/18 [00:04<00:01,  3.01it/s] 72%|███████▏  | 13/18 [00:04<00:01,  3.02it/s] 78%|███████▊  | 14/18 [00:04<00:01,  3.02it/s] 83%|████████▎ | 15/18 [00:04<00:00,  3.02it/s] 89%|████████▉ | 16/18 [00:05<00:00,  3.02it/s] 94%|█████████▍| 17/18 [00:05<00:00,  3.02it/s]100%|██████████| 18/18 [00:05<00:00,  3.02it/s]100%|██████████| 18/18 [00:05<00:00,  3.01it/s]
Inference completed in 6.02s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.49GB
输入形状: (14, 108, 217, 217)
目标形状: (108, 512, 512)
预估内存需求: 1.48GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.359447004608295, 2.359447004608295]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.70s
重采样后内存: 2.97GB (增加: 1.48GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 108, 512, 512), 内存占用: 1.48GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.52GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.17s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.58s
Case FLARETs_0071_0000.nii.gz completed in 11.64s total (preprocess: 3.04s, inference: 6.02s, postprocess: 2.58s)
Step 4/4: Ready for next case...

=== Processing case 72/200: FLARETs_0072_0000.nii.gz ===
File FLARETs_0072_0000.nii.gz: 42.15 MB
Total file size: 42.15 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.56s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/54 [00:00<?, ?it/s]  2%|▏         | 1/54 [00:00<00:18,  2.90it/s]  4%|▎         | 2/54 [00:00<00:17,  2.90it/s]  6%|▌         | 3/54 [00:01<00:17,  2.91it/s]  7%|▋         | 4/54 [00:01<00:17,  2.93it/s]  9%|▉         | 5/54 [00:01<00:16,  2.93it/s] 11%|█         | 6/54 [00:02<00:16,  2.93it/s] 13%|█▎        | 7/54 [00:02<00:15,  2.95it/s] 15%|█▍        | 8/54 [00:02<00:15,  2.95it/s] 17%|█▋        | 9/54 [00:03<00:15,  2.95it/s] 19%|█▊        | 10/54 [00:03<00:14,  2.95it/s] 20%|██        | 11/54 [00:03<00:14,  2.95it/s] 22%|██▏       | 12/54 [00:04<00:14,  2.96it/s] 24%|██▍       | 13/54 [00:04<00:13,  2.97it/s] 26%|██▌       | 14/54 [00:04<00:13,  2.96it/s] 28%|██▊       | 15/54 [00:05<00:13,  2.95it/s] 30%|██▉       | 16/54 [00:05<00:12,  2.95it/s] 31%|███▏      | 17/54 [00:05<00:12,  2.95it/s] 33%|███▎      | 18/54 [00:06<00:12,  2.95it/s] 35%|███▌      | 19/54 [00:06<00:11,  2.95it/s] 37%|███▋      | 20/54 [00:06<00:11,  2.94it/s] 39%|███▉      | 21/54 [00:07<00:11,  2.94it/s] 41%|████      | 22/54 [00:07<00:10,  2.95it/s] 43%|████▎     | 23/54 [00:07<00:10,  2.94it/s] 44%|████▍     | 24/54 [00:08<00:10,  2.94it/s] 46%|████▋     | 25/54 [00:08<00:09,  2.95it/s] 48%|████▊     | 26/54 [00:08<00:09,  2.96it/s] 50%|█████     | 27/54 [00:09<00:09,  2.94it/s] 52%|█████▏    | 28/54 [00:09<00:08,  2.94it/s] 54%|█████▎    | 29/54 [00:09<00:08,  2.95it/s] 56%|█████▌    | 30/54 [00:10<00:08,  2.95it/s] 57%|█████▋    | 31/54 [00:10<00:07,  2.96it/s] 59%|█████▉    | 32/54 [00:10<00:07,  2.96it/s] 61%|██████    | 33/54 [00:11<00:07,  2.97it/s] 63%|██████▎   | 34/54 [00:11<00:06,  2.95it/s] 65%|██████▍   | 35/54 [00:11<00:06,  2.95it/s] 67%|██████▋   | 36/54 [00:12<00:06,  2.95it/s] 69%|██████▊   | 37/54 [00:12<00:05,  2.94it/s] 70%|███████   | 38/54 [00:12<00:05,  2.95it/s] 72%|███████▏  | 39/54 [00:13<00:05,  2.95it/s] 74%|███████▍  | 40/54 [00:13<00:04,  2.94it/s] 76%|███████▌  | 41/54 [00:13<00:04,  2.94it/s] 78%|███████▊  | 42/54 [00:14<00:04,  2.94it/s] 80%|███████▉  | 43/54 [00:14<00:03,  2.93it/s] 81%|████████▏ | 44/54 [00:14<00:03,  2.93it/s] 83%|████████▎ | 45/54 [00:15<00:03,  2.91it/s] 85%|████████▌ | 46/54 [00:15<00:02,  2.92it/s] 87%|████████▋ | 47/54 [00:15<00:02,  2.92it/s] 89%|████████▉ | 48/54 [00:16<00:02,  2.93it/s] 91%|█████████ | 49/54 [00:16<00:01,  2.91it/s] 93%|█████████▎| 50/54 [00:17<00:01,  2.91it/s] 94%|█████████▍| 51/54 [00:17<00:01,  2.92it/s] 96%|█████████▋| 52/54 [00:17<00:00,  2.92it/s] 98%|█████████▊| 53/54 [00:18<00:00,  2.93it/s]100%|██████████| 54/54 [00:18<00:00,  2.94it/s]100%|██████████| 54/54 [00:18<00:00,  2.94it/s]
Inference completed in 18.44s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.84GB
输入形状: (14, 280, 236, 236)
目标形状: (140, 512, 512)
预估内存需求: 1.91GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.169491525423729, 2.169491525423729]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.18s
重采样后内存: 3.75GB (增加: 1.91GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 140, 512, 512), 内存占用: 1.91GB
分块策略: 块大小=8, 预计块数=18
创建了 18 个处理块，每块约 8 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.87GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.80s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.43s
Case FLARETs_0072_0000.nii.gz completed in 25.43s total (preprocess: 3.56s, inference: 18.44s, postprocess: 3.43s)
Step 4/4: Ready for next case...

=== Processing case 73/200: FLARETs_0073_0000.nii.gz ===
File FLARETs_0073_0000.nii.gz: 52.52 MB
Total file size: 52.52 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.14s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.00it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.04it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.03it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.02it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.00it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.00it/s] 44%|████▍     | 7/16 [00:02<00:03,  3.00it/s] 50%|█████     | 8/16 [00:02<00:02,  2.99it/s] 56%|█████▋    | 9/16 [00:02<00:02,  2.99it/s] 62%|██████▎   | 10/16 [00:03<00:02,  3.00it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.01it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.97it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.92it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.89it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.87it/s]100%|██████████| 16/16 [00:05<00:00,  2.87it/s]100%|██████████| 16/16 [00:05<00:00,  2.95it/s]
Inference completed in 5.44s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.46GB
输入形状: (14, 167, 152, 152)
目标形状: (167, 512, 512)
预估内存需求: 2.28GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 3.3684210526315788, 3.3684210526315788]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.62s
重采样后内存: 3.74GB (增加: 2.28GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 167, 512, 512), 内存占用: 2.28GB
分块策略: 块大小=6, 预计块数=28
创建了 28 个处理块，每块约 6 切片
后处理进度: 7/28 块 (25.0%)
后处理进度: 14/28 块 (50.0%)
后处理进度: 21/28 块 (75.0%)
后处理进度: 28/28 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.61s
处理完成后内存: 1.50GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.28s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.66s
Case FLARETs_0073_0000.nii.gz completed in 11.24s total (preprocess: 2.14s, inference: 5.44s, postprocess: 3.66s)
Step 4/4: Ready for next case...

=== Processing case 74/200: FLARETs_0074_0000.nii.gz ===
File FLARETs_0074_0000.nii.gz: 32.67 MB
Total file size: 32.67 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.41s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  3.03it/s] 11%|█         | 2/18 [00:00<00:05,  2.98it/s] 17%|█▋        | 3/18 [00:01<00:05,  2.96it/s] 22%|██▏       | 4/18 [00:01<00:04,  2.96it/s] 28%|██▊       | 5/18 [00:01<00:04,  2.95it/s] 33%|███▎      | 6/18 [00:02<00:04,  2.94it/s] 39%|███▉      | 7/18 [00:02<00:03,  2.96it/s] 44%|████▍     | 8/18 [00:02<00:03,  2.95it/s] 50%|█████     | 9/18 [00:03<00:03,  2.95it/s] 56%|█████▌    | 10/18 [00:03<00:02,  2.95it/s] 61%|██████    | 11/18 [00:03<00:02,  2.96it/s] 67%|██████▋   | 12/18 [00:04<00:02,  2.96it/s] 72%|███████▏  | 13/18 [00:04<00:01,  2.96it/s] 78%|███████▊  | 14/18 [00:04<00:01,  2.96it/s] 83%|████████▎ | 15/18 [00:05<00:01,  2.96it/s] 89%|████████▉ | 16/18 [00:05<00:00,  2.97it/s] 94%|█████████▍| 17/18 [00:05<00:00,  2.98it/s]100%|██████████| 18/18 [00:06<00:00,  2.98it/s]100%|██████████| 18/18 [00:06<00:00,  2.96it/s]
Inference completed in 6.10s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.48GB
输入形状: (14, 102, 202, 202)
目标形状: (102, 512, 512)
预估内存需求: 1.39GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.5346534653465347, 2.5346534653465347]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.60s
重采样后内存: 2.88GB (增加: 1.39GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 102, 512, 512), 内存占用: 1.39GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.43s
处理完成后内存: 1.48GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.07s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.45s
Case FLARETs_0074_0000.nii.gz completed in 9.96s total (preprocess: 1.41s, inference: 6.10s, postprocess: 2.45s)
Step 4/4: Ready for next case...

=== Processing case 75/200: FLARETs_0075_0000.nii.gz ===
File FLARETs_0075_0000.nii.gz: 36.28 MB
Total file size: 36.28 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.42s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:08,  3.00it/s]  7%|▋         | 2/27 [00:00<00:08,  3.00it/s] 11%|█         | 3/27 [00:00<00:07,  3.06it/s] 15%|█▍        | 4/27 [00:01<00:07,  3.04it/s] 19%|█▊        | 5/27 [00:01<00:07,  3.04it/s] 22%|██▏       | 6/27 [00:01<00:06,  3.07it/s] 26%|██▌       | 7/27 [00:02<00:06,  3.04it/s] 30%|██▉       | 8/27 [00:02<00:06,  3.02it/s] 33%|███▎      | 9/27 [00:02<00:05,  3.05it/s] 37%|███▋      | 10/27 [00:03<00:05,  3.03it/s] 41%|████      | 11/27 [00:03<00:05,  3.03it/s] 44%|████▍     | 12/27 [00:03<00:04,  3.01it/s] 48%|████▊     | 13/27 [00:04<00:04,  3.00it/s] 52%|█████▏    | 14/27 [00:04<00:04,  3.00it/s] 56%|█████▌    | 15/27 [00:04<00:04,  2.99it/s] 59%|█████▉    | 16/27 [00:05<00:03,  2.98it/s] 63%|██████▎   | 17/27 [00:05<00:03,  2.98it/s] 67%|██████▋   | 18/27 [00:05<00:03,  2.97it/s] 70%|███████   | 19/27 [00:06<00:02,  2.98it/s] 74%|███████▍  | 20/27 [00:06<00:02,  2.98it/s] 78%|███████▊  | 21/27 [00:06<00:02,  2.97it/s] 81%|████████▏ | 22/27 [00:07<00:01,  2.98it/s] 85%|████████▌ | 23/27 [00:07<00:01,  2.98it/s] 89%|████████▉ | 24/27 [00:07<00:01,  2.97it/s] 93%|█████████▎| 25/27 [00:08<00:00,  2.99it/s] 96%|█████████▋| 26/27 [00:08<00:00,  3.00it/s]100%|██████████| 27/27 [00:08<00:00,  2.99it/s]100%|██████████| 27/27 [00:08<00:00,  3.00it/s]
Inference completed in 9.02s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.53GB
输入形状: (14, 122, 220, 220)
目标形状: (122, 512, 512)
预估内存需求: 1.67GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.327272727272727, 2.327272727272727]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.90s
重采样后内存: 3.20GB (增加: 1.67GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 122, 512, 512), 内存占用: 1.67GB
分块策略: 块大小=7, 预计块数=18
创建了 18 个处理块，每块约 7 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.50s
处理完成后内存: 1.54GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.44s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.86s
Case FLARETs_0075_0000.nii.gz completed in 15.31s total (preprocess: 3.42s, inference: 9.02s, postprocess: 2.86s)
Step 4/4: Ready for next case...

=== Processing case 76/200: FLARETs_0076_0000.nii.gz ===
File FLARETs_0076_0000.nii.gz: 34.10 MB
Total file size: 34.10 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.49s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  2.98it/s] 11%|█         | 2/18 [00:00<00:05,  3.00it/s] 17%|█▋        | 3/18 [00:00<00:04,  3.02it/s] 22%|██▏       | 4/18 [00:01<00:04,  3.02it/s] 28%|██▊       | 5/18 [00:01<00:04,  3.02it/s] 33%|███▎      | 6/18 [00:01<00:03,  3.02it/s] 39%|███▉      | 7/18 [00:02<00:03,  3.01it/s] 44%|████▍     | 8/18 [00:02<00:03,  3.01it/s] 50%|█████     | 9/18 [00:02<00:02,  3.02it/s] 56%|█████▌    | 10/18 [00:03<00:02,  3.02it/s] 61%|██████    | 11/18 [00:03<00:02,  3.01it/s] 67%|██████▋   | 12/18 [00:03<00:01,  3.01it/s] 72%|███████▏  | 13/18 [00:04<00:01,  3.00it/s] 78%|███████▊  | 14/18 [00:04<00:01,  3.00it/s] 83%|████████▎ | 15/18 [00:04<00:00,  3.01it/s] 89%|████████▉ | 16/18 [00:05<00:00,  2.99it/s] 94%|█████████▍| 17/18 [00:05<00:00,  3.00it/s]100%|██████████| 18/18 [00:05<00:00,  3.01it/s]100%|██████████| 18/18 [00:05<00:00,  3.01it/s]
Inference completed in 6.01s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.47GB
输入形状: (14, 107, 204, 204)
目标形状: (107, 512, 512)
预估内存需求: 1.46GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.5098039215686274, 2.5098039215686274]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.67s
重采样后内存: 2.94GB (增加: 1.46GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 107, 512, 512), 内存占用: 1.46GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.50GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.15s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.55s
Case FLARETs_0076_0000.nii.gz completed in 10.04s total (preprocess: 1.49s, inference: 6.01s, postprocess: 2.55s)
Step 4/4: Ready for next case...

=== Processing case 77/200: FLARETs_0077_0000.nii.gz ===
File FLARETs_0077_0000.nii.gz: 36.68 MB
Total file size: 36.68 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.57s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  2.97it/s] 11%|█         | 2/18 [00:00<00:05,  2.94it/s] 17%|█▋        | 3/18 [00:01<00:05,  2.95it/s] 22%|██▏       | 4/18 [00:01<00:04,  2.95it/s] 28%|██▊       | 5/18 [00:01<00:04,  2.95it/s] 33%|███▎      | 6/18 [00:02<00:04,  2.96it/s] 39%|███▉      | 7/18 [00:02<00:03,  2.95it/s] 44%|████▍     | 8/18 [00:02<00:03,  2.95it/s] 50%|█████     | 9/18 [00:03<00:03,  2.95it/s] 56%|█████▌    | 10/18 [00:03<00:02,  2.95it/s] 61%|██████    | 11/18 [00:03<00:02,  2.94it/s] 67%|██████▋   | 12/18 [00:04<00:02,  2.95it/s] 72%|███████▏  | 13/18 [00:04<00:01,  2.93it/s] 78%|███████▊  | 14/18 [00:04<00:01,  2.92it/s] 83%|████████▎ | 15/18 [00:05<00:01,  2.92it/s] 89%|████████▉ | 16/18 [00:05<00:00,  2.92it/s] 94%|█████████▍| 17/18 [00:05<00:00,  2.92it/s]100%|██████████| 18/18 [00:06<00:00,  2.91it/s]100%|██████████| 18/18 [00:06<00:00,  2.94it/s]
Inference completed in 6.16s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.48GB
输入形状: (14, 112, 208, 208)
目标形状: (112, 512, 512)
预估内存需求: 1.53GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.4615384615384617, 2.4615384615384617]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.70s
重采样后内存: 3.02GB (增加: 1.53GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 112, 512, 512), 内存占用: 1.53GB
分块策略: 块大小=7, 预计块数=16
创建了 16 个处理块，每块约 7 切片
后处理进度: 4/16 块 (25.0%)
后处理进度: 8/16 块 (50.0%)
后处理进度: 12/16 块 (75.0%)
后处理进度: 16/16 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.38s
处理完成后内存: 1.51GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.12s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.52s
Case FLARETs_0077_0000.nii.gz completed in 10.25s total (preprocess: 1.57s, inference: 6.16s, postprocess: 2.52s)
Step 4/4: Ready for next case...

=== Processing case 78/200: FLARETs_0078_0000.nii.gz ===
File FLARETs_0078_0000.nii.gz: 34.58 MB
Total file size: 34.58 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.49s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  3.03it/s] 11%|█         | 2/18 [00:00<00:05,  3.01it/s] 17%|█▋        | 3/18 [00:00<00:04,  3.02it/s] 22%|██▏       | 4/18 [00:01<00:04,  3.02it/s] 28%|██▊       | 5/18 [00:01<00:04,  3.03it/s] 33%|███▎      | 6/18 [00:01<00:03,  3.03it/s] 39%|███▉      | 7/18 [00:02<00:03,  3.03it/s] 44%|████▍     | 8/18 [00:02<00:03,  3.02it/s] 50%|█████     | 9/18 [00:02<00:02,  3.03it/s] 56%|█████▌    | 10/18 [00:03<00:02,  3.02it/s] 61%|██████    | 11/18 [00:03<00:02,  3.00it/s] 67%|██████▋   | 12/18 [00:03<00:02,  2.99it/s] 72%|███████▏  | 13/18 [00:04<00:01,  3.00it/s] 78%|███████▊  | 14/18 [00:04<00:01,  3.01it/s] 83%|████████▎ | 15/18 [00:04<00:00,  3.02it/s] 89%|████████▉ | 16/18 [00:05<00:00,  3.01it/s] 94%|█████████▍| 17/18 [00:05<00:00,  3.01it/s]100%|██████████| 18/18 [00:05<00:00,  3.02it/s]100%|██████████| 18/18 [00:05<00:00,  3.02it/s]
Inference completed in 6.00s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.48GB
输入形状: (14, 107, 208, 208)
目标形状: (107, 512, 512)
预估内存需求: 1.46GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.4615384615384617, 2.4615384615384617]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.66s
重采样后内存: 2.94GB (增加: 1.46GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 107, 512, 512), 内存占用: 1.46GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.50GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.14s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.53s
Case FLARETs_0078_0000.nii.gz completed in 10.02s total (preprocess: 1.49s, inference: 6.00s, postprocess: 2.53s)
Step 4/4: Ready for next case...

=== Processing case 79/200: FLARETs_0079_0000.nii.gz ===
File FLARETs_0079_0000.nii.gz: 31.55 MB
Total file size: 31.55 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.43s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  2.88it/s] 11%|█         | 2/18 [00:00<00:05,  2.87it/s] 17%|█▋        | 3/18 [00:01<00:05,  2.89it/s] 22%|██▏       | 4/18 [00:01<00:04,  2.90it/s] 28%|██▊       | 5/18 [00:01<00:04,  2.85it/s] 33%|███▎      | 6/18 [00:02<00:04,  2.83it/s] 39%|███▉      | 7/18 [00:02<00:03,  2.81it/s] 44%|████▍     | 8/18 [00:02<00:03,  2.85it/s] 50%|█████     | 9/18 [00:03<00:03,  2.89it/s] 56%|█████▌    | 10/18 [00:03<00:02,  2.92it/s] 61%|██████    | 11/18 [00:03<00:02,  2.95it/s] 67%|██████▋   | 12/18 [00:04<00:02,  2.96it/s] 72%|███████▏  | 13/18 [00:04<00:01,  2.96it/s] 78%|███████▊  | 14/18 [00:04<00:01,  2.98it/s] 83%|████████▎ | 15/18 [00:05<00:01,  2.97it/s] 89%|████████▉ | 16/18 [00:05<00:00,  2.99it/s] 94%|█████████▍| 17/18 [00:05<00:00,  3.00it/s]100%|██████████| 18/18 [00:06<00:00,  3.01it/s]100%|██████████| 18/18 [00:06<00:00,  2.93it/s]
Inference completed in 6.17s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.47GB
输入形状: (14, 103, 200, 200)
目标形状: (103, 512, 512)
预估内存需求: 1.41GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.56, 2.56]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.59s
重采样后内存: 2.87GB (增加: 1.41GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 103, 512, 512), 内存占用: 1.41GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.43s
处理完成后内存: 1.49GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.06s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.45s
Case FLARETs_0079_0000.nii.gz completed in 10.05s total (preprocess: 1.43s, inference: 6.17s, postprocess: 2.45s)
Step 4/4: Ready for next case...

=== Processing case 80/200: FLARETs_0080_0000.nii.gz ===
File FLARETs_0080_0000.nii.gz: 36.00 MB
Total file size: 36.00 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.25s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  2.94it/s] 11%|█         | 2/18 [00:00<00:05,  2.91it/s] 17%|█▋        | 3/18 [00:01<00:05,  2.92it/s] 22%|██▏       | 4/18 [00:01<00:04,  2.93it/s] 28%|██▊       | 5/18 [00:01<00:04,  2.92it/s] 33%|███▎      | 6/18 [00:02<00:04,  2.92it/s] 39%|███▉      | 7/18 [00:02<00:03,  2.92it/s] 44%|████▍     | 8/18 [00:02<00:03,  2.93it/s] 50%|█████     | 9/18 [00:03<00:03,  2.94it/s] 56%|█████▌    | 10/18 [00:03<00:02,  2.94it/s] 61%|██████    | 11/18 [00:03<00:02,  2.94it/s] 67%|██████▋   | 12/18 [00:04<00:02,  2.94it/s] 72%|███████▏  | 13/18 [00:04<00:01,  2.94it/s] 78%|███████▊  | 14/18 [00:04<00:01,  2.94it/s] 83%|████████▎ | 15/18 [00:05<00:01,  2.95it/s] 89%|████████▉ | 16/18 [00:05<00:00,  2.95it/s] 94%|█████████▍| 17/18 [00:05<00:00,  2.94it/s]100%|██████████| 18/18 [00:06<00:00,  2.95it/s]100%|██████████| 18/18 [00:06<00:00,  2.94it/s]
Inference completed in 6.16s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.51GB
输入形状: (14, 114, 223, 223)
目标形状: (114, 512, 512)
预估内存需求: 1.56GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.295964125560538, 2.295964125560538]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.76s
重采样后内存: 3.06GB (增加: 1.56GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 114, 512, 512), 内存占用: 1.56GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.40s
处理完成后内存: 1.59GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.20s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.61s
Case FLARETs_0080_0000.nii.gz completed in 12.02s total (preprocess: 3.25s, inference: 6.16s, postprocess: 2.61s)
Step 4/4: Ready for next case...

=== Processing case 81/200: FLARETs_0081_0000.nii.gz ===
File FLARETs_0081_0000.nii.gz: 72.40 MB
Total file size: 72.40 MB
⚠️  File size (72.40 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0081.nii.gz with shape (512, 512, 230)
✅ Dummy results generated: FLARETs_0081.nii.gz
Case FLARETs_0081_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 82/200: FLARETs_0082_0000.nii.gz ===
File FLARETs_0082_0000.nii.gz: 51.61 MB
Total file size: 51.61 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.54s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:05,  2.92it/s] 11%|█         | 2/18 [00:00<00:05,  2.96it/s] 17%|█▋        | 3/18 [00:01<00:05,  2.95it/s] 22%|██▏       | 4/18 [00:01<00:04,  2.95it/s] 28%|██▊       | 5/18 [00:01<00:04,  2.96it/s] 33%|███▎      | 6/18 [00:02<00:04,  2.96it/s] 39%|███▉      | 7/18 [00:02<00:03,  2.97it/s] 44%|████▍     | 8/18 [00:02<00:03,  2.97it/s] 50%|█████     | 9/18 [00:03<00:03,  2.96it/s] 56%|█████▌    | 10/18 [00:03<00:02,  2.94it/s] 61%|██████    | 11/18 [00:03<00:02,  2.95it/s] 67%|██████▋   | 12/18 [00:04<00:02,  2.94it/s] 72%|███████▏  | 13/18 [00:04<00:01,  2.94it/s] 78%|███████▊  | 14/18 [00:04<00:01,  2.95it/s] 83%|████████▎ | 15/18 [00:05<00:01,  2.94it/s] 89%|████████▉ | 16/18 [00:05<00:00,  2.94it/s] 94%|█████████▍| 17/18 [00:05<00:00,  2.95it/s]100%|██████████| 18/18 [00:06<00:00,  2.97it/s]100%|██████████| 18/18 [00:06<00:00,  2.95it/s]
Inference completed in 6.12s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.45GB
输入形状: (14, 94, 195, 195)
目标形状: (157, 512, 512)
预估内存需求: 2.15GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.6702127659574468, 2.6256410256410256, 2.6256410256410256]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.44s
重采样后内存: 3.60GB (增加: 2.15GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 157, 512, 512), 内存占用: 2.15GB
分块策略: 块大小=6, 预计块数=27
创建了 27 个处理块，每块约 6 切片
后处理进度: 6/27 块 (22.2%)
后处理进度: 12/27 块 (44.4%)
后处理进度: 18/27 块 (66.7%)
后处理进度: 24/27 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.60s
处理完成后内存: 1.43GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.06s
🎯 深度优化总耗时: 3.09s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.47s
Case FLARETs_0082_0000.nii.gz completed in 13.12s total (preprocess: 3.54s, inference: 6.12s, postprocess: 3.47s)
Step 4/4: Ready for next case...

=== Processing case 83/200: FLARETs_0083_0000.nii.gz ===
File FLARETs_0083_0000.nii.gz: 32.46 MB
Total file size: 32.46 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.24s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  2.99it/s]  4%|▍         | 2/45 [00:00<00:14,  3.00it/s]  7%|▋         | 3/45 [00:01<00:14,  3.00it/s]  9%|▉         | 4/45 [00:01<00:13,  2.98it/s] 11%|█         | 5/45 [00:01<00:13,  2.97it/s] 13%|█▎        | 6/45 [00:02<00:13,  2.96it/s] 16%|█▌        | 7/45 [00:02<00:12,  2.95it/s] 18%|█▊        | 8/45 [00:02<00:12,  2.94it/s] 20%|██        | 9/45 [00:03<00:12,  2.94it/s] 22%|██▏       | 10/45 [00:03<00:11,  2.94it/s] 24%|██▍       | 11/45 [00:03<00:11,  2.94it/s] 27%|██▋       | 12/45 [00:04<00:11,  2.94it/s] 29%|██▉       | 13/45 [00:04<00:10,  2.93it/s] 31%|███       | 14/45 [00:04<00:10,  2.93it/s] 33%|███▎      | 15/45 [00:05<00:10,  2.94it/s] 36%|███▌      | 16/45 [00:05<00:09,  2.95it/s] 38%|███▊      | 17/45 [00:05<00:09,  2.94it/s] 40%|████      | 18/45 [00:06<00:09,  2.94it/s] 42%|████▏     | 19/45 [00:06<00:08,  2.95it/s] 44%|████▍     | 20/45 [00:06<00:08,  2.95it/s] 47%|████▋     | 21/45 [00:07<00:08,  2.94it/s] 49%|████▉     | 22/45 [00:07<00:07,  2.95it/s] 51%|█████     | 23/45 [00:07<00:07,  2.94it/s] 53%|█████▎    | 24/45 [00:08<00:07,  2.94it/s] 56%|█████▌    | 25/45 [00:08<00:06,  2.94it/s] 58%|█████▊    | 26/45 [00:08<00:06,  2.94it/s] 60%|██████    | 27/45 [00:09<00:06,  2.95it/s] 62%|██████▏   | 28/45 [00:09<00:05,  2.96it/s] 64%|██████▍   | 29/45 [00:09<00:05,  2.95it/s] 67%|██████▋   | 30/45 [00:10<00:05,  2.94it/s] 69%|██████▉   | 31/45 [00:10<00:04,  2.95it/s] 71%|███████   | 32/45 [00:10<00:04,  2.95it/s] 73%|███████▎  | 33/45 [00:11<00:04,  2.95it/s] 76%|███████▌  | 34/45 [00:11<00:03,  2.97it/s] 78%|███████▊  | 35/45 [00:11<00:03,  2.96it/s] 80%|████████  | 36/45 [00:12<00:03,  2.96it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.96it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.96it/s] 87%|████████▋ | 39/45 [00:13<00:02,  2.96it/s] 89%|████████▉ | 40/45 [00:13<00:01,  2.96it/s] 91%|█████████ | 41/45 [00:13<00:01,  2.96it/s] 93%|█████████▎| 42/45 [00:14<00:01,  2.95it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.95it/s] 98%|█████████▊| 44/45 [00:14<00:00,  2.96it/s]100%|██████████| 45/45 [00:15<00:00,  2.97it/s]100%|██████████| 45/45 [00:15<00:00,  2.95it/s]
Inference completed in 15.28s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.55GB
输入形状: (14, 210, 200, 200)
目标形状: (105, 512, 512)
预估内存需求: 1.44GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.56, 2.56]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.61s
重采样后内存: 2.98GB (增加: 1.44GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 105, 512, 512), 内存占用: 1.44GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.59GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.08s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.55s
Case FLARETs_0083_0000.nii.gz completed in 20.08s total (preprocess: 2.24s, inference: 15.28s, postprocess: 2.55s)
Step 4/4: Ready for next case...

=== Processing case 84/200: FLARETs_0084_0000.nii.gz ===
File FLARETs_0084_0000.nii.gz: 31.66 MB
Total file size: 31.66 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.39s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.06it/s]  4%|▍         | 2/45 [00:00<00:14,  3.01it/s]  7%|▋         | 3/45 [00:00<00:13,  3.05it/s]  9%|▉         | 4/45 [00:01<00:13,  3.07it/s] 11%|█         | 5/45 [00:01<00:13,  3.05it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.06it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.07it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.05it/s] 20%|██        | 9/45 [00:02<00:11,  3.08it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.08it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.05it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.03it/s] 29%|██▉       | 13/45 [00:04<00:10,  2.99it/s] 31%|███       | 14/45 [00:04<00:10,  2.94it/s] 33%|███▎      | 15/45 [00:04<00:10,  2.92it/s] 36%|███▌      | 16/45 [00:05<00:09,  2.92it/s] 38%|███▊      | 17/45 [00:05<00:09,  2.94it/s] 40%|████      | 18/45 [00:05<00:09,  2.95it/s] 42%|████▏     | 19/45 [00:06<00:08,  2.98it/s] 44%|████▍     | 20/45 [00:06<00:08,  2.97it/s] 47%|████▋     | 21/45 [00:07<00:08,  2.93it/s] 49%|████▉     | 22/45 [00:07<00:07,  2.93it/s] 51%|█████     | 23/45 [00:07<00:07,  2.91it/s] 53%|█████▎    | 24/45 [00:08<00:07,  2.90it/s] 56%|█████▌    | 25/45 [00:08<00:06,  2.90it/s] 58%|█████▊    | 26/45 [00:08<00:06,  2.90it/s] 60%|██████    | 27/45 [00:09<00:06,  2.90it/s] 62%|██████▏   | 28/45 [00:09<00:05,  2.95it/s] 64%|██████▍   | 29/45 [00:09<00:05,  2.99it/s] 67%|██████▋   | 30/45 [00:10<00:04,  3.01it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.03it/s] 71%|███████   | 32/45 [00:10<00:04,  3.04it/s] 73%|███████▎  | 33/45 [00:11<00:03,  3.06it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.07it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.09it/s] 80%|████████  | 36/45 [00:11<00:02,  3.11it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.09it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.06it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.06it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.07it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.05it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.07it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.07it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.05it/s]100%|██████████| 45/45 [00:14<00:00,  3.07it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]
Inference completed in 14.99s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.60GB
输入形状: (14, 202, 220, 220)
目标形状: (101, 512, 512)
预估内存需求: 1.38GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.327272727272727, 2.327272727272727]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.55s
重采样后内存: 2.98GB (增加: 1.38GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 101, 512, 512), 内存占用: 1.38GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.42s
处理完成后内存: 1.60GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.00s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.50s
Case FLARETs_0084_0000.nii.gz completed in 19.88s total (preprocess: 2.39s, inference: 14.99s, postprocess: 2.50s)
Step 4/4: Ready for next case...

=== Processing case 85/200: FLARETs_0085_0000.nii.gz ===
File FLARETs_0085_0000.nii.gz: 30.10 MB
Total file size: 30.10 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.04s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.02it/s]  6%|▌         | 2/36 [00:00<00:11,  3.01it/s]  8%|▊         | 3/36 [00:00<00:10,  3.02it/s] 11%|█         | 4/36 [00:01<00:10,  3.02it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.00it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.01it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.00it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.00it/s] 25%|██▌       | 9/36 [00:02<00:09,  2.99it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.00it/s] 31%|███       | 11/36 [00:03<00:08,  2.99it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.00it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.00it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.00it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.01it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.01it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.01it/s] 50%|█████     | 18/36 [00:05<00:05,  3.01it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.00it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.00it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.01it/s] 61%|██████    | 22/36 [00:07<00:04,  3.01it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.02it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.02it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.02it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.02it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.01it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.02it/s] 81%|████████  | 29/36 [00:09<00:02,  3.02it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.01it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.00it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.00it/s] 92%|█████████▏| 33/36 [00:10<00:01,  2.99it/s] 94%|█████████▍| 34/36 [00:11<00:00,  2.99it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.00it/s]100%|██████████| 36/36 [00:11<00:00,  3.01it/s]100%|██████████| 36/36 [00:11<00:00,  3.01it/s]
Inference completed in 12.02s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.58GB
输入形状: (14, 200, 200, 200)
目标形状: (100, 512, 512)
预估内存需求: 1.37GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.56, 2.56]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.54s
重采样后内存: 2.95GB (增加: 1.37GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 100, 512, 512), 内存占用: 1.37GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.39s
处理完成后内存: 1.58GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.95s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.42s
Case FLARETs_0085_0000.nii.gz completed in 16.48s total (preprocess: 2.04s, inference: 12.02s, postprocess: 2.42s)
Step 4/4: Ready for next case...

=== Processing case 86/200: FLARETs_0086_0000.nii.gz ===
File FLARETs_0086_0000.nii.gz: 25.03 MB
Total file size: 25.03 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.66s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  2.94it/s]  4%|▍         | 2/45 [00:00<00:14,  2.96it/s]  7%|▋         | 3/45 [00:01<00:14,  2.99it/s]  9%|▉         | 4/45 [00:01<00:13,  3.00it/s] 11%|█         | 5/45 [00:01<00:13,  3.01it/s] 13%|█▎        | 6/45 [00:02<00:12,  3.01it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.01it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.02it/s] 20%|██        | 9/45 [00:02<00:11,  3.03it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.03it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.01it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.00it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.01it/s] 31%|███       | 14/45 [00:04<00:10,  3.02it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.01it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.01it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.01it/s] 40%|████      | 18/45 [00:05<00:08,  3.01it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.02it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.01it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.02it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.02it/s] 51%|█████     | 23/45 [00:07<00:07,  3.00it/s] 53%|█████▎    | 24/45 [00:07<00:07,  2.99it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.00it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.00it/s] 60%|██████    | 27/45 [00:08<00:05,  3.00it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.00it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.01it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.00it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.00it/s] 71%|███████   | 32/45 [00:10<00:04,  3.01it/s] 73%|███████▎  | 33/45 [00:10<00:04,  3.00it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.00it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.01it/s] 80%|████████  | 36/45 [00:11<00:03,  3.00it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.01it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.01it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.00it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.02it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.02it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.02it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.03it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.00it/s]100%|██████████| 45/45 [00:14<00:00,  3.00it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]
Inference completed in 15.03s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.72GB
输入形状: (14, 212, 244, 244)
目标形状: (106, 512, 512)
预估内存需求: 1.45GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.098360655737705, 2.098360655737705]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.63s
重采样后内存: 3.17GB (增加: 1.45GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 106, 512, 512), 内存占用: 1.45GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.43s
处理完成后内存: 1.74GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.09s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.66s
Case FLARETs_0086_0000.nii.gz completed in 20.35s total (preprocess: 2.66s, inference: 15.03s, postprocess: 2.66s)
Step 4/4: Ready for next case...

=== Processing case 87/200: FLARETs_0087_0000.nii.gz ===
File FLARETs_0087_0000.nii.gz: 29.62 MB
Total file size: 29.62 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.83s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:06,  2.99it/s] 10%|█         | 2/20 [00:00<00:06,  2.98it/s] 15%|█▌        | 3/20 [00:01<00:05,  2.99it/s] 20%|██        | 4/20 [00:01<00:05,  2.99it/s] 25%|██▌       | 5/20 [00:01<00:05,  2.98it/s] 30%|███       | 6/20 [00:02<00:04,  3.00it/s] 35%|███▌      | 7/20 [00:02<00:04,  3.01it/s] 40%|████      | 8/20 [00:02<00:03,  3.01it/s] 45%|████▌     | 9/20 [00:02<00:03,  3.01it/s] 50%|█████     | 10/20 [00:03<00:03,  3.00it/s] 55%|█████▌    | 11/20 [00:03<00:03,  2.98it/s] 60%|██████    | 12/20 [00:04<00:02,  3.00it/s] 65%|██████▌   | 13/20 [00:04<00:02,  2.98it/s] 70%|███████   | 14/20 [00:04<00:02,  2.98it/s] 75%|███████▌  | 15/20 [00:05<00:01,  2.97it/s] 80%|████████  | 16/20 [00:05<00:01,  2.97it/s] 85%|████████▌ | 17/20 [00:05<00:01,  2.96it/s] 90%|█████████ | 18/20 [00:06<00:00,  2.98it/s] 95%|█████████▌| 19/20 [00:06<00:00,  2.98it/s]100%|██████████| 20/20 [00:06<00:00,  2.99it/s]100%|██████████| 20/20 [00:06<00:00,  2.99it/s]
Inference completed in 6.73s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.54GB
输入形状: (14, 202, 174, 174)
目标形状: (101, 512, 512)
预估内存需求: 1.38GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.942528735632184, 2.942528735632184]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.55s
重采样后内存: 2.92GB (增加: 1.38GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 101, 512, 512), 内存占用: 1.38GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.41s
处理完成后内存: 1.54GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.99s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.42s
Case FLARETs_0087_0000.nii.gz completed in 10.98s total (preprocess: 1.83s, inference: 6.73s, postprocess: 2.42s)
Step 4/4: Ready for next case...

=== Processing case 88/200: FLARETs_0088_0000.nii.gz ===
File FLARETs_0088_0000.nii.gz: 36.45 MB
Total file size: 36.45 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.65s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:00<00:00,  2.76it/s]100%|██████████| 2/2 [00:00<00:00,  2.77it/s]100%|██████████| 2/2 [00:00<00:00,  2.77it/s]
Inference completed in 0.74s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.46GB
输入形状: (14, 102, 128, 128)
目标形状: (128, 512, 512)
预估内存需求: 1.75GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.2549019607843137, 4.0, 4.0]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.02s
重采样后内存: 3.21GB (增加: 1.75GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 128, 512, 512), 内存占用: 1.75GB
分块策略: 块大小=8, 预计块数=16
创建了 16 个处理块，每块约 8 切片
后处理进度: 4/16 块 (25.0%)
后处理进度: 8/16 块 (50.0%)
后处理进度: 12/16 块 (75.0%)
后处理进度: 16/16 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.46GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.06s
🎯 深度优化总耗时: 2.51s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.85s
Case FLARETs_0088_0000.nii.gz completed in 5.24s total (preprocess: 1.65s, inference: 0.74s, postprocess: 2.85s)
Step 4/4: Ready for next case...

=== Processing case 89/200: FLARETs_0089_0000.nii.gz ===
File FLARETs_0089_0000.nii.gz: 27.74 MB
Total file size: 27.74 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.33s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.97it/s]  6%|▌         | 2/36 [00:00<00:11,  3.00it/s]  8%|▊         | 3/36 [00:01<00:11,  2.99it/s] 11%|█         | 4/36 [00:01<00:10,  2.98it/s] 14%|█▍        | 5/36 [00:01<00:10,  2.97it/s] 17%|█▋        | 6/36 [00:02<00:10,  2.99it/s] 19%|█▉        | 7/36 [00:02<00:09,  2.97it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.00it/s] 25%|██▌       | 9/36 [00:03<00:08,  3.00it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.01it/s] 31%|███       | 11/36 [00:03<00:08,  3.01it/s] 33%|███▎      | 12/36 [00:04<00:07,  3.00it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.00it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.00it/s] 42%|████▏     | 15/36 [00:05<00:07,  2.99it/s] 44%|████▍     | 16/36 [00:05<00:06,  2.98it/s] 47%|████▋     | 17/36 [00:05<00:06,  2.98it/s] 50%|█████     | 18/36 [00:06<00:06,  2.98it/s] 53%|█████▎    | 19/36 [00:06<00:05,  2.98it/s] 56%|█████▌    | 20/36 [00:06<00:05,  2.99it/s] 58%|█████▊    | 21/36 [00:07<00:05,  2.98it/s] 61%|██████    | 22/36 [00:07<00:04,  2.99it/s] 64%|██████▍   | 23/36 [00:07<00:04,  2.98it/s] 67%|██████▋   | 24/36 [00:08<00:04,  2.99it/s] 69%|██████▉   | 25/36 [00:08<00:03,  2.99it/s] 72%|███████▏  | 26/36 [00:08<00:03,  2.98it/s] 75%|███████▌  | 27/36 [00:09<00:03,  2.99it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.00it/s] 81%|████████  | 29/36 [00:09<00:02,  2.99it/s] 83%|████████▎ | 30/36 [00:10<00:02,  3.00it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.00it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.01it/s] 92%|█████████▏| 33/36 [00:11<00:00,  3.01it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.01it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.01it/s]100%|██████████| 36/36 [00:12<00:00,  3.02it/s]100%|██████████| 36/36 [00:12<00:00,  3.00it/s]
Inference completed in 12.07s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.69GB
输入形状: (14, 200, 226, 226)
目标形状: (100, 512, 512)
预估内存需求: 1.37GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.265486725663717, 2.265486725663717]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.54s
重采样后内存: 3.05GB (增加: 1.37GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 100, 512, 512), 内存占用: 1.37GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.38s
处理完成后内存: 1.69GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.95s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.46s
Case FLARETs_0089_0000.nii.gz completed in 16.86s total (preprocess: 2.33s, inference: 12.07s, postprocess: 2.46s)
Step 4/4: Ready for next case...

=== Processing case 90/200: FLARETs_0090_0000.nii.gz ===
File FLARETs_0090_0000.nii.gz: 38.79 MB
Total file size: 38.79 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.38s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.00it/s]  6%|▌         | 2/36 [00:00<00:11,  3.02it/s]  8%|▊         | 3/36 [00:00<00:10,  3.00it/s] 11%|█         | 4/36 [00:01<00:10,  3.00it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.01it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.00it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.00it/s] 22%|██▏       | 8/36 [00:02<00:09,  2.98it/s] 25%|██▌       | 9/36 [00:03<00:09,  2.99it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.00it/s] 31%|███       | 11/36 [00:03<00:08,  3.01it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.00it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.01it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.00it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.02it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.02it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.02it/s] 50%|█████     | 18/36 [00:05<00:05,  3.02it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.01it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.01it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.00it/s] 61%|██████    | 22/36 [00:07<00:04,  3.01it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.00it/s] 67%|██████▋   | 24/36 [00:07<00:04,  3.00it/s] 69%|██████▉   | 25/36 [00:08<00:03,  2.99it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.00it/s] 75%|███████▌  | 27/36 [00:08<00:03,  2.98it/s] 78%|███████▊  | 28/36 [00:09<00:02,  2.99it/s] 81%|████████  | 29/36 [00:09<00:02,  3.00it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.00it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.00it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.01it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.01it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.01it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.01it/s]100%|██████████| 36/36 [00:11<00:00,  3.01it/s]100%|██████████| 36/36 [00:11<00:00,  3.00it/s]
Inference completed in 12.02s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.53GB
输入形状: (14, 168, 200, 200)
目标形状: (140, 512, 512)
预估内存需求: 1.91GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8333333333333334, 2.56, 2.56]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.19s
重采样后内存: 3.45GB (增加: 1.91GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 140, 512, 512), 内存占用: 1.91GB
分块策略: 块大小=8, 预计块数=18
创建了 18 个处理块，每块约 8 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.58s
处理完成后内存: 1.57GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.81s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.25s
Case FLARETs_0090_0000.nii.gz completed in 17.65s total (preprocess: 2.38s, inference: 12.02s, postprocess: 3.25s)
Step 4/4: Ready for next case...

=== Processing case 91/200: FLARETs_0091_0000.nii.gz ===
File FLARETs_0091_0000.nii.gz: 28.97 MB
Total file size: 28.97 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.66s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/54 [00:00<?, ?it/s]  2%|▏         | 1/54 [00:00<00:17,  2.97it/s]  4%|▎         | 2/54 [00:00<00:17,  2.99it/s]  6%|▌         | 3/54 [00:00<00:16,  3.01it/s]  7%|▋         | 4/54 [00:01<00:16,  3.01it/s]  9%|▉         | 5/54 [00:01<00:16,  3.02it/s] 11%|█         | 6/54 [00:01<00:15,  3.03it/s] 13%|█▎        | 7/54 [00:02<00:15,  3.04it/s] 15%|█▍        | 8/54 [00:02<00:15,  3.05it/s] 17%|█▋        | 9/54 [00:02<00:14,  3.05it/s] 19%|█▊        | 10/54 [00:03<00:14,  3.04it/s] 20%|██        | 11/54 [00:03<00:14,  3.05it/s] 22%|██▏       | 12/54 [00:03<00:13,  3.04it/s] 24%|██▍       | 13/54 [00:04<00:13,  3.04it/s] 26%|██▌       | 14/54 [00:04<00:13,  3.05it/s] 28%|██▊       | 15/54 [00:04<00:12,  3.05it/s] 30%|██▉       | 16/54 [00:05<00:12,  3.05it/s] 31%|███▏      | 17/54 [00:05<00:12,  3.04it/s] 33%|███▎      | 18/54 [00:05<00:11,  3.05it/s] 35%|███▌      | 19/54 [00:06<00:11,  3.04it/s] 37%|███▋      | 20/54 [00:06<00:11,  3.04it/s] 39%|███▉      | 21/54 [00:06<00:10,  3.05it/s] 41%|████      | 22/54 [00:07<00:10,  3.04it/s] 43%|████▎     | 23/54 [00:07<00:10,  3.04it/s] 44%|████▍     | 24/54 [00:07<00:09,  3.05it/s] 46%|████▋     | 25/54 [00:08<00:09,  3.05it/s] 48%|████▊     | 26/54 [00:08<00:09,  3.05it/s] 50%|█████     | 27/54 [00:08<00:08,  3.03it/s] 52%|█████▏    | 28/54 [00:09<00:08,  3.02it/s] 54%|█████▎    | 29/54 [00:09<00:08,  3.04it/s] 56%|█████▌    | 30/54 [00:09<00:07,  3.03it/s] 57%|█████▋    | 31/54 [00:10<00:07,  3.04it/s] 59%|█████▉    | 32/54 [00:10<00:07,  3.04it/s] 61%|██████    | 33/54 [00:10<00:06,  3.05it/s] 63%|██████▎   | 34/54 [00:11<00:06,  3.05it/s] 65%|██████▍   | 35/54 [00:11<00:06,  3.04it/s] 67%|██████▋   | 36/54 [00:11<00:05,  3.05it/s] 69%|██████▊   | 37/54 [00:12<00:05,  3.06it/s] 70%|███████   | 38/54 [00:12<00:05,  3.07it/s] 72%|███████▏  | 39/54 [00:12<00:04,  3.05it/s] 74%|███████▍  | 40/54 [00:13<00:04,  3.04it/s] 76%|███████▌  | 41/54 [00:13<00:04,  3.04it/s] 78%|███████▊  | 42/54 [00:13<00:03,  3.04it/s] 80%|███████▉  | 43/54 [00:14<00:03,  3.05it/s] 81%|████████▏ | 44/54 [00:14<00:03,  3.05it/s] 83%|████████▎ | 45/54 [00:14<00:02,  3.04it/s] 85%|████████▌ | 46/54 [00:15<00:02,  3.04it/s] 87%|████████▋ | 47/54 [00:15<00:02,  3.03it/s] 89%|████████▉ | 48/54 [00:15<00:01,  3.02it/s] 91%|█████████ | 49/54 [00:16<00:01,  3.02it/s] 93%|█████████▎| 50/54 [00:16<00:01,  3.00it/s] 94%|█████████▍| 51/54 [00:16<00:00,  3.02it/s] 96%|█████████▋| 52/54 [00:17<00:00,  3.02it/s] 98%|█████████▊| 53/54 [00:17<00:00,  3.03it/s]100%|██████████| 54/54 [00:17<00:00,  3.03it/s]100%|██████████| 54/54 [00:17<00:00,  3.04it/s]
Inference completed in 17.83s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.69GB
输入形状: (14, 266, 200, 200)
目标形状: (133, 512, 512)
预估内存需求: 1.82GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.56, 2.56]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.14s
重采样后内存: 3.50GB (增加: 1.82GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 133, 512, 512), 内存占用: 1.82GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.53s
处理完成后内存: 1.72GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.70s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.26s
Case FLARETs_0091_0000.nii.gz completed in 23.75s total (preprocess: 2.66s, inference: 17.83s, postprocess: 3.26s)
Step 4/4: Ready for next case...

=== Processing case 92/200: FLARETs_0092_0000.nii.gz ===
File FLARETs_0092_0000.nii.gz: 38.10 MB
Total file size: 38.10 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.42s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:07,  2.98it/s]  8%|▊         | 2/24 [00:00<00:07,  3.01it/s] 12%|█▎        | 3/24 [00:00<00:06,  3.02it/s] 17%|█▋        | 4/24 [00:01<00:06,  3.01it/s] 21%|██        | 5/24 [00:01<00:06,  3.02it/s] 25%|██▌       | 6/24 [00:01<00:05,  3.03it/s] 29%|██▉       | 7/24 [00:02<00:05,  3.03it/s] 33%|███▎      | 8/24 [00:02<00:05,  3.03it/s] 38%|███▊      | 9/24 [00:02<00:04,  3.02it/s] 42%|████▏     | 10/24 [00:03<00:04,  3.02it/s] 46%|████▌     | 11/24 [00:03<00:04,  3.03it/s] 50%|█████     | 12/24 [00:03<00:03,  3.03it/s] 54%|█████▍    | 13/24 [00:04<00:03,  3.02it/s] 58%|█████▊    | 14/24 [00:04<00:03,  3.02it/s] 62%|██████▎   | 15/24 [00:04<00:02,  3.03it/s] 67%|██████▋   | 16/24 [00:05<00:02,  3.02it/s] 71%|███████   | 17/24 [00:05<00:02,  3.02it/s] 75%|███████▌  | 18/24 [00:05<00:01,  3.02it/s] 79%|███████▉  | 19/24 [00:06<00:01,  3.02it/s] 83%|████████▎ | 20/24 [00:06<00:01,  3.03it/s] 88%|████████▊ | 21/24 [00:06<00:00,  3.02it/s] 92%|█████████▏| 22/24 [00:07<00:00,  3.03it/s] 96%|█████████▌| 23/24 [00:07<00:00,  3.04it/s]100%|██████████| 24/24 [00:07<00:00,  3.03it/s]100%|██████████| 24/24 [00:07<00:00,  3.02it/s]
Inference completed in 7.98s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.64GB
输入形状: (14, 248, 180, 180)
目标形状: (124, 512, 512)
预估内存需求: 1.70GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.8444444444444446, 2.8444444444444446]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.88s
重采样后内存: 3.33GB (增加: 1.70GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 124, 512, 512), 内存占用: 1.70GB
分块策略: 块大小=7, 预计块数=18
创建了 18 个处理块，每块约 7 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.51s
处理完成后内存: 1.64GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.42s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.89s
Case FLARETs_0092_0000.nii.gz completed in 13.29s total (preprocess: 2.42s, inference: 7.98s, postprocess: 2.89s)
Step 4/4: Ready for next case...

=== Processing case 93/200: FLARETs_0093_0000.nii.gz ===
File FLARETs_0093_0000.nii.gz: 30.70 MB
Total file size: 30.70 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.32s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  2.96it/s]  4%|▍         | 2/45 [00:00<00:14,  2.98it/s]  7%|▋         | 3/45 [00:01<00:14,  3.00it/s]  9%|▉         | 4/45 [00:01<00:13,  3.01it/s] 11%|█         | 5/45 [00:01<00:13,  3.00it/s] 13%|█▎        | 6/45 [00:02<00:13,  3.00it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.00it/s] 18%|█▊        | 8/45 [00:02<00:12,  2.99it/s] 20%|██        | 9/45 [00:03<00:12,  2.99it/s] 22%|██▏       | 10/45 [00:03<00:11,  2.99it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.01it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.01it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.01it/s] 31%|███       | 14/45 [00:04<00:10,  3.03it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.03it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.04it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.03it/s] 40%|████      | 18/45 [00:05<00:08,  3.01it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.00it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.01it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.01it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.02it/s] 51%|█████     | 23/45 [00:07<00:07,  3.02it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.01it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.01it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.00it/s] 60%|██████    | 27/45 [00:08<00:06,  2.99it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.00it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.01it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.02it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.02it/s] 71%|███████   | 32/45 [00:10<00:04,  3.02it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.03it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.02it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.03it/s] 80%|████████  | 36/45 [00:11<00:02,  3.03it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.02it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.03it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.02it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.03it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.03it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.03it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.03it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.01it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]
Inference completed in 14.98s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.63GB
输入形状: (14, 232, 198, 198)
目标形状: (116, 512, 512)
预估内存需求: 1.59GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.585858585858586, 2.585858585858586]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.77s
重采样后内存: 3.22GB (增加: 1.59GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 116, 512, 512), 内存占用: 1.59GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.63GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.24s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.74s
Case FLARETs_0093_0000.nii.gz completed in 20.04s total (preprocess: 2.32s, inference: 14.98s, postprocess: 2.74s)
Step 4/4: Ready for next case...

=== Processing case 94/200: FLARETs_0094_0000.nii.gz ===
File FLARETs_0094_0000.nii.gz: 25.87 MB
Total file size: 25.87 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.57s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.00it/s]  4%|▍         | 2/45 [00:00<00:14,  3.03it/s]  7%|▋         | 3/45 [00:00<00:13,  3.03it/s]  9%|▉         | 4/45 [00:01<00:13,  3.04it/s] 11%|█         | 5/45 [00:01<00:13,  3.03it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.04it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.04it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.04it/s] 20%|██        | 9/45 [00:02<00:11,  3.03it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.02it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.02it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.03it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.02it/s] 31%|███       | 14/45 [00:04<00:10,  3.02it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.00it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.01it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.01it/s] 40%|████      | 18/45 [00:05<00:08,  3.00it/s] 42%|████▏     | 19/45 [00:06<00:08,  2.99it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.00it/s] 47%|████▋     | 21/45 [00:06<00:08,  2.98it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.00it/s] 51%|█████     | 23/45 [00:07<00:07,  3.00it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.01it/s] 56%|█████▌    | 25/45 [00:08<00:06,  2.99it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.00it/s] 60%|██████    | 27/45 [00:08<00:06,  3.00it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.00it/s] 64%|██████▍   | 29/45 [00:09<00:05,  2.99it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.00it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.00it/s] 71%|███████   | 32/45 [00:10<00:04,  3.01it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.00it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.00it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.00it/s] 80%|████████  | 36/45 [00:11<00:02,  3.01it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.00it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.01it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.00it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.02it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.01it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.01it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.02it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.03it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]
Inference completed in 15.01s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.73GB
输入形状: (14, 206, 245, 245)
目标形状: (103, 512, 512)
预估内存需求: 1.41GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.089795918367347, 2.089795918367347]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.62s
重采样后内存: 3.14GB (增加: 1.41GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 103, 512, 512), 内存占用: 1.41GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.43s
处理完成后内存: 1.75GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 2.07s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.64s
Case FLARETs_0094_0000.nii.gz completed in 20.23s total (preprocess: 2.57s, inference: 15.01s, postprocess: 2.64s)
Step 4/4: Ready for next case...

=== Processing case 95/200: FLARETs_0095_0000.nii.gz ===
File FLARETs_0095_0000.nii.gz: 30.52 MB
Total file size: 30.52 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.84s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:08,  3.03it/s]  7%|▋         | 2/27 [00:00<00:08,  3.06it/s] 11%|█         | 3/27 [00:00<00:07,  3.04it/s] 15%|█▍        | 4/27 [00:01<00:07,  3.05it/s] 19%|█▊        | 5/27 [00:01<00:07,  3.02it/s] 22%|██▏       | 6/27 [00:01<00:06,  3.03it/s] 26%|██▌       | 7/27 [00:02<00:06,  3.03it/s] 30%|██▉       | 8/27 [00:02<00:06,  3.02it/s] 33%|███▎      | 9/27 [00:02<00:05,  3.01it/s] 37%|███▋      | 10/27 [00:03<00:05,  3.02it/s] 41%|████      | 11/27 [00:03<00:05,  3.02it/s] 44%|████▍     | 12/27 [00:03<00:04,  3.02it/s] 48%|████▊     | 13/27 [00:04<00:04,  2.95it/s] 52%|█████▏    | 14/27 [00:04<00:04,  2.92it/s] 56%|█████▌    | 15/27 [00:05<00:04,  2.88it/s] 59%|█████▉    | 16/27 [00:05<00:03,  2.88it/s] 63%|██████▎   | 17/27 [00:05<00:03,  2.86it/s] 67%|██████▋   | 18/27 [00:06<00:03,  2.86it/s] 70%|███████   | 19/27 [00:06<00:02,  2.85it/s] 74%|███████▍  | 20/27 [00:06<00:02,  2.85it/s] 78%|███████▊  | 21/27 [00:07<00:02,  2.88it/s] 81%|████████▏ | 22/27 [00:07<00:01,  2.88it/s] 85%|████████▌ | 23/27 [00:07<00:01,  2.86it/s] 89%|████████▉ | 24/27 [00:08<00:01,  2.86it/s] 93%|█████████▎| 25/27 [00:08<00:00,  2.85it/s] 96%|█████████▋| 26/27 [00:08<00:00,  2.85it/s]100%|██████████| 27/27 [00:09<00:00,  2.84it/s]100%|██████████| 27/27 [00:09<00:00,  2.92it/s]
Inference completed in 9.27s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.52GB
输入形状: (14, 122, 210, 210)
目标形状: (102, 512, 512)
预估内存需求: 1.39GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8360655737704918, 2.4380952380952383, 2.4380952380952383]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.62s
重采样后内存: 2.91GB (增加: 1.39GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 102, 512, 512), 内存占用: 1.39GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.43s
处理完成后内存: 1.52GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.09s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.50s
Case FLARETs_0095_0000.nii.gz completed in 13.61s total (preprocess: 1.84s, inference: 9.27s, postprocess: 2.50s)
Step 4/4: Ready for next case...

=== Processing case 96/200: FLARETs_0096_0000.nii.gz ===
File FLARETs_0096_0000.nii.gz: 44.02 MB
Total file size: 44.02 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.89s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.00it/s]  6%|▌         | 2/36 [00:00<00:11,  3.07it/s]  8%|▊         | 3/36 [00:00<00:10,  3.07it/s] 11%|█         | 4/36 [00:01<00:10,  3.06it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.04it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.04it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.03it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.03it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.01it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.00it/s] 31%|███       | 11/36 [00:03<00:08,  3.00it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.01it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.01it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.01it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.00it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.00it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.00it/s] 50%|█████     | 18/36 [00:05<00:06,  2.99it/s] 53%|█████▎    | 19/36 [00:06<00:05,  2.99it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.00it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.00it/s] 61%|██████    | 22/36 [00:07<00:04,  3.01it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.00it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.01it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.01it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.03it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.02it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.01it/s] 81%|████████  | 29/36 [00:09<00:02,  3.01it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.01it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.02it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.01it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.00it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.02it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.02it/s]100%|██████████| 36/36 [00:11<00:00,  3.01it/s]100%|██████████| 36/36 [00:11<00:00,  3.01it/s]
Inference completed in 11.99s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.61GB
输入形状: (14, 194, 210, 210)
目标形状: (162, 512, 512)
预估内存需求: 2.21GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8350515463917526, 2.4380952380952383, 2.4380952380952383]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.52s
重采样后内存: 3.83GB (增加: 2.21GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 162, 512, 512), 内存占用: 2.21GB
分块策略: 块大小=6, 预计块数=27
创建了 27 个处理块，每块约 6 切片
后处理进度: 6/27 块 (22.2%)
后处理进度: 12/27 块 (44.4%)
后处理进度: 18/27 块 (66.7%)
后处理进度: 24/27 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.60s
处理完成后内存: 1.65GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.16s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.65s
Case FLARETs_0096_0000.nii.gz completed in 18.53s total (preprocess: 2.89s, inference: 11.99s, postprocess: 3.65s)
Step 4/4: Ready for next case...

=== Processing case 97/200: FLARETs_0097_0000.nii.gz ===
File FLARETs_0097_0000.nii.gz: 63.70 MB
Total file size: 63.70 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.30s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:00<00:23,  3.01it/s]  3%|▎         | 2/72 [00:00<00:23,  3.04it/s]  4%|▍         | 3/72 [00:00<00:22,  3.03it/s]  6%|▌         | 4/72 [00:01<00:22,  3.02it/s]  7%|▋         | 5/72 [00:01<00:22,  3.01it/s]  8%|▊         | 6/72 [00:01<00:21,  3.01it/s] 10%|▉         | 7/72 [00:02<00:21,  3.01it/s] 11%|█         | 8/72 [00:02<00:21,  3.00it/s] 12%|█▎        | 9/72 [00:02<00:20,  3.01it/s] 14%|█▍        | 10/72 [00:03<00:20,  3.01it/s] 15%|█▌        | 11/72 [00:03<00:20,  3.01it/s] 17%|█▋        | 12/72 [00:03<00:20,  2.98it/s] 18%|█▊        | 13/72 [00:04<00:19,  3.00it/s] 19%|█▉        | 14/72 [00:04<00:19,  3.00it/s] 21%|██        | 15/72 [00:04<00:19,  3.00it/s] 22%|██▏       | 16/72 [00:05<00:18,  3.00it/s] 24%|██▎       | 17/72 [00:05<00:18,  3.00it/s] 25%|██▌       | 18/72 [00:05<00:18,  3.00it/s] 26%|██▋       | 19/72 [00:06<00:17,  3.01it/s] 28%|██▊       | 20/72 [00:06<00:17,  3.01it/s] 29%|██▉       | 21/72 [00:06<00:16,  3.01it/s] 31%|███       | 22/72 [00:07<00:16,  3.01it/s] 32%|███▏      | 23/72 [00:07<00:16,  3.01it/s] 33%|███▎      | 24/72 [00:07<00:15,  3.01it/s] 35%|███▍      | 25/72 [00:08<00:15,  3.00it/s] 36%|███▌      | 26/72 [00:08<00:15,  3.00it/s] 38%|███▊      | 27/72 [00:08<00:14,  3.01it/s] 39%|███▉      | 28/72 [00:09<00:14,  3.01it/s] 40%|████      | 29/72 [00:09<00:14,  3.02it/s] 42%|████▏     | 30/72 [00:09<00:13,  3.01it/s] 43%|████▎     | 31/72 [00:10<00:13,  3.02it/s] 44%|████▍     | 32/72 [00:10<00:13,  3.02it/s] 46%|████▌     | 33/72 [00:10<00:12,  3.01it/s] 47%|████▋     | 34/72 [00:11<00:12,  3.02it/s] 49%|████▊     | 35/72 [00:11<00:12,  3.02it/s] 50%|█████     | 36/72 [00:11<00:11,  3.02it/s] 51%|█████▏    | 37/72 [00:12<00:11,  3.02it/s] 53%|█████▎    | 38/72 [00:12<00:11,  3.00it/s] 54%|█████▍    | 39/72 [00:12<00:11,  2.99it/s] 56%|█████▌    | 40/72 [00:13<00:10,  2.99it/s] 57%|█████▋    | 41/72 [00:13<00:10,  2.99it/s] 58%|█████▊    | 42/72 [00:13<00:10,  2.98it/s] 60%|█████▉    | 43/72 [00:14<00:09,  2.98it/s] 61%|██████    | 44/72 [00:14<00:09,  2.98it/s] 62%|██████▎   | 45/72 [00:14<00:09,  2.99it/s] 64%|██████▍   | 46/72 [00:15<00:08,  2.99it/s] 65%|██████▌   | 47/72 [00:15<00:08,  2.99it/s] 67%|██████▋   | 48/72 [00:15<00:08,  2.99it/s] 68%|██████▊   | 49/72 [00:16<00:07,  2.98it/s] 69%|██████▉   | 50/72 [00:16<00:07,  2.97it/s] 71%|███████   | 51/72 [00:16<00:07,  2.98it/s] 72%|███████▏  | 52/72 [00:17<00:06,  2.98it/s] 74%|███████▎  | 53/72 [00:17<00:06,  3.00it/s] 75%|███████▌  | 54/72 [00:17<00:06,  2.99it/s] 76%|███████▋  | 55/72 [00:18<00:05,  3.00it/s] 78%|███████▊  | 56/72 [00:18<00:05,  3.00it/s] 79%|███████▉  | 57/72 [00:18<00:05,  3.00it/s] 81%|████████  | 58/72 [00:19<00:04,  3.00it/s] 82%|████████▏ | 59/72 [00:19<00:04,  2.99it/s] 83%|████████▎ | 60/72 [00:19<00:04,  3.00it/s] 85%|████████▍ | 61/72 [00:20<00:03,  3.00it/s] 86%|████████▌ | 62/72 [00:20<00:03,  3.00it/s] 88%|████████▊ | 63/72 [00:20<00:02,  3.00it/s] 89%|████████▉ | 64/72 [00:21<00:02,  2.99it/s] 90%|█████████ | 65/72 [00:21<00:02,  2.99it/s] 92%|█████████▏| 66/72 [00:21<00:02,  3.00it/s] 93%|█████████▎| 67/72 [00:22<00:01,  2.99it/s] 94%|█████████▍| 68/72 [00:22<00:01,  2.99it/s] 96%|█████████▌| 69/72 [00:22<00:00,  3.00it/s] 97%|█████████▋| 70/72 [00:23<00:00,  3.00it/s] 99%|█████████▊| 71/72 [00:23<00:00,  2.99it/s]100%|██████████| 72/72 [00:24<00:00,  2.98it/s]100%|██████████| 72/72 [00:24<00:00,  3.00it/s]
Inference completed in 24.11s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 2.00GB
输入形状: (14, 344, 250, 250)
目标形状: (215, 512, 512)
预估内存需求: 2.94GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.625, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.37s
重采样后内存: 4.94GB (增加: 2.94GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 215, 512, 512), 内存占用: 2.94GB
分块策略: 块大小=8, 预计块数=27
创建了 27 个处理块，每块约 8 切片
后处理进度: 6/27 块 (22.2%)
后处理进度: 12/27 块 (44.4%)
后处理进度: 18/27 块 (66.7%)
后处理进度: 24/27 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.81s
处理完成后内存: 2.05GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 4.23s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.99s
Case FLARETs_0097_0000.nii.gz completed in 34.40s total (preprocess: 5.30s, inference: 24.11s, postprocess: 4.99s)
Step 4/4: Ready for next case...

=== Processing case 98/200: FLARETs_0098_0000.nii.gz ===
File FLARETs_0098_0000.nii.gz: 48.44 MB
Total file size: 48.44 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.13s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.78it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.83it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.87it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.88it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.87it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.89it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.85it/s] 50%|█████     | 8/16 [00:02<00:02,  2.84it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.82it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.82it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.83it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.82it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.86it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.91it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.93it/s]100%|██████████| 16/16 [00:05<00:00,  2.96it/s]100%|██████████| 16/16 [00:05<00:00,  2.88it/s]
Inference completed in 5.60s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.52GB
输入形状: (14, 167, 190, 190)
目标形状: (167, 512, 512)
预估内存需求: 2.28GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.60s
重采样后内存: 3.80GB (增加: 2.28GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 167, 512, 512), 内存占用: 2.28GB
分块策略: 块大小=6, 预计块数=28
创建了 28 个处理块，每块约 6 切片
后处理进度: 7/28 块 (25.0%)
后处理进度: 14/28 块 (50.0%)
后处理进度: 21/28 块 (75.0%)
后处理进度: 28/28 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.61s
处理完成后内存: 1.56GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.25s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.67s
Case FLARETs_0098_0000.nii.gz completed in 11.40s total (preprocess: 2.13s, inference: 5.60s, postprocess: 3.67s)
Step 4/4: Ready for next case...

=== Processing case 99/200: FLARETs_0099_0000.nii.gz ===
File FLARETs_0099_0000.nii.gz: 92.42 MB
Total file size: 92.42 MB
⚠️  File size (92.42 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0099.nii.gz with shape (512, 512, 287)
✅ Dummy results generated: FLARETs_0099.nii.gz
Case FLARETs_0099_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 100/200: FLARETs_0100_0000.nii.gz ===
File FLARETs_0100_0000.nii.gz: 44.20 MB
Total file size: 44.20 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.13s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:02,  2.89it/s] 25%|██▌       | 2/8 [00:00<00:02,  2.93it/s] 38%|███▊      | 3/8 [00:01<00:01,  2.92it/s] 50%|█████     | 4/8 [00:01<00:01,  2.93it/s] 62%|██████▎   | 5/8 [00:01<00:01,  2.93it/s] 75%|███████▌  | 6/8 [00:02<00:00,  2.93it/s] 88%|████████▊ | 7/8 [00:02<00:00,  2.93it/s]100%|██████████| 8/8 [00:02<00:00,  2.93it/s]100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
Inference completed in 2.75s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.45GB
输入形状: (14, 114, 174, 174)
目标形状: (143, 512, 512)
预估内存需求: 1.96GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.2543859649122806, 2.942528735632184, 2.942528735632184]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.22s
重采样后内存: 3.40GB (增加: 1.96GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 143, 512, 512), 内存占用: 1.96GB
分块策略: 块大小=8, 预计块数=18
创建了 18 个处理块，每块约 8 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.48GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.06s
🎯 深度优化总耗时: 2.87s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.25s
Case FLARETs_0100_0000.nii.gz completed in 9.13s total (preprocess: 3.13s, inference: 2.75s, postprocess: 3.25s)
Step 4/4: Ready for next case...

=== Processing case 101/200: FLARETs_0101_0000.nii.gz ===
File FLARETs_0101_0000.nii.gz: 106.16 MB
Total file size: 106.16 MB
⚠️  File size (106.16 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0101.nii.gz with shape (512, 512, 412)
✅ Dummy results generated: FLARETs_0101.nii.gz
Case FLARETs_0101_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 102/200: FLARETs_0102_0000.nii.gz ===
File FLARETs_0102_0000.nii.gz: 76.48 MB
Total file size: 76.48 MB
⚠️  File size (76.48 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0102.nii.gz with shape (512, 512, 249)
✅ Dummy results generated: FLARETs_0102.nii.gz
Case FLARETs_0102_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 103/200: FLARETs_0103_0000.nii.gz ===
File FLARETs_0103_0000.nii.gz: 69.08 MB
Total file size: 69.08 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.17s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/63 [00:00<?, ?it/s]  2%|▏         | 1/63 [00:00<00:20,  3.02it/s]  3%|▎         | 2/63 [00:00<00:20,  3.05it/s]  5%|▍         | 3/63 [00:00<00:19,  3.02it/s]  6%|▋         | 4/63 [00:01<00:19,  3.05it/s]  8%|▊         | 5/63 [00:01<00:19,  3.04it/s] 10%|▉         | 6/63 [00:01<00:18,  3.06it/s] 11%|█         | 7/63 [00:02<00:18,  3.07it/s] 13%|█▎        | 8/63 [00:02<00:17,  3.07it/s] 14%|█▍        | 9/63 [00:02<00:17,  3.07it/s] 16%|█▌        | 10/63 [00:03<00:17,  3.07it/s] 17%|█▋        | 11/63 [00:03<00:16,  3.06it/s] 19%|█▉        | 12/63 [00:03<00:16,  3.08it/s] 21%|██        | 13/63 [00:04<00:16,  3.06it/s] 22%|██▏       | 14/63 [00:04<00:16,  3.05it/s] 24%|██▍       | 15/63 [00:04<00:15,  3.03it/s] 25%|██▌       | 16/63 [00:05<00:15,  3.02it/s] 27%|██▋       | 17/63 [00:05<00:15,  3.02it/s] 29%|██▊       | 18/63 [00:05<00:14,  3.01it/s] 30%|███       | 19/63 [00:06<00:14,  3.00it/s] 32%|███▏      | 20/63 [00:06<00:14,  3.00it/s] 33%|███▎      | 21/63 [00:06<00:13,  3.01it/s] 35%|███▍      | 22/63 [00:07<00:13,  3.03it/s] 37%|███▋      | 23/63 [00:07<00:13,  3.02it/s] 38%|███▊      | 24/63 [00:07<00:12,  3.02it/s] 40%|███▉      | 25/63 [00:08<00:12,  3.00it/s] 41%|████▏     | 26/63 [00:08<00:12,  3.00it/s] 43%|████▎     | 27/63 [00:08<00:11,  3.01it/s] 44%|████▍     | 28/63 [00:09<00:11,  3.01it/s] 46%|████▌     | 29/63 [00:09<00:11,  3.01it/s] 48%|████▊     | 30/63 [00:09<00:10,  3.01it/s] 49%|████▉     | 31/63 [00:10<00:10,  3.01it/s] 51%|█████     | 32/63 [00:10<00:10,  3.01it/s] 52%|█████▏    | 33/63 [00:10<00:09,  3.03it/s] 54%|█████▍    | 34/63 [00:11<00:09,  3.03it/s] 56%|█████▌    | 35/63 [00:11<00:09,  3.04it/s] 57%|█████▋    | 36/63 [00:11<00:08,  3.03it/s] 59%|█████▊    | 37/63 [00:12<00:08,  3.04it/s] 60%|██████    | 38/63 [00:12<00:08,  3.04it/s] 62%|██████▏   | 39/63 [00:12<00:07,  3.04it/s] 63%|██████▎   | 40/63 [00:13<00:07,  3.04it/s] 65%|██████▌   | 41/63 [00:13<00:07,  3.04it/s] 67%|██████▋   | 42/63 [00:13<00:06,  3.04it/s] 68%|██████▊   | 43/63 [00:14<00:06,  3.05it/s] 70%|██████▉   | 44/63 [00:14<00:06,  3.05it/s] 71%|███████▏  | 45/63 [00:14<00:05,  3.05it/s] 73%|███████▎  | 46/63 [00:15<00:05,  3.05it/s] 75%|███████▍  | 47/63 [00:15<00:05,  3.04it/s] 76%|███████▌  | 48/63 [00:15<00:04,  3.04it/s] 78%|███████▊  | 49/63 [00:16<00:04,  3.03it/s] 79%|███████▉  | 50/63 [00:16<00:04,  3.03it/s] 81%|████████  | 51/63 [00:16<00:03,  3.03it/s] 83%|████████▎ | 52/63 [00:17<00:03,  3.02it/s] 84%|████████▍ | 53/63 [00:17<00:03,  3.03it/s] 86%|████████▌ | 54/63 [00:17<00:02,  3.03it/s] 87%|████████▋ | 55/63 [00:18<00:02,  3.04it/s] 89%|████████▉ | 56/63 [00:18<00:02,  3.03it/s] 90%|█████████ | 57/63 [00:18<00:01,  3.02it/s] 92%|█████████▏| 58/63 [00:19<00:01,  3.02it/s] 94%|█████████▎| 59/63 [00:19<00:01,  3.02it/s] 95%|█████████▌| 60/63 [00:19<00:00,  3.02it/s] 97%|█████████▋| 61/63 [00:20<00:00,  3.04it/s] 98%|█████████▊| 62/63 [00:20<00:00,  3.03it/s]100%|██████████| 63/63 [00:20<00:00,  3.03it/s]100%|██████████| 63/63 [00:20<00:00,  3.03it/s]
Inference completed in 20.86s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.93GB
输入形状: (14, 297, 250, 250)
目标形状: (227, 512, 512)
预估内存需求: 3.10GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.7643097643097643, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.51s
重采样后内存: 5.03GB (增加: 3.10GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 227, 512, 512), 内存占用: 3.10GB
分块策略: 块大小=9, 预计块数=26
创建了 26 个处理块，每块约 9 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.89s
处理完成后内存: 2.04GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 4.45s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 5.15s
Case FLARETs_0103_0000.nii.gz completed in 31.18s total (preprocess: 5.17s, inference: 20.86s, postprocess: 5.15s)
Step 4/4: Ready for next case...

=== Processing case 104/200: FLARETs_0104_0000.nii.gz ===
File FLARETs_0104_0000.nii.gz: 68.97 MB
Total file size: 68.97 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.14s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/63 [00:00<?, ?it/s]  2%|▏         | 1/63 [00:00<00:20,  3.00it/s]  3%|▎         | 2/63 [00:00<00:20,  3.03it/s]  5%|▍         | 3/63 [00:00<00:19,  3.02it/s]  6%|▋         | 4/63 [00:01<00:19,  3.02it/s]  8%|▊         | 5/63 [00:01<00:19,  3.02it/s] 10%|▉         | 6/63 [00:01<00:18,  3.02it/s] 11%|█         | 7/63 [00:02<00:18,  3.02it/s] 13%|█▎        | 8/63 [00:02<00:18,  3.03it/s] 14%|█▍        | 9/63 [00:02<00:17,  3.02it/s] 16%|█▌        | 10/63 [00:03<00:17,  3.02it/s] 17%|█▋        | 11/63 [00:03<00:17,  2.98it/s] 19%|█▉        | 12/63 [00:04<00:17,  2.94it/s] 21%|██        | 13/63 [00:04<00:17,  2.92it/s] 22%|██▏       | 14/63 [00:04<00:16,  2.91it/s] 24%|██▍       | 15/63 [00:05<00:16,  2.88it/s] 25%|██▌       | 16/63 [00:05<00:16,  2.87it/s] 27%|██▋       | 17/63 [00:05<00:16,  2.85it/s] 29%|██▊       | 18/63 [00:06<00:15,  2.86it/s] 30%|███       | 19/63 [00:06<00:15,  2.84it/s] 32%|███▏      | 20/63 [00:06<00:15,  2.84it/s] 33%|███▎      | 21/63 [00:07<00:14,  2.84it/s] 35%|███▍      | 22/63 [00:07<00:14,  2.83it/s] 37%|███▋      | 23/63 [00:07<00:14,  2.82it/s] 38%|███▊      | 24/63 [00:08<00:13,  2.83it/s] 40%|███▉      | 25/63 [00:08<00:13,  2.84it/s] 41%|████▏     | 26/63 [00:08<00:13,  2.84it/s] 43%|████▎     | 27/63 [00:09<00:12,  2.83it/s] 44%|████▍     | 28/63 [00:09<00:12,  2.85it/s] 46%|████▌     | 29/63 [00:09<00:11,  2.84it/s] 48%|████▊     | 30/63 [00:10<00:11,  2.84it/s] 49%|████▉     | 31/63 [00:10<00:11,  2.83it/s] 51%|█████     | 32/63 [00:11<00:10,  2.83it/s] 52%|█████▏    | 33/63 [00:11<00:10,  2.84it/s] 54%|█████▍    | 34/63 [00:11<00:10,  2.84it/s] 56%|█████▌    | 35/63 [00:12<00:09,  2.84it/s] 57%|█████▋    | 36/63 [00:12<00:09,  2.88it/s] 59%|█████▊    | 37/63 [00:12<00:08,  2.92it/s] 60%|██████    | 38/63 [00:13<00:08,  2.96it/s] 62%|██████▏   | 39/63 [00:13<00:08,  2.98it/s] 63%|██████▎   | 40/63 [00:13<00:07,  3.00it/s] 65%|██████▌   | 41/63 [00:14<00:07,  3.00it/s] 67%|██████▋   | 42/63 [00:14<00:06,  3.01it/s] 68%|██████▊   | 43/63 [00:14<00:06,  3.01it/s] 70%|██████▉   | 44/63 [00:15<00:06,  3.00it/s] 71%|███████▏  | 45/63 [00:15<00:06,  3.00it/s] 73%|███████▎  | 46/63 [00:15<00:05,  3.01it/s] 75%|███████▍  | 47/63 [00:16<00:05,  2.99it/s] 76%|███████▌  | 48/63 [00:16<00:04,  3.00it/s] 78%|███████▊  | 49/63 [00:16<00:04,  3.02it/s] 79%|███████▉  | 50/63 [00:17<00:04,  3.00it/s] 81%|████████  | 51/63 [00:17<00:03,  3.01it/s] 83%|████████▎ | 52/63 [00:17<00:03,  3.02it/s] 84%|████████▍ | 53/63 [00:18<00:03,  3.01it/s] 86%|████████▌ | 54/63 [00:18<00:02,  3.02it/s] 87%|████████▋ | 55/63 [00:18<00:02,  3.01it/s] 89%|████████▉ | 56/63 [00:19<00:02,  3.02it/s] 90%|█████████ | 57/63 [00:19<00:01,  3.01it/s] 92%|█████████▏| 58/63 [00:19<00:01,  3.01it/s] 94%|█████████▎| 59/63 [00:20<00:01,  3.01it/s] 95%|█████████▌| 60/63 [00:20<00:01,  3.00it/s] 97%|█████████▋| 61/63 [00:20<00:00,  3.01it/s] 98%|█████████▊| 62/63 [00:21<00:00,  3.04it/s]100%|██████████| 63/63 [00:21<00:00,  3.07it/s]100%|██████████| 63/63 [00:21<00:00,  2.95it/s]
Inference completed in 21.47s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.91GB
输入形状: (14, 297, 250, 250)
目标形状: (226, 512, 512)
预估内存需求: 3.09GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.7609427609427609, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.53s
重采样后内存: 5.00GB (增加: 3.09GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 226, 512, 512), 内存占用: 3.09GB
分块策略: 块大小=9, 预计块数=26
创建了 26 个处理块，每块约 9 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.90s
处理完成后内存: 1.91GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 4.47s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 5.18s
Case FLARETs_0104_0000.nii.gz completed in 31.78s total (preprocess: 5.14s, inference: 21.47s, postprocess: 5.18s)
Step 4/4: Ready for next case...

=== Processing case 105/200: FLARETs_0105_0000.nii.gz ===
File FLARETs_0105_0000.nii.gz: 77.74 MB
Total file size: 77.74 MB
⚠️  File size (77.74 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0105.nii.gz with shape (512, 512, 246)
✅ Dummy results generated: FLARETs_0105.nii.gz
Case FLARETs_0105_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 106/200: FLARETs_0106_0000.nii.gz ===
File FLARETs_0106_0000.nii.gz: 47.04 MB
Total file size: 47.04 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.36s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:03,  2.98it/s] 17%|█▋        | 2/12 [00:00<00:03,  3.01it/s] 25%|██▌       | 3/12 [00:00<00:02,  3.01it/s] 33%|███▎      | 4/12 [00:01<00:02,  3.01it/s] 42%|████▏     | 5/12 [00:01<00:02,  3.02it/s] 50%|█████     | 6/12 [00:01<00:01,  3.00it/s] 58%|█████▊    | 7/12 [00:02<00:01,  3.00it/s] 67%|██████▋   | 8/12 [00:02<00:01,  2.99it/s] 75%|███████▌  | 9/12 [00:02<00:00,  3.00it/s] 83%|████████▎ | 10/12 [00:03<00:00,  2.99it/s] 92%|█████████▏| 11/12 [00:03<00:00,  2.99it/s]100%|██████████| 12/12 [00:04<00:00,  2.99it/s]100%|██████████| 12/12 [00:04<00:00,  3.00it/s]
Inference completed in 4.03s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.51GB
输入形状: (14, 150, 168, 168)
目标形状: (149, 512, 512)
预估内存需求: 2.04GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.9933333333333333, 3.0476190476190474, 3.0476190476190474]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.32s
重采样后内存: 3.54GB (增加: 2.04GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 149, 512, 512), 内存占用: 2.04GB
分块策略: 块大小=6, 预计块数=25
创建了 25 个处理块，每块约 6 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.57s
处理完成后内存: 1.52GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.93s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.32s
Case FLARETs_0106_0000.nii.gz completed in 9.70s total (preprocess: 2.36s, inference: 4.03s, postprocess: 3.32s)
Step 4/4: Ready for next case...

=== Processing case 107/200: FLARETs_0107_0000.nii.gz ===
File FLARETs_0107_0000.nii.gz: 79.74 MB
Total file size: 79.74 MB
⚠️  File size (79.74 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0107.nii.gz with shape (512, 512, 237)
✅ Dummy results generated: FLARETs_0107.nii.gz
Case FLARETs_0107_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 108/200: FLARETs_0108_0000.nii.gz ===
File FLARETs_0108_0000.nii.gz: 38.75 MB
Total file size: 38.75 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.42s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.04it/s]  6%|▌         | 2/36 [00:00<00:11,  3.05it/s]  8%|▊         | 3/36 [00:00<00:10,  3.04it/s] 11%|█         | 4/36 [00:01<00:10,  3.04it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.04it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.03it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.04it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.05it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.05it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.03it/s] 31%|███       | 11/36 [00:03<00:08,  3.03it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.04it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.03it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.03it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.03it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.03it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.04it/s] 50%|█████     | 18/36 [00:05<00:05,  3.04it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.04it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.03it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.03it/s] 61%|██████    | 22/36 [00:07<00:04,  3.04it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.03it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.03it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.03it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.02it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.02it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.02it/s] 81%|████████  | 29/36 [00:09<00:02,  3.02it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.03it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.04it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.04it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.04it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.03it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.03it/s]100%|██████████| 36/36 [00:11<00:00,  3.01it/s]100%|██████████| 36/36 [00:11<00:00,  3.03it/s]
Inference completed in 11.91s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.59GB
输入形状: (14, 164, 206, 206)
目标形状: (137, 512, 512)
预估内存需求: 1.87GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8353658536585366, 2.4854368932038833, 2.4854368932038833]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.12s
重采样后内存: 3.46GB (增加: 1.87GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 137, 512, 512), 内存占用: 1.87GB
分块策略: 块大小=8, 预计块数=18
创建了 18 个处理块，每块约 8 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.58s
处理完成后内存: 1.60GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.73s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.18s
Case FLARETs_0108_0000.nii.gz completed in 17.52s total (preprocess: 2.42s, inference: 11.91s, postprocess: 3.18s)
Step 4/4: Ready for next case...

=== Processing case 109/200: FLARETs_0109_0000.nii.gz ===
File FLARETs_0109_0000.nii.gz: 46.54 MB
Total file size: 46.54 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.10s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  2.97it/s]  4%|▍         | 2/45 [00:00<00:14,  2.97it/s]  7%|▋         | 3/45 [00:01<00:13,  3.00it/s]  9%|▉         | 4/45 [00:01<00:13,  3.01it/s] 11%|█         | 5/45 [00:01<00:13,  3.01it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.01it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.02it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.03it/s] 20%|██        | 9/45 [00:02<00:11,  3.03it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.02it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.02it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.02it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.02it/s] 31%|███       | 14/45 [00:04<00:10,  3.03it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.02it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.02it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.03it/s] 40%|████      | 18/45 [00:05<00:08,  3.02it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.03it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.03it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.01it/s] 49%|████▉     | 22/45 [00:07<00:07,  2.97it/s] 51%|█████     | 23/45 [00:07<00:07,  2.94it/s] 53%|█████▎    | 24/45 [00:08<00:07,  2.90it/s] 56%|█████▌    | 25/45 [00:08<00:06,  2.88it/s] 58%|█████▊    | 26/45 [00:08<00:06,  2.87it/s] 60%|██████    | 27/45 [00:09<00:06,  2.85it/s] 62%|██████▏   | 28/45 [00:09<00:05,  2.84it/s] 64%|██████▍   | 29/45 [00:09<00:05,  2.83it/s] 67%|██████▋   | 30/45 [00:10<00:05,  2.83it/s] 69%|██████▉   | 31/45 [00:10<00:04,  2.83it/s] 71%|███████   | 32/45 [00:10<00:04,  2.83it/s] 73%|███████▎  | 33/45 [00:11<00:04,  2.83it/s] 76%|███████▌  | 34/45 [00:11<00:03,  2.84it/s] 78%|███████▊  | 35/45 [00:11<00:03,  2.85it/s] 80%|████████  | 36/45 [00:12<00:03,  2.84it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.84it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.84it/s] 87%|████████▋ | 39/45 [00:13<00:02,  2.84it/s] 89%|████████▉ | 40/45 [00:13<00:01,  2.84it/s] 91%|█████████ | 41/45 [00:14<00:01,  2.84it/s] 93%|█████████▎| 42/45 [00:14<00:01,  2.84it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.84it/s] 98%|█████████▊| 44/45 [00:15<00:00,  2.84it/s]100%|██████████| 45/45 [00:15<00:00,  2.84it/s]100%|██████████| 45/45 [00:15<00:00,  2.92it/s]
Inference completed in 15.47s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.66GB
输入形状: (14, 202, 218, 218)
目标形状: (168, 512, 512)
预估内存需求: 2.30GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8316831683168316, 2.3486238532110093, 2.3486238532110093]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.63s
重采样后内存: 3.96GB (增加: 2.30GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 168, 512, 512), 内存占用: 2.30GB
分块策略: 块大小=7, 预计块数=24
创建了 24 个处理块，每块约 7 切片
后处理进度: 6/24 块 (25.0%)
后处理进度: 12/24 块 (50.0%)
后处理进度: 18/24 块 (75.0%)
后处理进度: 24/24 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.57s
处理完成后内存: 1.66GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.06s
🎯 深度优化总耗时: 3.26s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.77s
Case FLARETs_0109_0000.nii.gz completed in 22.35s total (preprocess: 3.10s, inference: 15.47s, postprocess: 3.77s)
Step 4/4: Ready for next case...

=== Processing case 110/200: FLARETs_0110_0000.nii.gz ===
File FLARETs_0110_0000.nii.gz: 77.87 MB
Total file size: 77.87 MB
⚠️  File size (77.87 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0110.nii.gz with shape (512, 512, 338)
✅ Dummy results generated: FLARETs_0110.nii.gz
Case FLARETs_0110_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 111/200: FLARETs_0111_0000.nii.gz ===
File FLARETs_0111_0000.nii.gz: 71.33 MB
Total file size: 71.33 MB
⚠️  File size (71.33 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0111.nii.gz with shape (512, 512, 269)
✅ Dummy results generated: FLARETs_0111.nii.gz
Case FLARETs_0111_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 112/200: FLARETs_0112_0000.nii.gz ===
File FLARETs_0112_0000.nii.gz: 81.05 MB
Total file size: 81.05 MB
⚠️  File size (81.05 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0112.nii.gz with shape (512, 512, 299)
✅ Dummy results generated: FLARETs_0112.nii.gz
Case FLARETs_0112_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 113/200: FLARETs_0113_0000.nii.gz ===
File FLARETs_0113_0000.nii.gz: 98.99 MB
Total file size: 98.99 MB
⚠️  File size (98.99 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0113.nii.gz with shape (512, 512, 396)
✅ Dummy results generated: FLARETs_0113.nii.gz
Case FLARETs_0113_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 114/200: FLARETs_0114_0000.nii.gz ===
File FLARETs_0114_0000.nii.gz: 85.43 MB
Total file size: 85.43 MB
⚠️  File size (85.43 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0114.nii.gz with shape (512, 512, 334)
✅ Dummy results generated: FLARETs_0114.nii.gz
Case FLARETs_0114_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 115/200: FLARETs_0115_0000.nii.gz ===
File FLARETs_0115_0000.nii.gz: 27.86 MB
Total file size: 27.86 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.98s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.93it/s]  6%|▌         | 2/36 [00:00<00:11,  2.97it/s]  8%|▊         | 3/36 [00:01<00:11,  2.96it/s] 11%|█         | 4/36 [00:01<00:10,  2.98it/s] 14%|█▍        | 5/36 [00:01<00:10,  2.98it/s] 17%|█▋        | 6/36 [00:02<00:10,  2.99it/s] 19%|█▉        | 7/36 [00:02<00:09,  2.99it/s] 22%|██▏       | 8/36 [00:02<00:09,  2.99it/s] 25%|██▌       | 9/36 [00:03<00:09,  2.99it/s] 28%|██▊       | 10/36 [00:03<00:08,  2.99it/s] 31%|███       | 11/36 [00:03<00:08,  2.98it/s] 33%|███▎      | 12/36 [00:04<00:08,  2.99it/s] 36%|███▌      | 13/36 [00:04<00:07,  2.99it/s] 39%|███▉      | 14/36 [00:04<00:07,  2.97it/s] 42%|████▏     | 15/36 [00:05<00:07,  2.98it/s] 44%|████▍     | 16/36 [00:05<00:06,  2.99it/s] 47%|████▋     | 17/36 [00:05<00:06,  2.98it/s] 50%|█████     | 18/36 [00:06<00:06,  2.99it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.00it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.00it/s] 58%|█████▊    | 21/36 [00:07<00:04,  3.01it/s] 61%|██████    | 22/36 [00:07<00:04,  3.00it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.00it/s] 67%|██████▋   | 24/36 [00:08<00:04,  3.00it/s] 69%|██████▉   | 25/36 [00:08<00:03,  2.99it/s] 72%|███████▏  | 26/36 [00:08<00:03,  2.99it/s] 75%|███████▌  | 27/36 [00:09<00:03,  3.00it/s] 78%|███████▊  | 28/36 [00:09<00:02,  2.98it/s] 81%|████████  | 29/36 [00:09<00:02,  2.98it/s] 83%|████████▎ | 30/36 [00:10<00:02,  2.99it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.00it/s] 89%|████████▉ | 32/36 [00:10<00:01,  2.99it/s] 92%|█████████▏| 33/36 [00:11<00:01,  2.99it/s] 94%|█████████▍| 34/36 [00:11<00:00,  2.99it/s] 97%|█████████▋| 35/36 [00:11<00:00,  2.99it/s]100%|██████████| 36/36 [00:12<00:00,  2.99it/s]100%|██████████| 36/36 [00:12<00:00,  2.99it/s]
Inference completed in 12.09s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.53GB
输入形状: (14, 200, 194, 194)
目标形状: (100, 512, 512)
预估内存需求: 1.37GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.6391752577319587, 2.6391752577319587]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.53s
重采样后内存: 2.90GB (增加: 1.37GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 100, 512, 512), 内存占用: 1.37GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.39s
处理完成后内存: 1.54GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 1.94s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.40s
Case FLARETs_0115_0000.nii.gz completed in 16.48s total (preprocess: 1.98s, inference: 12.09s, postprocess: 2.40s)
Step 4/4: Ready for next case...

=== Processing case 116/200: FLARETs_0116_0000.nii.gz ===
File FLARETs_0116_0000.nii.gz: 77.55 MB
Total file size: 77.55 MB
⚠️  File size (77.55 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0116.nii.gz with shape (512, 512, 272)
✅ Dummy results generated: FLARETs_0116.nii.gz
Case FLARETs_0116_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 117/200: FLARETs_0117_0000.nii.gz ===
File FLARETs_0117_0000.nii.gz: 56.31 MB
Total file size: 56.31 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.01s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:06,  3.07it/s] 10%|█         | 2/20 [00:00<00:05,  3.09it/s] 15%|█▌        | 3/20 [00:00<00:05,  3.08it/s] 20%|██        | 4/20 [00:01<00:05,  3.11it/s] 25%|██▌       | 5/20 [00:01<00:04,  3.09it/s] 30%|███       | 6/20 [00:01<00:04,  3.07it/s] 35%|███▌      | 7/20 [00:02<00:04,  3.07it/s] 40%|████      | 8/20 [00:02<00:03,  3.07it/s] 45%|████▌     | 9/20 [00:02<00:03,  3.06it/s] 50%|█████     | 10/20 [00:03<00:03,  3.06it/s] 55%|█████▌    | 11/20 [00:03<00:02,  3.07it/s] 60%|██████    | 12/20 [00:03<00:02,  3.05it/s] 65%|██████▌   | 13/20 [00:04<00:02,  3.04it/s] 70%|███████   | 14/20 [00:04<00:01,  3.04it/s] 75%|███████▌  | 15/20 [00:04<00:01,  3.04it/s] 80%|████████  | 16/20 [00:05<00:01,  3.05it/s] 85%|████████▌ | 17/20 [00:05<00:00,  3.04it/s] 90%|█████████ | 18/20 [00:05<00:00,  3.06it/s] 95%|█████████▌| 19/20 [00:06<00:00,  3.06it/s]100%|██████████| 20/20 [00:06<00:00,  3.05it/s]100%|██████████| 20/20 [00:06<00:00,  3.06it/s]
Inference completed in 6.57s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.53GB
输入形状: (14, 226, 178, 178)
目标形状: (188, 512, 512)
预估内存需求: 2.57GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.831858407079646, 2.8764044943820224, 2.8764044943820224]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.87s
重采样后内存: 4.10GB (增加: 2.57GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 188, 512, 512), 内存占用: 2.57GB
分块策略: 块大小=7, 预计块数=27
创建了 27 个处理块，每块约 7 切片
后处理进度: 6/27 块 (22.2%)
后处理进度: 12/27 块 (44.4%)
后处理进度: 18/27 块 (66.7%)
后处理进度: 24/27 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.71s
处理完成后内存: 1.58GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.61s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.07s
Case FLARETs_0117_0000.nii.gz completed in 13.65s total (preprocess: 3.01s, inference: 6.57s, postprocess: 4.07s)
Step 4/4: Ready for next case...

=== Processing case 118/200: FLARETs_0118_0000.nii.gz ===
File FLARETs_0118_0000.nii.gz: 100.41 MB
Total file size: 100.41 MB
⚠️  File size (100.41 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0118.nii.gz with shape (512, 512, 397)
✅ Dummy results generated: FLARETs_0118.nii.gz
Case FLARETs_0118_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 119/200: FLARETs_0119_0000.nii.gz ===
File FLARETs_0119_0000.nii.gz: 88.40 MB
Total file size: 88.40 MB
⚠️  File size (88.40 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0119.nii.gz with shape (512, 512, 340)
✅ Dummy results generated: FLARETs_0119.nii.gz
Case FLARETs_0119_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 120/200: FLARETs_0120_0000.nii.gz ===
File FLARETs_0120_0000.nii.gz: 86.75 MB
Total file size: 86.75 MB
⚠️  File size (86.75 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0120.nii.gz with shape (512, 512, 326)
✅ Dummy results generated: FLARETs_0120.nii.gz
Case FLARETs_0120_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 121/200: FLARETs_0121_0000.nii.gz ===
File FLARETs_0121_0000.nii.gz: 87.03 MB
Total file size: 87.03 MB
⚠️  File size (87.03 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0121.nii.gz with shape (512, 512, 307)
✅ Dummy results generated: FLARETs_0121.nii.gz
Case FLARETs_0121_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 122/200: FLARETs_0122_0000.nii.gz ===
File FLARETs_0122_0000.nii.gz: 74.24 MB
Total file size: 74.24 MB
⚠️  File size (74.24 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0122.nii.gz with shape (512, 512, 273)
✅ Dummy results generated: FLARETs_0122.nii.gz
Case FLARETs_0122_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 123/200: FLARETs_0123_0000.nii.gz ===
File FLARETs_0123_0000.nii.gz: 85.27 MB
Total file size: 85.27 MB
⚠️  File size (85.27 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0123.nii.gz with shape (512, 512, 328)
✅ Dummy results generated: FLARETs_0123.nii.gz
Case FLARETs_0123_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 124/200: FLARETs_0124_0000.nii.gz ===
File FLARETs_0124_0000.nii.gz: 82.33 MB
Total file size: 82.33 MB
⚠️  File size (82.33 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0124.nii.gz with shape (512, 512, 294)
✅ Dummy results generated: FLARETs_0124.nii.gz
Case FLARETs_0124_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 125/200: FLARETs_0125_0000.nii.gz ===
File FLARETs_0125_0000.nii.gz: 75.16 MB
Total file size: 75.16 MB
⚠️  File size (75.16 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0125.nii.gz with shape (512, 512, 261)
✅ Dummy results generated: FLARETs_0125.nii.gz
Case FLARETs_0125_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 126/200: FLARETs_0126_0000.nii.gz ===
File FLARETs_0126_0000.nii.gz: 91.60 MB
Total file size: 91.60 MB
⚠️  File size (91.60 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0126.nii.gz with shape (512, 512, 322)
✅ Dummy results generated: FLARETs_0126.nii.gz
Case FLARETs_0126_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 127/200: FLARETs_0127_0000.nii.gz ===
File FLARETs_0127_0000.nii.gz: 40.50 MB
Total file size: 40.50 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.26s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.07it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.05it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.05it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.04it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.05it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.05it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.05it/s] 50%|█████     | 8/16 [00:02<00:02,  3.04it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.04it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.05it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.03it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.03it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.02it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.04it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.03it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]100%|██████████| 16/16 [00:05<00:00,  3.04it/s]
Inference completed in 5.30s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.56GB
输入形状: (14, 169, 183, 183)
目标形状: (141, 512, 512)
预估内存需求: 1.93GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.834319526627219, 2.797814207650273, 2.797814207650273]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.17s
重采样后内存: 3.49GB (增加: 1.93GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 141, 512, 512), 内存占用: 1.93GB
分块策略: 块大小=8, 预计块数=18
创建了 18 个处理块，每块约 8 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.60s
处理完成后内存: 1.56GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.80s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.22s
Case FLARETs_0127_0000.nii.gz completed in 10.79s total (preprocess: 2.26s, inference: 5.30s, postprocess: 3.22s)
Step 4/4: Ready for next case...

=== Processing case 128/200: FLARETs_0128_0000.nii.gz ===
File FLARETs_0128_0000.nii.gz: 44.12 MB
Total file size: 44.12 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.62s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.89it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.92it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.92it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.91it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.91it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.94it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.94it/s] 50%|█████     | 8/16 [00:02<00:02,  2.92it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.92it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.89it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.89it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.89it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.92it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.92it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.92it/s]100%|██████████| 16/16 [00:05<00:00,  2.92it/s]100%|██████████| 16/16 [00:05<00:00,  2.91it/s]
Inference completed in 5.53s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.62GB
输入形状: (14, 187, 191, 191)
目标形状: (156, 512, 512)
预估内存需求: 2.13GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8342245989304813, 2.680628272251309, 2.680628272251309]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.45s
重采样后内存: 3.75GB (增加: 2.13GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 156, 512, 512), 内存占用: 2.13GB
分块策略: 块大小=6, 预计块数=26
创建了 26 个处理块，每块约 6 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.62GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.08s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.53s
Case FLARETs_0128_0000.nii.gz completed in 11.67s total (preprocess: 2.62s, inference: 5.53s, postprocess: 3.53s)
Step 4/4: Ready for next case...

=== Processing case 129/200: FLARETs_0129_0000.nii.gz ===
File FLARETs_0129_0000.nii.gz: 130.01 MB
Total file size: 130.01 MB
⚠️  File size (130.01 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0129.nii.gz with shape (512, 512, 533)
✅ Dummy results generated: FLARETs_0129.nii.gz
Case FLARETs_0129_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 130/200: FLARETs_0130_0000.nii.gz ===
File FLARETs_0130_0000.nii.gz: 119.69 MB
Total file size: 119.69 MB
⚠️  File size (119.69 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0130.nii.gz with shape (512, 512, 378)
✅ Dummy results generated: FLARETs_0130.nii.gz
Case FLARETs_0130_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 131/200: FLARETs_0131_0000.nii.gz ===
File FLARETs_0131_0000.nii.gz: 108.07 MB
Total file size: 108.07 MB
⚠️  File size (108.07 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0131.nii.gz with shape (512, 512, 354)
✅ Dummy results generated: FLARETs_0131.nii.gz
Case FLARETs_0131_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 132/200: FLARETs_0132_0000.nii.gz ===
File FLARETs_0132_0000.nii.gz: 118.33 MB
Total file size: 118.33 MB
⚠️  File size (118.33 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0132.nii.gz with shape (512, 512, 361)
✅ Dummy results generated: FLARETs_0132.nii.gz
Case FLARETs_0132_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 133/200: FLARETs_0133_0000.nii.gz ===
File FLARETs_0133_0000.nii.gz: 93.94 MB
Total file size: 93.94 MB
⚠️  File size (93.94 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0133.nii.gz with shape (512, 512, 323)
✅ Dummy results generated: FLARETs_0133.nii.gz
Case FLARETs_0133_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 134/200: FLARETs_0134_0000.nii.gz ===
File FLARETs_0134_0000.nii.gz: 148.42 MB
Total file size: 148.42 MB
⚠️  File size (148.42 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0134.nii.gz with shape (512, 512, 597)
✅ Dummy results generated: FLARETs_0134.nii.gz
Case FLARETs_0134_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 135/200: FLARETs_0135_0000.nii.gz ===
File FLARETs_0135_0000.nii.gz: 96.71 MB
Total file size: 96.71 MB
⚠️  File size (96.71 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0135.nii.gz with shape (512, 512, 316)
✅ Dummy results generated: FLARETs_0135.nii.gz
Case FLARETs_0135_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 136/200: FLARETs_0136_0000.nii.gz ===
File FLARETs_0136_0000.nii.gz: 145.40 MB
Total file size: 145.40 MB
⚠️  File size (145.40 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0136.nii.gz with shape (512, 512, 618)
✅ Dummy results generated: FLARETs_0136.nii.gz
Case FLARETs_0136_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 137/200: FLARETs_0137_0000.nii.gz ===
File FLARETs_0137_0000.nii.gz: 105.41 MB
Total file size: 105.41 MB
⚠️  File size (105.41 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0137.nii.gz with shape (512, 512, 355)
✅ Dummy results generated: FLARETs_0137.nii.gz
Case FLARETs_0137_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 138/200: FLARETs_0138_0000.nii.gz ===
File FLARETs_0138_0000.nii.gz: 105.07 MB
Total file size: 105.07 MB
⚠️  File size (105.07 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0138.nii.gz with shape (512, 512, 352)
✅ Dummy results generated: FLARETs_0138.nii.gz
Case FLARETs_0138_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 139/200: FLARETs_0139_0000.nii.gz ===
File FLARETs_0139_0000.nii.gz: 105.25 MB
Total file size: 105.25 MB
⚠️  File size (105.25 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0139.nii.gz with shape (512, 512, 314)
✅ Dummy results generated: FLARETs_0139.nii.gz
Case FLARETs_0139_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 140/200: FLARETs_0140_0000.nii.gz ===
File FLARETs_0140_0000.nii.gz: 122.65 MB
Total file size: 122.65 MB
⚠️  File size (122.65 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0140.nii.gz with shape (512, 512, 517)
✅ Dummy results generated: FLARETs_0140.nii.gz
Case FLARETs_0140_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 141/200: FLARETs_0141_0000.nii.gz ===
File FLARETs_0141_0000.nii.gz: 93.51 MB
Total file size: 93.51 MB
⚠️  File size (93.51 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0141.nii.gz with shape (512, 512, 315)
✅ Dummy results generated: FLARETs_0141.nii.gz
Case FLARETs_0141_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 142/200: FLARETs_0142_0000.nii.gz ===
File FLARETs_0142_0000.nii.gz: 94.66 MB
Total file size: 94.66 MB
⚠️  File size (94.66 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0142.nii.gz with shape (512, 512, 337)
✅ Dummy results generated: FLARETs_0142.nii.gz
Case FLARETs_0142_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 143/200: FLARETs_0143_0000.nii.gz ===
File FLARETs_0143_0000.nii.gz: 115.52 MB
Total file size: 115.52 MB
⚠️  File size (115.52 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0143.nii.gz with shape (512, 512, 351)
✅ Dummy results generated: FLARETs_0143.nii.gz
Case FLARETs_0143_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 144/200: FLARETs_0144_0000.nii.gz ===
File FLARETs_0144_0000.nii.gz: 99.25 MB
Total file size: 99.25 MB
⚠️  File size (99.25 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0144.nii.gz with shape (512, 512, 366)
✅ Dummy results generated: FLARETs_0144.nii.gz
Case FLARETs_0144_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 145/200: FLARETs_0145_0000.nii.gz ===
File FLARETs_0145_0000.nii.gz: 111.36 MB
Total file size: 111.36 MB
⚠️  File size (111.36 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0145.nii.gz with shape (512, 512, 349)
✅ Dummy results generated: FLARETs_0145.nii.gz
Case FLARETs_0145_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 146/200: FLARETs_0146_0000.nii.gz ===
File FLARETs_0146_0000.nii.gz: 92.57 MB
Total file size: 92.57 MB
⚠️  File size (92.57 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0146.nii.gz with shape (512, 512, 347)
✅ Dummy results generated: FLARETs_0146.nii.gz
Case FLARETs_0146_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 147/200: FLARETs_0147_0000.nii.gz ===
File FLARETs_0147_0000.nii.gz: 145.42 MB
Total file size: 145.42 MB
⚠️  File size (145.42 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0147.nii.gz with shape (512, 512, 621)
✅ Dummy results generated: FLARETs_0147.nii.gz
Case FLARETs_0147_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 148/200: FLARETs_0148_0000.nii.gz ===
File FLARETs_0148_0000.nii.gz: 123.15 MB
Total file size: 123.15 MB
⚠️  File size (123.15 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0148.nii.gz with shape (512, 512, 457)
✅ Dummy results generated: FLARETs_0148.nii.gz
Case FLARETs_0148_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 149/200: FLARETs_0149_0000.nii.gz ===
File FLARETs_0149_0000.nii.gz: 103.90 MB
Total file size: 103.90 MB
⚠️  File size (103.90 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0149.nii.gz with shape (512, 512, 318)
✅ Dummy results generated: FLARETs_0149.nii.gz
Case FLARETs_0149_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 150/200: FLARETs_0150_0000.nii.gz ===
File FLARETs_0150_0000.nii.gz: 107.31 MB
Total file size: 107.31 MB
⚠️  File size (107.31 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0150.nii.gz with shape (512, 512, 457)
✅ Dummy results generated: FLARETs_0150.nii.gz
Case FLARETs_0150_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 151/200: FLARETs_0151_0000.nii.gz ===
File FLARETs_0151_0000.nii.gz: 96.98 MB
Total file size: 96.98 MB
⚠️  File size (96.98 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0151.nii.gz with shape (512, 512, 331)
✅ Dummy results generated: FLARETs_0151.nii.gz
Case FLARETs_0151_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 152/200: FLARETs_0152_0000.nii.gz ===
File FLARETs_0152_0000.nii.gz: 96.58 MB
Total file size: 96.58 MB
⚠️  File size (96.58 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0152.nii.gz with shape (512, 512, 346)
✅ Dummy results generated: FLARETs_0152.nii.gz
Case FLARETs_0152_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 153/200: FLARETs_0153_0000.nii.gz ===
File FLARETs_0153_0000.nii.gz: 127.84 MB
Total file size: 127.84 MB
⚠️  File size (127.84 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0153.nii.gz with shape (512, 512, 521)
✅ Dummy results generated: FLARETs_0153.nii.gz
Case FLARETs_0153_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 154/200: FLARETs_0154_0000.nii.gz ===
File FLARETs_0154_0000.nii.gz: 140.19 MB
Total file size: 140.19 MB
⚠️  File size (140.19 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0154.nii.gz with shape (512, 512, 521)
✅ Dummy results generated: FLARETs_0154.nii.gz
Case FLARETs_0154_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 155/200: FLARETs_0155_0000.nii.gz ===
File FLARETs_0155_0000.nii.gz: 110.66 MB
Total file size: 110.66 MB
⚠️  File size (110.66 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0155.nii.gz with shape (512, 512, 389)
✅ Dummy results generated: FLARETs_0155.nii.gz
Case FLARETs_0155_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 156/200: FLARETs_0156_0000.nii.gz ===
File FLARETs_0156_0000.nii.gz: 89.16 MB
Total file size: 89.16 MB
⚠️  File size (89.16 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0156.nii.gz with shape (512, 512, 274)
✅ Dummy results generated: FLARETs_0156.nii.gz
Case FLARETs_0156_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 157/200: FLARETs_0157_0000.nii.gz ===
File FLARETs_0157_0000.nii.gz: 98.04 MB
Total file size: 98.04 MB
⚠️  File size (98.04 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0157.nii.gz with shape (512, 512, 287)
✅ Dummy results generated: FLARETs_0157.nii.gz
Case FLARETs_0157_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 158/200: FLARETs_0158_0000.nii.gz ===
File FLARETs_0158_0000.nii.gz: 39.74 MB
Total file size: 39.74 MB
Step 1/4: Preprocessing...
Preprocessing completed in 3.12s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.00it/s]  4%|▍         | 2/45 [00:00<00:14,  3.03it/s]  7%|▋         | 3/45 [00:00<00:14,  3.00it/s]  9%|▉         | 4/45 [00:01<00:13,  3.00it/s] 11%|█         | 5/45 [00:01<00:13,  3.00it/s] 13%|█▎        | 6/45 [00:01<00:13,  3.00it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.01it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.01it/s] 20%|██        | 9/45 [00:02<00:11,  3.02it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.03it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.02it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.03it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.04it/s] 31%|███       | 14/45 [00:04<00:10,  3.06it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.05it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.03it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.04it/s] 40%|████      | 18/45 [00:05<00:08,  3.04it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.04it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.04it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.04it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.04it/s] 51%|█████     | 23/45 [00:07<00:07,  3.04it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.05it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.06it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.05it/s] 60%|██████    | 27/45 [00:08<00:05,  3.04it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.06it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.06it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.05it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.04it/s] 71%|███████   | 32/45 [00:10<00:04,  3.05it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.04it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.05it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.05it/s] 80%|████████  | 36/45 [00:11<00:02,  3.04it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.04it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.04it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.03it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.04it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.04it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.03it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.03it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.02it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]100%|██████████| 45/45 [00:14<00:00,  3.03it/s]
Inference completed in 14.89s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.66GB
输入形状: (14, 212, 233, 233)
目标形状: (141, 512, 512)
预估内存需求: 1.93GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.6650943396226415, 2.1974248927038627, 2.1974248927038627]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.17s
重采样后内存: 3.59GB (增加: 1.93GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 141, 512, 512), 内存占用: 1.93GB
分块策略: 块大小=8, 预计块数=18
创建了 18 个处理块，每块约 8 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.58s
处理完成后内存: 1.70GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.78s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.33s
Case FLARETs_0158_0000.nii.gz completed in 21.33s total (preprocess: 3.12s, inference: 14.89s, postprocess: 3.33s)
Step 4/4: Ready for next case...

=== Processing case 159/200: FLARETs_0159_0000.nii.gz ===
File FLARETs_0159_0000.nii.gz: 43.27 MB
Total file size: 43.27 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.62s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.07it/s]  6%|▌         | 2/36 [00:00<00:11,  3.02it/s]  8%|▊         | 3/36 [00:00<00:10,  3.00it/s] 11%|█         | 4/36 [00:01<00:10,  3.05it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.07it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.07it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.07it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.05it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.06it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.05it/s] 31%|███       | 11/36 [00:03<00:08,  3.06it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.06it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.08it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.10it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.10it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.08it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.09it/s] 50%|█████     | 18/36 [00:05<00:05,  3.11it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.10it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.09it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.11it/s] 61%|██████    | 22/36 [00:07<00:04,  3.09it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.07it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.08it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.10it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.11it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.10it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.08it/s] 81%|████████  | 29/36 [00:09<00:02,  3.07it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.07it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.08it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.11it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.07it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.03it/s] 97%|█████████▋| 35/36 [00:11<00:00,  2.98it/s]100%|██████████| 36/36 [00:11<00:00,  2.94it/s]100%|██████████| 36/36 [00:11<00:00,  3.06it/s]
Inference completed in 11.80s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.54GB
输入形状: (14, 182, 200, 200)
目标形状: (152, 512, 512)
预估内存需求: 2.08GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8351648351648352, 2.56, 2.56]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.48s
重采样后内存: 3.61GB (增加: 2.08GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 152, 512, 512), 内存占用: 2.08GB
分块策略: 块大小=6, 预计块数=26
创建了 26 个处理块，每块约 6 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.60s
处理完成后内存: 1.63GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.12s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.60s
Case FLARETs_0159_0000.nii.gz completed in 18.01s total (preprocess: 2.62s, inference: 11.80s, postprocess: 3.60s)
Step 4/4: Ready for next case...

=== Processing case 160/200: FLARETs_0160_0000.nii.gz ===
File FLARETs_0160_0000.nii.gz: 29.83 MB
Total file size: 29.83 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.27s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:02,  2.96it/s] 25%|██▌       | 2/8 [00:00<00:02,  2.95it/s] 38%|███▊      | 3/8 [00:01<00:01,  2.97it/s] 50%|█████     | 4/8 [00:01<00:01,  2.99it/s] 62%|██████▎   | 5/8 [00:01<00:01,  2.99it/s] 75%|███████▌  | 6/8 [00:02<00:00,  2.99it/s] 88%|████████▊ | 7/8 [00:02<00:00,  3.01it/s]100%|██████████| 8/8 [00:02<00:00,  3.01it/s]100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
Inference completed in 2.70s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.42GB
输入形状: (14, 104, 188, 188)
目标形状: (104, 512, 512)
预估内存需求: 1.42GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.723404255319149, 2.723404255319149]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.63s
重采样后内存: 2.84GB (增加: 1.42GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 104, 512, 512), 内存占用: 1.42GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.43s
处理完成后内存: 1.47GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.10s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.47s
Case FLARETs_0160_0000.nii.gz completed in 6.44s total (preprocess: 1.27s, inference: 2.70s, postprocess: 2.47s)
Step 4/4: Ready for next case...

=== Processing case 161/200: FLARETs_0161_0000.nii.gz ===
File FLARETs_0161_0000.nii.gz: 56.53 MB
Total file size: 56.53 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.38s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.95it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.94it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.95it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.96it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.97it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.97it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.97it/s] 50%|█████     | 8/16 [00:02<00:02,  2.98it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.98it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.99it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.98it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.98it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.98it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.97it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.97it/s]100%|██████████| 16/16 [00:05<00:00,  2.97it/s]100%|██████████| 16/16 [00:05<00:00,  2.97it/s]
Inference completed in 5.42s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.49GB
输入形状: (14, 195, 182, 182)
目标形状: (195, 512, 512)
预估内存需求: 2.67GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.8131868131868134, 2.8131868131868134]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.03s
重采样后内存: 4.16GB (增加: 2.67GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 195, 512, 512), 内存占用: 2.67GB
分块策略: 块大小=8, 预计块数=25
创建了 25 个处理块，每块约 8 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.69s
处理完成后内存: 1.54GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 3.77s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.21s
Case FLARETs_0161_0000.nii.gz completed in 12.00s total (preprocess: 2.38s, inference: 5.42s, postprocess: 4.21s)
Step 4/4: Ready for next case...

=== Processing case 162/200: FLARETs_0162_0000.nii.gz ===
File FLARETs_0162_0000.nii.gz: 43.53 MB
Total file size: 43.53 MB
Step 1/4: Preprocessing...
Preprocessing completed in 4.70s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.98it/s]  6%|▌         | 2/36 [00:00<00:11,  3.00it/s]  8%|▊         | 3/36 [00:01<00:11,  2.99it/s] 11%|█         | 4/36 [00:01<00:10,  3.00it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.00it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.01it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.01it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.02it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.02it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.03it/s] 31%|███       | 11/36 [00:03<00:08,  3.01it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.00it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.00it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.01it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.02it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.01it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.00it/s] 50%|█████     | 18/36 [00:05<00:05,  3.00it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.00it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.01it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.00it/s] 61%|██████    | 22/36 [00:07<00:04,  3.00it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.01it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.01it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.01it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.02it/s] 75%|███████▌  | 27/36 [00:08<00:03,  3.00it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.00it/s] 81%|████████  | 29/36 [00:09<00:02,  3.01it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.01it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.00it/s] 89%|████████▉ | 32/36 [00:10<00:01,  2.99it/s] 92%|█████████▏| 33/36 [00:10<00:01,  2.99it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.00it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.00it/s]100%|██████████| 36/36 [00:11<00:00,  3.03it/s]100%|██████████| 36/36 [00:11<00:00,  3.01it/s]
Inference completed in 12.01s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.58GB
输入形状: (14, 177, 221, 221)
目标形状: (177, 512, 512)
预估内存需求: 2.42GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.316742081447964, 2.316742081447964]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.72s
重采样后内存: 4.00GB (增加: 2.42GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 177, 512, 512), 内存占用: 2.42GB
分块策略: 块大小=7, 预计块数=26
创建了 26 个处理块，每块约 7 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.68s
处理完成后内存: 1.62GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.45s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.93s
Case FLARETs_0162_0000.nii.gz completed in 20.65s total (preprocess: 4.70s, inference: 12.01s, postprocess: 3.93s)
Step 4/4: Ready for next case...

=== Processing case 163/200: FLARETs_0163_0000.nii.gz ===
File FLARETs_0163_0000.nii.gz: 36.60 MB
Total file size: 36.60 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.95s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.94it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.00it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.98it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.98it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.98it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.99it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.99it/s] 50%|█████     | 8/16 [00:02<00:02,  2.99it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.99it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.99it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.00it/s] 75%|███████▌  | 12/16 [00:04<00:01,  3.00it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.99it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.00it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.99it/s]100%|██████████| 16/16 [00:05<00:00,  2.99it/s]100%|██████████| 16/16 [00:05<00:00,  2.99it/s]
Inference completed in 5.38s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.47GB
输入形状: (14, 161, 173, 173)
目标形状: (115, 512, 512)
预估内存需求: 1.57GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.7142857142857143, 2.959537572254335, 2.959537572254335]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.79s
重采样后内存: 3.04GB (增加: 1.57GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 115, 512, 512), 内存占用: 1.57GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.43s
处理完成后内存: 1.47GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.26s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.66s
Case FLARETs_0163_0000.nii.gz completed in 9.99s total (preprocess: 1.95s, inference: 5.38s, postprocess: 2.66s)
Step 4/4: Ready for next case...

=== Processing case 164/200: FLARETs_0164_0000.nii.gz ===
File FLARETs_0164_0000.nii.gz: 34.24 MB
Total file size: 34.24 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.61s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  2.95it/s]  4%|▍         | 2/45 [00:00<00:14,  2.96it/s]  7%|▋         | 3/45 [00:01<00:14,  2.95it/s]  9%|▉         | 4/45 [00:01<00:13,  2.97it/s] 11%|█         | 5/45 [00:01<00:13,  2.96it/s] 13%|█▎        | 6/45 [00:02<00:13,  2.89it/s] 16%|█▌        | 7/45 [00:02<00:13,  2.90it/s] 18%|█▊        | 8/45 [00:02<00:12,  2.93it/s] 20%|██        | 9/45 [00:03<00:12,  2.94it/s] 22%|██▏       | 10/45 [00:03<00:11,  2.94it/s] 24%|██▍       | 11/45 [00:03<00:11,  2.96it/s] 27%|██▋       | 12/45 [00:04<00:11,  2.96it/s] 29%|██▉       | 13/45 [00:04<00:10,  2.96it/s] 31%|███       | 14/45 [00:04<00:10,  2.92it/s] 33%|███▎      | 15/45 [00:05<00:10,  2.88it/s] 36%|███▌      | 16/45 [00:05<00:10,  2.85it/s] 38%|███▊      | 17/45 [00:05<00:09,  2.84it/s] 40%|████      | 18/45 [00:06<00:09,  2.83it/s] 42%|████▏     | 19/45 [00:06<00:09,  2.81it/s] 44%|████▍     | 20/45 [00:06<00:08,  2.81it/s] 47%|████▋     | 21/45 [00:07<00:08,  2.82it/s] 49%|████▉     | 22/45 [00:07<00:08,  2.85it/s] 51%|█████     | 23/45 [00:07<00:07,  2.83it/s] 53%|█████▎    | 24/45 [00:08<00:07,  2.81it/s] 56%|█████▌    | 25/45 [00:08<00:07,  2.79it/s] 58%|█████▊    | 26/45 [00:09<00:06,  2.79it/s] 60%|██████    | 27/45 [00:09<00:06,  2.79it/s] 62%|██████▏   | 28/45 [00:09<00:06,  2.80it/s] 64%|██████▍   | 29/45 [00:10<00:05,  2.79it/s] 67%|██████▋   | 30/45 [00:10<00:05,  2.78it/s] 69%|██████▉   | 31/45 [00:10<00:05,  2.78it/s] 71%|███████   | 32/45 [00:11<00:04,  2.79it/s] 73%|███████▎  | 33/45 [00:11<00:04,  2.78it/s] 76%|███████▌  | 34/45 [00:11<00:03,  2.81it/s] 78%|███████▊  | 35/45 [00:12<00:03,  2.82it/s] 80%|████████  | 36/45 [00:12<00:03,  2.83it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.82it/s] 84%|████████▍ | 38/45 [00:13<00:02,  2.82it/s] 87%|████████▋ | 39/45 [00:13<00:02,  2.83it/s] 89%|████████▉ | 40/45 [00:14<00:01,  2.83it/s] 91%|█████████ | 41/45 [00:14<00:01,  2.83it/s] 93%|█████████▎| 42/45 [00:14<00:01,  2.84it/s] 96%|█████████▌| 43/45 [00:15<00:00,  2.84it/s] 98%|█████████▊| 44/45 [00:15<00:00,  2.86it/s]100%|██████████| 45/45 [00:15<00:00,  2.89it/s]100%|██████████| 45/45 [00:15<00:00,  2.85it/s]
Inference completed in 15.83s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.64GB
输入形状: (14, 228, 216, 216)
目标形状: (114, 512, 512)
预估内存需求: 1.56GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.3703703703703702, 2.3703703703703702]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.77s
重采样后内存: 3.20GB (增加: 1.56GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 114, 512, 512), 内存占用: 1.56GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.41s
处理完成后内存: 1.69GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.21s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.73s
Case FLARETs_0164_0000.nii.gz completed in 21.17s total (preprocess: 2.61s, inference: 15.83s, postprocess: 2.73s)
Step 4/4: Ready for next case...

=== Processing case 165/200: FLARETs_0165_0000.nii.gz ===
File FLARETs_0165_0000.nii.gz: 33.00 MB
Total file size: 33.00 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.00s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  2.92it/s]  6%|▌         | 2/36 [00:00<00:11,  2.95it/s]  8%|▊         | 3/36 [00:01<00:11,  2.97it/s] 11%|█         | 4/36 [00:01<00:10,  2.99it/s] 14%|█▍        | 5/36 [00:01<00:10,  2.98it/s] 17%|█▋        | 6/36 [00:02<00:10,  2.99it/s] 19%|█▉        | 7/36 [00:02<00:09,  2.99it/s] 22%|██▏       | 8/36 [00:02<00:09,  2.98it/s] 25%|██▌       | 9/36 [00:03<00:09,  2.99it/s] 28%|██▊       | 10/36 [00:03<00:08,  2.98it/s] 31%|███       | 11/36 [00:03<00:08,  2.98it/s] 33%|███▎      | 12/36 [00:04<00:08,  2.99it/s] 36%|███▌      | 13/36 [00:04<00:07,  2.99it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.00it/s] 42%|████▏     | 15/36 [00:05<00:07,  3.00it/s] 44%|████▍     | 16/36 [00:05<00:06,  2.99it/s] 47%|████▋     | 17/36 [00:05<00:06,  2.98it/s] 50%|█████     | 18/36 [00:06<00:06,  2.99it/s] 53%|█████▎    | 19/36 [00:06<00:05,  2.98it/s] 56%|█████▌    | 20/36 [00:06<00:05,  2.98it/s] 58%|█████▊    | 21/36 [00:07<00:05,  2.99it/s] 61%|██████    | 22/36 [00:07<00:04,  3.00it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.01it/s] 67%|██████▋   | 24/36 [00:08<00:03,  3.01it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.02it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.01it/s] 75%|███████▌  | 27/36 [00:09<00:02,  3.00it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.01it/s] 81%|████████  | 29/36 [00:09<00:02,  3.00it/s] 83%|████████▎ | 30/36 [00:10<00:01,  3.01it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.02it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.02it/s] 92%|█████████▏| 33/36 [00:11<00:00,  3.00it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.00it/s] 97%|█████████▋| 35/36 [00:11<00:00,  2.98it/s]100%|██████████| 36/36 [00:12<00:00,  2.99it/s]100%|██████████| 36/36 [00:12<00:00,  2.99it/s]
Inference completed in 12.07s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.52GB
输入形状: (14, 171, 197, 197)
目标形状: (107, 512, 512)
预估内存需求: 1.46GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.6257309941520468, 2.598984771573604, 2.598984771573604]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.67s
重采样后内存: 2.98GB (增加: 1.46GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 107, 512, 512), 内存占用: 1.46GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.52GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.14s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.57s
Case FLARETs_0165_0000.nii.gz completed in 16.64s total (preprocess: 2.00s, inference: 12.07s, postprocess: 2.57s)
Step 4/4: Ready for next case...

=== Processing case 166/200: FLARETs_0166_0000.nii.gz ===
File FLARETs_0166_0000.nii.gz: 43.29 MB
Total file size: 43.29 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.31s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.95it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.93it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.95it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.95it/s] 31%|███▏      | 5/16 [00:01<00:03,  2.94it/s] 38%|███▊      | 6/16 [00:02<00:03,  2.96it/s] 44%|████▍     | 7/16 [00:02<00:03,  2.97it/s] 50%|█████     | 8/16 [00:02<00:02,  2.98it/s] 56%|█████▋    | 9/16 [00:03<00:02,  2.98it/s] 62%|██████▎   | 10/16 [00:03<00:02,  2.97it/s] 69%|██████▉   | 11/16 [00:03<00:01,  2.97it/s] 75%|███████▌  | 12/16 [00:04<00:01,  2.97it/s] 81%|████████▏ | 13/16 [00:04<00:01,  2.96it/s] 88%|████████▊ | 14/16 [00:04<00:00,  2.96it/s] 94%|█████████▍| 15/16 [00:05<00:00,  2.97it/s]100%|██████████| 16/16 [00:05<00:00,  2.96it/s]100%|██████████| 16/16 [00:05<00:00,  2.96it/s]
Inference completed in 5.43s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.46GB
输入形状: (14, 176, 172, 172)
目标形状: (147, 512, 512)
预估内存需求: 2.01GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8352272727272727, 2.9767441860465116, 2.9767441860465116]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.26s
重采样后内存: 3.47GB (增加: 2.01GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 147, 512, 512), 内存占用: 2.01GB
分块策略: 块大小=6, 预计块数=25
创建了 25 个处理块，每块约 6 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.52s
处理完成后内存: 1.49GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.82s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.23s
Case FLARETs_0166_0000.nii.gz completed in 10.97s total (preprocess: 2.31s, inference: 5.43s, postprocess: 3.23s)
Step 4/4: Ready for next case...

=== Processing case 167/200: FLARETs_0167_0000.nii.gz ===
File FLARETs_0167_0000.nii.gz: 106.11 MB
Total file size: 106.11 MB
⚠️  File size (106.11 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0167.nii.gz with shape (512, 512, 376)
✅ Dummy results generated: FLARETs_0167.nii.gz
Case FLARETs_0167_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 168/200: FLARETs_0168_0000.nii.gz ===
File FLARETs_0168_0000.nii.gz: 41.66 MB
Total file size: 41.66 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.70s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.03it/s]  6%|▌         | 2/36 [00:00<00:11,  3.05it/s]  8%|▊         | 3/36 [00:00<00:10,  3.04it/s] 11%|█         | 4/36 [00:01<00:10,  3.05it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.05it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.06it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.03it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.01it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.00it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.02it/s] 31%|███       | 11/36 [00:03<00:08,  3.02it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.02it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.01it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.02it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.02it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.03it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.01it/s] 50%|█████     | 18/36 [00:05<00:05,  3.03it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.02it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.01it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.00it/s] 61%|██████    | 22/36 [00:07<00:04,  3.02it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.01it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.02it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.03it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.03it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.03it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.03it/s] 81%|████████  | 29/36 [00:09<00:02,  3.02it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.03it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.03it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.03it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.01it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.01it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.01it/s]100%|██████████| 36/36 [00:11<00:00,  3.02it/s]100%|██████████| 36/36 [00:11<00:00,  3.02it/s]
Inference completed in 11.96s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.59GB
输入形状: (14, 200, 211, 211)
目标形状: (133, 512, 512)
预估内存需求: 1.82GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.665, 2.4265402843601898, 2.4265402843601898]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.06s
重采样后内存: 3.41GB (增加: 1.82GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 133, 512, 512), 内存占用: 1.82GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.53s
处理完成后内存: 1.62GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.63s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.12s
Case FLARETs_0168_0000.nii.gz completed in 17.78s total (preprocess: 2.70s, inference: 11.96s, postprocess: 3.12s)
Step 4/4: Ready for next case...

=== Processing case 169/200: FLARETs_0169_0000.nii.gz ===
File FLARETs_0169_0000.nii.gz: 54.40 MB
Total file size: 54.40 MB
Step 1/4: Preprocessing...
Preprocessing completed in 4.81s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:12,  2.82it/s]  6%|▌         | 2/36 [00:00<00:11,  2.85it/s]  8%|▊         | 3/36 [00:01<00:11,  2.86it/s] 11%|█         | 4/36 [00:01<00:11,  2.85it/s] 14%|█▍        | 5/36 [00:01<00:10,  2.85it/s] 17%|█▋        | 6/36 [00:02<00:10,  2.85it/s] 19%|█▉        | 7/36 [00:02<00:10,  2.89it/s] 22%|██▏       | 8/36 [00:02<00:09,  2.92it/s] 25%|██▌       | 9/36 [00:03<00:09,  2.95it/s] 28%|██▊       | 10/36 [00:03<00:08,  2.97it/s] 31%|███       | 11/36 [00:03<00:08,  2.97it/s] 33%|███▎      | 12/36 [00:04<00:08,  2.98it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.00it/s] 39%|███▉      | 14/36 [00:04<00:07,  2.99it/s] 42%|████▏     | 15/36 [00:05<00:07,  2.99it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.00it/s] 47%|████▋     | 17/36 [00:05<00:06,  2.98it/s] 50%|█████     | 18/36 [00:06<00:06,  3.00it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.01it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.01it/s] 58%|█████▊    | 21/36 [00:07<00:04,  3.01it/s] 61%|██████    | 22/36 [00:07<00:04,  3.01it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.01it/s] 67%|██████▋   | 24/36 [00:08<00:03,  3.01it/s] 69%|██████▉   | 25/36 [00:08<00:03,  2.99it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.00it/s] 75%|███████▌  | 27/36 [00:09<00:03,  2.99it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.00it/s] 81%|████████  | 29/36 [00:09<00:02,  3.01it/s] 83%|████████▎ | 30/36 [00:10<00:01,  3.02it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.02it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.03it/s] 92%|█████████▏| 33/36 [00:11<00:00,  3.02it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.02it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.02it/s]100%|██████████| 36/36 [00:12<00:00,  3.03it/s]100%|██████████| 36/36 [00:12<00:00,  2.98it/s]
Inference completed in 12.13s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.61GB
输入形状: (14, 173, 214, 214)
目标形状: (173, 512, 512)
预估内存需求: 2.37GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 2.392523364485981, 2.392523364485981]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.73s
重采样后内存: 3.92GB (增加: 2.32GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 173, 512, 512), 内存占用: 2.37GB
分块策略: 块大小=7, 预计块数=25
创建了 25 个处理块，每块约 7 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.65s
处理完成后内存: 1.60GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.42s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.89s
Case FLARETs_0169_0000.nii.gz completed in 20.82s total (preprocess: 4.81s, inference: 12.13s, postprocess: 3.89s)
Step 4/4: Ready for next case...

=== Processing case 170/200: FLARETs_0170_0000.nii.gz ===
File FLARETs_0170_0000.nii.gz: 46.32 MB
Total file size: 46.32 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.61s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.03it/s] 12%|█▎        | 2/16 [00:00<00:04,  3.01it/s] 19%|█▉        | 3/16 [00:00<00:04,  3.02it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.02it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.01it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.02it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.02it/s] 50%|█████     | 8/16 [00:02<00:02,  3.01it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.02it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.02it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.03it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.02it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.03it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.04it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.02it/s]100%|██████████| 16/16 [00:05<00:00,  3.03it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]
Inference completed in 5.33s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.48GB
输入形状: (14, 196, 178, 178)
目标形状: (163, 512, 512)
预估内存需求: 2.23GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8316326530612245, 2.8764044943820224, 2.8764044943820224]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.52s
重采样后内存: 3.71GB (增加: 2.23GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 163, 512, 512), 内存占用: 2.23GB
分块策略: 块大小=6, 预计块数=28
创建了 28 个处理块，每块约 6 切片
后处理进度: 7/28 块 (25.0%)
后处理进度: 14/28 块 (50.0%)
后处理进度: 21/28 块 (75.0%)
后处理进度: 28/28 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.60s
处理完成后内存: 1.46GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 3.16s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.59s
Case FLARETs_0170_0000.nii.gz completed in 11.53s total (preprocess: 2.61s, inference: 5.33s, postprocess: 3.59s)
Step 4/4: Ready for next case...

=== Processing case 171/200: FLARETs_0171_0000.nii.gz ===
File FLARETs_0171_0000.nii.gz: 34.75 MB
Total file size: 34.75 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.43s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.05it/s]  6%|▌         | 2/36 [00:00<00:11,  3.05it/s]  8%|▊         | 3/36 [00:00<00:10,  3.03it/s] 11%|█         | 4/36 [00:01<00:10,  3.04it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.03it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.04it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.04it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.01it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.02it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.03it/s] 31%|███       | 11/36 [00:03<00:08,  3.03it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.02it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.01it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.00it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.01it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.01it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.01it/s] 50%|█████     | 18/36 [00:05<00:05,  3.02it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.03it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.03it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.02it/s] 61%|██████    | 22/36 [00:07<00:04,  3.01it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.01it/s] 67%|██████▋   | 24/36 [00:07<00:04,  3.00it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.01it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.02it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.02it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.02it/s] 81%|████████  | 29/36 [00:09<00:02,  3.02it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.00it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.01it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.01it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.02it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.02it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.02it/s]100%|██████████| 36/36 [00:11<00:00,  3.02it/s]100%|██████████| 36/36 [00:11<00:00,  3.02it/s]
Inference completed in 11.96s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.47GB
输入形状: (14, 172, 200, 200)
目标形状: (143, 512, 512)
预估内存需求: 1.96GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.8313953488372093, 2.56, 2.56]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.25s
重采样后内存: 3.42GB (增加: 1.96GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 143, 512, 512), 内存占用: 1.96GB
分块策略: 块大小=8, 预计块数=18
创建了 18 个处理块，每块约 8 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.59s
处理完成后内存: 1.52GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.88s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.33s
Case FLARETs_0171_0000.nii.gz completed in 17.72s total (preprocess: 2.43s, inference: 11.96s, postprocess: 3.33s)
Step 4/4: Ready for next case...

=== Processing case 172/200: FLARETs_0172_0000.nii.gz ===
File FLARETs_0172_0000.nii.gz: 27.41 MB
Total file size: 27.41 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.42s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.04it/s]  4%|▍         | 2/45 [00:00<00:14,  3.05it/s]  7%|▋         | 3/45 [00:00<00:13,  3.03it/s]  9%|▉         | 4/45 [00:01<00:13,  3.03it/s] 11%|█         | 5/45 [00:01<00:13,  3.02it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.03it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.02it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.02it/s] 20%|██        | 9/45 [00:02<00:11,  3.02it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.03it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.02it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.03it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.03it/s] 31%|███       | 14/45 [00:04<00:10,  3.03it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.03it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.03it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.02it/s] 40%|████      | 18/45 [00:05<00:08,  3.03it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.03it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.02it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.01it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.01it/s] 51%|█████     | 23/45 [00:07<00:07,  3.02it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.02it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.02it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.02it/s] 60%|██████    | 27/45 [00:08<00:05,  3.02it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.02it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.03it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.04it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.04it/s] 71%|███████   | 32/45 [00:10<00:04,  3.05it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.01it/s] 76%|███████▌  | 34/45 [00:11<00:03,  2.96it/s] 78%|███████▊  | 35/45 [00:11<00:03,  2.95it/s] 80%|████████  | 36/45 [00:11<00:03,  2.93it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.92it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.97it/s] 87%|████████▋ | 39/45 [00:12<00:02,  2.96it/s] 89%|████████▉ | 40/45 [00:13<00:01,  2.94it/s] 91%|█████████ | 41/45 [00:13<00:01,  2.91it/s] 93%|█████████▎| 42/45 [00:14<00:01,  2.89it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.88it/s] 98%|█████████▊| 44/45 [00:14<00:00,  2.88it/s]100%|██████████| 45/45 [00:15<00:00,  2.88it/s]100%|██████████| 45/45 [00:15<00:00,  2.99it/s]
Inference completed in 15.11s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.61GB
输入形状: (14, 204, 232, 232)
目标形状: (102, 512, 512)
预估内存需求: 1.39GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.206896551724138, 2.206896551724138]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.70s
重采样后内存: 3.00GB (增加: 1.39GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 102, 512, 512), 内存占用: 1.39GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.61GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.16s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.73s
Case FLARETs_0172_0000.nii.gz completed in 20.26s total (preprocess: 2.42s, inference: 15.11s, postprocess: 2.73s)
Step 4/4: Ready for next case...

=== Processing case 173/200: FLARETs_0173_0000.nii.gz ===
File FLARETs_0173_0000.nii.gz: 37.55 MB
Total file size: 37.55 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.86s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/54 [00:00<?, ?it/s]  2%|▏         | 1/54 [00:00<00:17,  2.99it/s]  4%|▎         | 2/54 [00:00<00:17,  3.02it/s]  6%|▌         | 3/54 [00:00<00:17,  3.00it/s]  7%|▋         | 4/54 [00:01<00:16,  3.01it/s]  9%|▉         | 5/54 [00:01<00:16,  3.00it/s] 11%|█         | 6/54 [00:01<00:16,  3.00it/s] 13%|█▎        | 7/54 [00:02<00:15,  3.01it/s] 15%|█▍        | 8/54 [00:02<00:15,  3.02it/s] 17%|█▋        | 9/54 [00:02<00:14,  3.02it/s] 19%|█▊        | 10/54 [00:03<00:14,  3.02it/s] 20%|██        | 11/54 [00:03<00:14,  3.00it/s] 22%|██▏       | 12/54 [00:03<00:13,  3.01it/s] 24%|██▍       | 13/54 [00:04<00:13,  3.01it/s] 26%|██▌       | 14/54 [00:04<00:13,  3.02it/s] 28%|██▊       | 15/54 [00:04<00:12,  3.02it/s] 30%|██▉       | 16/54 [00:05<00:12,  3.01it/s] 31%|███▏      | 17/54 [00:05<00:12,  3.02it/s] 33%|███▎      | 18/54 [00:05<00:11,  3.03it/s] 35%|███▌      | 19/54 [00:06<00:11,  3.03it/s] 37%|███▋      | 20/54 [00:06<00:11,  3.04it/s] 39%|███▉      | 21/54 [00:06<00:10,  3.04it/s] 41%|████      | 22/54 [00:07<00:10,  3.03it/s] 43%|████▎     | 23/54 [00:07<00:10,  3.05it/s] 44%|████▍     | 24/54 [00:07<00:09,  3.04it/s] 46%|████▋     | 25/54 [00:08<00:09,  3.04it/s] 48%|████▊     | 26/54 [00:08<00:09,  3.04it/s] 50%|█████     | 27/54 [00:08<00:08,  3.04it/s] 52%|█████▏    | 28/54 [00:09<00:08,  3.05it/s] 54%|█████▎    | 29/54 [00:09<00:08,  3.04it/s] 56%|█████▌    | 30/54 [00:09<00:07,  3.05it/s] 57%|█████▋    | 31/54 [00:10<00:07,  3.04it/s] 59%|█████▉    | 32/54 [00:10<00:07,  3.05it/s] 61%|██████    | 33/54 [00:10<00:06,  3.05it/s] 63%|██████▎   | 34/54 [00:11<00:06,  3.04it/s] 65%|██████▍   | 35/54 [00:11<00:06,  3.04it/s] 67%|██████▋   | 36/54 [00:11<00:05,  3.05it/s] 69%|██████▊   | 37/54 [00:12<00:05,  3.03it/s] 70%|███████   | 38/54 [00:12<00:05,  3.03it/s] 72%|███████▏  | 39/54 [00:12<00:04,  3.02it/s] 74%|███████▍  | 40/54 [00:13<00:04,  3.03it/s] 76%|███████▌  | 41/54 [00:13<00:04,  3.03it/s] 78%|███████▊  | 42/54 [00:13<00:03,  3.03it/s] 80%|███████▉  | 43/54 [00:14<00:03,  3.02it/s] 81%|████████▏ | 44/54 [00:14<00:03,  3.02it/s] 83%|████████▎ | 45/54 [00:14<00:02,  3.02it/s] 85%|████████▌ | 46/54 [00:15<00:02,  3.03it/s] 87%|████████▋ | 47/54 [00:15<00:02,  3.03it/s] 89%|████████▉ | 48/54 [00:15<00:01,  3.03it/s] 91%|█████████ | 49/54 [00:16<00:01,  3.03it/s] 93%|█████████▎| 50/54 [00:16<00:01,  3.03it/s] 94%|█████████▍| 51/54 [00:16<00:00,  3.04it/s] 96%|█████████▋| 52/54 [00:17<00:00,  3.02it/s] 98%|█████████▊| 53/54 [00:17<00:00,  3.02it/s]100%|██████████| 54/54 [00:17<00:00,  3.03it/s]100%|██████████| 54/54 [00:17<00:00,  3.03it/s]
Inference completed in 17.89s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.61GB
输入形状: (14, 260, 206, 206)
目标形状: (130, 512, 512)
预估内存需求: 1.78GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.4854368932038833, 2.4854368932038833]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.99s
重采样后内存: 3.39GB (增加: 1.78GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 130, 512, 512), 内存占用: 1.78GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.48s
处理完成后内存: 1.68GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.50s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.03s
Case FLARETs_0173_0000.nii.gz completed in 23.78s total (preprocess: 2.86s, inference: 17.89s, postprocess: 3.03s)
Step 4/4: Ready for next case...

=== Processing case 174/200: FLARETs_0174_0000.nii.gz ===
File FLARETs_0174_0000.nii.gz: 35.38 MB
Total file size: 35.38 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.31s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:06,  3.14it/s] 10%|█         | 2/20 [00:00<00:05,  3.14it/s] 15%|█▌        | 3/20 [00:00<00:05,  3.11it/s] 20%|██        | 4/20 [00:01<00:05,  3.10it/s] 25%|██▌       | 5/20 [00:01<00:04,  3.10it/s] 30%|███       | 6/20 [00:01<00:04,  3.11it/s] 35%|███▌      | 7/20 [00:02<00:04,  3.09it/s] 40%|████      | 8/20 [00:02<00:03,  3.09it/s] 45%|████▌     | 9/20 [00:02<00:03,  3.08it/s] 50%|█████     | 10/20 [00:03<00:03,  3.09it/s] 55%|█████▌    | 11/20 [00:03<00:02,  3.07it/s] 60%|██████    | 12/20 [00:03<00:02,  3.08it/s] 65%|██████▌   | 13/20 [00:04<00:02,  3.08it/s] 70%|███████   | 14/20 [00:04<00:01,  3.09it/s] 75%|███████▌  | 15/20 [00:04<00:01,  3.08it/s] 80%|████████  | 16/20 [00:05<00:01,  3.09it/s] 85%|████████▌ | 17/20 [00:05<00:00,  3.07it/s] 90%|█████████ | 18/20 [00:05<00:00,  3.08it/s] 95%|█████████▌| 19/20 [00:06<00:00,  3.07it/s]100%|██████████| 20/20 [00:06<00:00,  3.08it/s]100%|██████████| 20/20 [00:06<00:00,  3.09it/s]
Inference completed in 6.52s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.69GB
输入形状: (14, 230, 187, 187)
目标形状: (115, 512, 512)
预估内存需求: 1.57GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.7379679144385025, 2.7379679144385025]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.77s
重采样后内存: 3.27GB (增加: 1.57GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 115, 512, 512), 内存占用: 1.57GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.42s
处理完成后内存: 1.69GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.22s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.69s
Case FLARETs_0174_0000.nii.gz completed in 11.52s total (preprocess: 2.31s, inference: 6.52s, postprocess: 2.69s)
Step 4/4: Ready for next case...

=== Processing case 175/200: FLARETs_0175_0000.nii.gz ===
File FLARETs_0175_0000.nii.gz: 60.39 MB
Total file size: 60.39 MB
Step 1/4: Preprocessing...
Preprocessing completed in 5.05s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.00it/s]  6%|▌         | 2/36 [00:00<00:11,  2.99it/s]  8%|▊         | 3/36 [00:01<00:11,  2.99it/s] 11%|█         | 4/36 [00:01<00:10,  3.00it/s] 14%|█▍        | 5/36 [00:01<00:10,  2.99it/s] 17%|█▋        | 6/36 [00:02<00:10,  3.00it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.00it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.01it/s] 25%|██▌       | 9/36 [00:03<00:09,  3.00it/s] 28%|██▊       | 10/36 [00:03<00:08,  2.99it/s] 31%|███       | 11/36 [00:03<00:08,  3.00it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.01it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.01it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.01it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.01it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.02it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.02it/s] 50%|█████     | 18/36 [00:05<00:05,  3.01it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.01it/s] 56%|█████▌    | 20/36 [00:06<00:05,  2.98it/s] 58%|█████▊    | 21/36 [00:07<00:05,  2.97it/s] 61%|██████    | 22/36 [00:07<00:04,  2.97it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.00it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.01it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.02it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.01it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.02it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.02it/s] 81%|████████  | 29/36 [00:09<00:02,  3.02it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.03it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.03it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.02it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.01it/s] 94%|█████████▍| 34/36 [00:11<00:00,  2.99it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.00it/s]100%|██████████| 36/36 [00:11<00:00,  2.99it/s]100%|██████████| 36/36 [00:11<00:00,  3.00it/s]
Inference completed in 12.02s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.51GB
输入形状: (14, 161, 216, 216)
目标形状: (201, 512, 512)
预估内存需求: 2.75GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.2484472049689441, 2.3703703703703702, 2.3703703703703702]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.20s
重采样后内存: 4.26GB (增加: 2.75GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 201, 512, 512), 内存占用: 2.75GB
分块策略: 块大小=8, 预计块数=26
创建了 26 个处理块，每块约 8 切片
后处理进度: 6/26 块 (23.1%)
后处理进度: 12/26 块 (46.2%)
后处理进度: 18/26 块 (69.2%)
后处理进度: 24/26 块 (92.3%)
✅ 并行后处理完成
后处理耗时: 0.80s
处理完成后内存: 1.60GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 4.05s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.55s
Case FLARETs_0175_0000.nii.gz completed in 21.63s total (preprocess: 5.05s, inference: 12.02s, postprocess: 4.55s)
Step 4/4: Ready for next case...

=== Processing case 176/200: FLARETs_0176_0000.nii.gz ===
File FLARETs_0176_0000.nii.gz: 67.14 MB
Total file size: 67.14 MB
Step 1/4: Preprocessing...
Preprocessing completed in 4.98s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  3.00it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.99it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.99it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.00it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.02it/s] 38%|███▊      | 6/16 [00:01<00:03,  3.04it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.04it/s] 50%|█████     | 8/16 [00:02<00:02,  3.02it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.03it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.03it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.03it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.03it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.02it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.02it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.02it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]100%|██████████| 16/16 [00:05<00:00,  3.02it/s]
Inference completed in 5.33s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.52GB
输入形状: (14, 174, 180, 180)
目标形状: (218, 512, 512)
预估内存需求: 2.98GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.2528735632183907, 2.8444444444444446, 2.8444444444444446]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 3.35s
重采样后内存: 4.50GB (增加: 2.98GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 218, 512, 512), 内存占用: 2.98GB
分块策略: 块大小=9, 预计块数=25
创建了 25 个处理块，每块约 9 切片
后处理进度: 6/25 块 (24.0%)
后处理进度: 12/25 块 (48.0%)
后处理进度: 18/25 块 (72.0%)
后处理进度: 24/25 块 (96.0%)
✅ 并行后处理完成
后处理耗时: 0.75s
处理完成后内存: 1.62GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.05s
🎯 深度优化总耗时: 4.15s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 4.57s
Case FLARETs_0176_0000.nii.gz completed in 14.87s total (preprocess: 4.98s, inference: 5.33s, postprocess: 4.57s)
Step 4/4: Ready for next case...

=== Processing case 177/200: FLARETs_0177_0000.nii.gz ===
File FLARETs_0177_0000.nii.gz: 28.47 MB
Total file size: 28.47 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.16s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.04it/s]  4%|▍         | 2/45 [00:00<00:14,  3.04it/s]  7%|▋         | 3/45 [00:00<00:13,  3.04it/s]  9%|▉         | 4/45 [00:01<00:13,  3.04it/s] 11%|█         | 5/45 [00:01<00:13,  3.03it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.03it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.04it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.04it/s] 20%|██        | 9/45 [00:02<00:11,  3.03it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.03it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.04it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.04it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.03it/s] 31%|███       | 14/45 [00:04<00:10,  3.03it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.03it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.02it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.03it/s] 40%|████      | 18/45 [00:05<00:08,  3.03it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.04it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.05it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.03it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.03it/s] 51%|█████     | 23/45 [00:07<00:07,  3.03it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.04it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.04it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.05it/s] 60%|██████    | 27/45 [00:08<00:05,  3.05it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.05it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.05it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.04it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.04it/s] 71%|███████   | 32/45 [00:10<00:04,  3.05it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.04it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.04it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.05it/s] 80%|████████  | 36/45 [00:11<00:02,  3.04it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.03it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.03it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.02it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.03it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.04it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.04it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.04it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.04it/s]100%|██████████| 45/45 [00:14<00:00,  3.05it/s]100%|██████████| 45/45 [00:14<00:00,  3.04it/s]
Inference completed in 14.86s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.63GB
输入形状: (14, 204, 209, 209)
目标形状: (102, 512, 512)
预估内存需求: 1.39GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.449760765550239, 2.449760765550239]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.61s
重采样后内存: 3.02GB (增加: 1.39GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 102, 512, 512), 内存占用: 1.39GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.43s
处理完成后内存: 1.63GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 2.07s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.56s
Case FLARETs_0177_0000.nii.gz completed in 19.58s total (preprocess: 2.16s, inference: 14.86s, postprocess: 2.56s)
Step 4/4: Ready for next case...

=== Processing case 178/200: FLARETs_0178_0000.nii.gz ===
File FLARETs_0178_0000.nii.gz: 34.13 MB
Total file size: 34.13 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.43s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.05it/s]  6%|▌         | 2/36 [00:00<00:11,  3.04it/s]  8%|▊         | 3/36 [00:00<00:10,  3.05it/s] 11%|█         | 4/36 [00:01<00:10,  3.05it/s] 14%|█▍        | 5/36 [00:01<00:10,  3.05it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.06it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.06it/s] 22%|██▏       | 8/36 [00:02<00:09,  3.06it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.04it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.02it/s] 31%|███       | 11/36 [00:03<00:08,  3.03it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.03it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.03it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.05it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.04it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.04it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.04it/s] 50%|█████     | 18/36 [00:05<00:05,  3.05it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.06it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.05it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.05it/s] 61%|██████    | 22/36 [00:07<00:04,  3.05it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.03it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.02it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.04it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.05it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.05it/s] 78%|███████▊  | 28/36 [00:09<00:02,  3.06it/s] 81%|████████  | 29/36 [00:09<00:02,  3.06it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.06it/s] 86%|████████▌ | 31/36 [00:10<00:01,  3.05it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.06it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.05it/s] 94%|█████████▍| 34/36 [00:11<00:00,  3.05it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.04it/s]100%|██████████| 36/36 [00:11<00:00,  3.04it/s]100%|██████████| 36/36 [00:11<00:00,  3.05it/s]
Inference completed in 11.86s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.62GB
输入形状: (14, 189, 201, 201)
目标形状: (126, 512, 512)
预估内存需求: 1.72GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.6666666666666666, 2.5472636815920398, 2.5472636815920398]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.98s
重采样后内存: 3.34GB (增加: 1.72GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 126, 512, 512), 内存占用: 1.72GB
分块策略: 块大小=7, 预计块数=18
创建了 18 个处理块，每块约 7 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.52s
处理完成后内存: 1.62GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.53s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.99s
Case FLARETs_0178_0000.nii.gz completed in 17.28s total (preprocess: 2.43s, inference: 11.86s, postprocess: 2.99s)
Step 4/4: Ready for next case...

=== Processing case 179/200: FLARETs_0179_0000.nii.gz ===
File FLARETs_0179_0000.nii.gz: 25.02 MB
Total file size: 25.02 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.28s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.07it/s]  4%|▍         | 2/45 [00:00<00:13,  3.08it/s]  7%|▋         | 3/45 [00:00<00:13,  3.08it/s]  9%|▉         | 4/45 [00:01<00:13,  3.08it/s] 11%|█         | 5/45 [00:01<00:12,  3.10it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.10it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.11it/s] 18%|█▊        | 8/45 [00:02<00:11,  3.11it/s] 20%|██        | 9/45 [00:02<00:11,  3.12it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.12it/s] 24%|██▍       | 11/45 [00:03<00:10,  3.11it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.12it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.13it/s] 31%|███       | 14/45 [00:04<00:09,  3.12it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.09it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.04it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.03it/s] 40%|████      | 18/45 [00:05<00:08,  3.01it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.02it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.04it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.02it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.02it/s] 51%|█████     | 23/45 [00:07<00:07,  3.00it/s] 53%|█████▎    | 24/45 [00:07<00:07,  2.99it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.01it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.00it/s] 60%|██████    | 27/45 [00:08<00:06,  2.98it/s] 62%|██████▏   | 28/45 [00:09<00:05,  2.96it/s] 64%|██████▍   | 29/45 [00:09<00:05,  2.97it/s] 67%|██████▋   | 30/45 [00:09<00:05,  2.95it/s] 69%|██████▉   | 31/45 [00:10<00:04,  2.97it/s] 71%|███████   | 32/45 [00:10<00:04,  2.97it/s] 73%|███████▎  | 33/45 [00:10<00:04,  2.96it/s] 76%|███████▌  | 34/45 [00:11<00:03,  2.94it/s] 78%|███████▊  | 35/45 [00:11<00:03,  2.93it/s] 80%|████████  | 36/45 [00:11<00:03,  2.92it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.93it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.95it/s] 87%|████████▋ | 39/45 [00:12<00:02,  2.95it/s] 89%|████████▉ | 40/45 [00:13<00:01,  2.96it/s] 91%|█████████ | 41/45 [00:13<00:01,  2.97it/s] 93%|█████████▎| 42/45 [00:13<00:01,  2.96it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.94it/s] 98%|█████████▊| 44/45 [00:14<00:00,  2.94it/s]100%|██████████| 45/45 [00:14<00:00,  2.95it/s]100%|██████████| 45/45 [00:14<00:00,  3.01it/s]
Inference completed in 15.01s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.81GB
输入形状: (14, 202, 225, 225)
目标形状: (101, 512, 512)
预估内存需求: 1.38GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.2755555555555556, 2.2755555555555556]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.59s
重采样后内存: 3.19GB (增加: 1.38GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 101, 512, 512), 内存占用: 1.38GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.40s
处理完成后内存: 1.81GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.02s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.54s
Case FLARETs_0179_0000.nii.gz completed in 19.83s total (preprocess: 2.28s, inference: 15.01s, postprocess: 2.54s)
Step 4/4: Ready for next case...

=== Processing case 180/200: FLARETs_0180_0000.nii.gz ===
File FLARETs_0180_0000.nii.gz: 31.67 MB
Total file size: 31.67 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.64s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/54 [00:00<?, ?it/s]  2%|▏         | 1/54 [00:00<00:17,  2.98it/s]  4%|▎         | 2/54 [00:00<00:17,  3.00it/s]  6%|▌         | 3/54 [00:01<00:17,  3.00it/s]  7%|▋         | 4/54 [00:01<00:16,  3.01it/s]  9%|▉         | 5/54 [00:01<00:16,  3.02it/s] 11%|█         | 6/54 [00:01<00:15,  3.02it/s] 13%|█▎        | 7/54 [00:02<00:15,  3.04it/s] 15%|█▍        | 8/54 [00:02<00:15,  3.04it/s] 17%|█▋        | 9/54 [00:02<00:14,  3.03it/s] 19%|█▊        | 10/54 [00:03<00:14,  3.03it/s] 20%|██        | 11/54 [00:03<00:14,  3.04it/s] 22%|██▏       | 12/54 [00:03<00:13,  3.02it/s] 24%|██▍       | 13/54 [00:04<00:13,  3.04it/s] 26%|██▌       | 14/54 [00:04<00:13,  3.03it/s] 28%|██▊       | 15/54 [00:04<00:12,  3.04it/s] 30%|██▉       | 16/54 [00:05<00:12,  3.04it/s] 31%|███▏      | 17/54 [00:05<00:12,  3.06it/s] 33%|███▎      | 18/54 [00:05<00:11,  3.05it/s] 35%|███▌      | 19/54 [00:06<00:11,  3.05it/s] 37%|███▋      | 20/54 [00:06<00:11,  3.05it/s] 39%|███▉      | 21/54 [00:06<00:10,  3.06it/s] 41%|████      | 22/54 [00:07<00:10,  3.05it/s] 43%|████▎     | 23/54 [00:07<00:10,  3.07it/s] 44%|████▍     | 24/54 [00:07<00:09,  3.05it/s] 46%|████▋     | 25/54 [00:08<00:09,  3.06it/s] 48%|████▊     | 26/54 [00:08<00:09,  3.06it/s] 50%|█████     | 27/54 [00:08<00:08,  3.05it/s] 52%|█████▏    | 28/54 [00:09<00:08,  3.04it/s] 54%|█████▎    | 29/54 [00:09<00:08,  3.05it/s] 56%|█████▌    | 30/54 [00:09<00:07,  3.04it/s] 57%|█████▋    | 31/54 [00:10<00:07,  3.04it/s] 59%|█████▉    | 32/54 [00:10<00:07,  3.02it/s] 61%|██████    | 33/54 [00:10<00:06,  3.04it/s] 63%|██████▎   | 34/54 [00:11<00:06,  3.04it/s] 65%|██████▍   | 35/54 [00:11<00:06,  3.05it/s] 67%|██████▋   | 36/54 [00:11<00:05,  3.05it/s] 69%|██████▊   | 37/54 [00:12<00:05,  3.05it/s] 70%|███████   | 38/54 [00:12<00:05,  3.04it/s] 72%|███████▏  | 39/54 [00:12<00:04,  3.04it/s] 74%|███████▍  | 40/54 [00:13<00:04,  3.04it/s] 76%|███████▌  | 41/54 [00:13<00:04,  3.05it/s] 78%|███████▊  | 42/54 [00:13<00:03,  3.04it/s] 80%|███████▉  | 43/54 [00:14<00:03,  3.05it/s] 81%|████████▏ | 44/54 [00:14<00:03,  3.04it/s] 83%|████████▎ | 45/54 [00:14<00:02,  3.05it/s] 85%|████████▌ | 46/54 [00:15<00:02,  3.05it/s] 87%|████████▋ | 47/54 [00:15<00:02,  3.05it/s] 89%|████████▉ | 48/54 [00:15<00:01,  3.04it/s] 91%|█████████ | 49/54 [00:16<00:01,  3.05it/s] 93%|█████████▎| 50/54 [00:16<00:01,  3.05it/s] 94%|█████████▍| 51/54 [00:16<00:00,  3.06it/s] 96%|█████████▋| 52/54 [00:17<00:00,  3.05it/s] 98%|█████████▊| 53/54 [00:17<00:00,  3.06it/s]100%|██████████| 54/54 [00:17<00:00,  3.06it/s]100%|██████████| 54/54 [00:17<00:00,  3.04it/s]
Inference completed in 17.79s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.69GB
输入形状: (14, 244, 214, 214)
目标形状: (122, 512, 512)
预估内存需求: 1.67GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.392523364485981, 2.392523364485981]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.90s
重采样后内存: 3.36GB (增加: 1.67GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 122, 512, 512), 内存占用: 1.67GB
分块策略: 块大小=7, 预计块数=18
创建了 18 个处理块，每块约 7 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.51s
处理完成后内存: 1.72GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.44s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.98s
Case FLARETs_0180_0000.nii.gz completed in 23.42s total (preprocess: 2.64s, inference: 17.79s, postprocess: 2.98s)
Step 4/4: Ready for next case...

=== Processing case 181/200: FLARETs_0181_0000.nii.gz ===
File FLARETs_0181_0000.nii.gz: 35.87 MB
Total file size: 35.87 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.58s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:07,  2.99it/s]  8%|▊         | 2/24 [00:00<00:07,  3.03it/s] 12%|█▎        | 3/24 [00:00<00:06,  3.04it/s] 17%|█▋        | 4/24 [00:01<00:06,  3.05it/s] 21%|██        | 5/24 [00:01<00:06,  3.03it/s] 25%|██▌       | 6/24 [00:01<00:05,  3.05it/s] 29%|██▉       | 7/24 [00:02<00:05,  3.05it/s] 33%|███▎      | 8/24 [00:02<00:05,  3.06it/s] 38%|███▊      | 9/24 [00:02<00:04,  3.04it/s] 42%|████▏     | 10/24 [00:03<00:04,  3.04it/s] 46%|████▌     | 11/24 [00:03<00:04,  3.02it/s] 50%|█████     | 12/24 [00:03<00:03,  3.03it/s] 54%|█████▍    | 13/24 [00:04<00:03,  3.02it/s] 58%|█████▊    | 14/24 [00:04<00:03,  3.02it/s] 62%|██████▎   | 15/24 [00:04<00:02,  3.02it/s] 67%|██████▋   | 16/24 [00:05<00:02,  3.03it/s] 71%|███████   | 17/24 [00:05<00:02,  3.02it/s] 75%|███████▌  | 18/24 [00:05<00:01,  3.04it/s] 79%|███████▉  | 19/24 [00:06<00:01,  3.02it/s] 83%|████████▎ | 20/24 [00:06<00:01,  3.02it/s] 88%|████████▊ | 21/24 [00:06<00:00,  3.01it/s] 92%|█████████▏| 22/24 [00:07<00:00,  3.02it/s] 96%|█████████▌| 23/24 [00:07<00:00,  3.03it/s]100%|██████████| 24/24 [00:07<00:00,  3.03it/s]100%|██████████| 24/24 [00:07<00:00,  3.03it/s]
Inference completed in 7.97s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.65GB
输入形状: (14, 266, 191, 191)
目标形状: (133, 512, 512)
预估内存需求: 1.82GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.680628272251309, 2.680628272251309]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 2.07s
重采样后内存: 3.47GB (增加: 1.82GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 133, 512, 512), 内存占用: 1.82GB
分块策略: 块大小=8, 预计块数=17
创建了 17 个处理块，每块约 8 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.53s
处理完成后内存: 1.68GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.63s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 3.14s
Case FLARETs_0181_0000.nii.gz completed in 13.68s total (preprocess: 2.58s, inference: 7.97s, postprocess: 3.14s)
Step 4/4: Ready for next case...

=== Processing case 182/200: FLARETs_0182_0000.nii.gz ===
File FLARETs_0182_0000.nii.gz: 33.94 MB
Total file size: 33.94 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.50s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.01it/s]  4%|▍         | 2/45 [00:00<00:14,  3.02it/s]  7%|▋         | 3/45 [00:00<00:13,  3.03it/s]  9%|▉         | 4/45 [00:01<00:13,  3.04it/s] 11%|█         | 5/45 [00:01<00:13,  3.04it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.04it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.03it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.03it/s] 20%|██        | 9/45 [00:02<00:11,  3.03it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.04it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.05it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.05it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.05it/s] 31%|███       | 14/45 [00:04<00:10,  3.04it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.02it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.03it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.03it/s] 40%|████      | 18/45 [00:05<00:08,  3.03it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.03it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.04it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.04it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.03it/s] 51%|█████     | 23/45 [00:07<00:07,  3.02it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.03it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.03it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.03it/s] 60%|██████    | 27/45 [00:08<00:05,  3.02it/s] 62%|██████▏   | 28/45 [00:09<00:05,  2.97it/s] 64%|██████▍   | 29/45 [00:09<00:05,  2.95it/s] 67%|██████▋   | 30/45 [00:09<00:05,  2.92it/s] 69%|██████▉   | 31/45 [00:10<00:04,  2.93it/s] 71%|███████   | 32/45 [00:10<00:04,  2.93it/s] 73%|███████▎  | 33/45 [00:10<00:04,  2.93it/s] 76%|███████▌  | 34/45 [00:11<00:03,  2.94it/s] 78%|███████▊  | 35/45 [00:11<00:03,  2.92it/s] 80%|████████  | 36/45 [00:12<00:03,  2.91it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.89it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.89it/s] 87%|████████▋ | 39/45 [00:13<00:02,  2.87it/s] 89%|████████▉ | 40/45 [00:13<00:01,  2.87it/s] 91%|█████████ | 41/45 [00:13<00:01,  2.86it/s] 93%|█████████▎| 42/45 [00:14<00:01,  2.87it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.87it/s] 98%|█████████▊| 44/45 [00:14<00:00,  2.87it/s]100%|██████████| 45/45 [00:15<00:00,  2.88it/s]100%|██████████| 45/45 [00:15<00:00,  2.97it/s]
Inference completed in 15.20s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.65GB
输入形状: (14, 228, 208, 208)
目标形状: (114, 512, 512)
预估内存需求: 1.56GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.4615384615384617, 2.4615384615384617]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.86s
重采样后内存: 3.21GB (增加: 1.56GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 114, 512, 512), 内存占用: 1.56GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.40s
处理完成后内存: 1.74GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.29s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.81s
Case FLARETs_0182_0000.nii.gz completed in 20.50s total (preprocess: 2.50s, inference: 15.20s, postprocess: 2.81s)
Step 4/4: Ready for next case...

=== Processing case 183/200: FLARETs_0183_0000.nii.gz ===
File FLARETs_0183_0000.nii.gz: 26.90 MB
Total file size: 26.90 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.77s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.05it/s]  4%|▍         | 2/45 [00:00<00:14,  3.05it/s]  7%|▋         | 3/45 [00:00<00:13,  3.05it/s]  9%|▉         | 4/45 [00:01<00:13,  3.05it/s] 11%|█         | 5/45 [00:01<00:13,  3.04it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.03it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.04it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.05it/s] 20%|██        | 9/45 [00:02<00:11,  3.03it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.03it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.01it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.01it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.02it/s] 31%|███       | 14/45 [00:04<00:10,  3.02it/s] 33%|███▎      | 15/45 [00:04<00:09,  3.02it/s] 36%|███▌      | 16/45 [00:05<00:09,  3.02it/s] 38%|███▊      | 17/45 [00:05<00:09,  3.02it/s] 40%|████      | 18/45 [00:05<00:08,  3.03it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.02it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.03it/s] 47%|████▋     | 21/45 [00:06<00:07,  3.02it/s] 49%|████▉     | 22/45 [00:07<00:07,  3.03it/s] 51%|█████     | 23/45 [00:07<00:07,  3.03it/s] 53%|█████▎    | 24/45 [00:07<00:06,  3.03it/s] 56%|█████▌    | 25/45 [00:08<00:06,  3.01it/s] 58%|█████▊    | 26/45 [00:08<00:06,  3.03it/s] 60%|██████    | 27/45 [00:08<00:05,  3.03it/s] 62%|██████▏   | 28/45 [00:09<00:05,  3.05it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.04it/s] 67%|██████▋   | 30/45 [00:09<00:04,  3.04it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.03it/s] 71%|███████   | 32/45 [00:10<00:04,  3.03it/s] 73%|███████▎  | 33/45 [00:10<00:03,  3.04it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.05it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.05it/s] 80%|████████  | 36/45 [00:11<00:02,  3.04it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.03it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.04it/s] 87%|████████▋ | 39/45 [00:12<00:01,  3.04it/s] 89%|████████▉ | 40/45 [00:13<00:01,  3.05it/s] 91%|█████████ | 41/45 [00:13<00:01,  3.05it/s] 93%|█████████▎| 42/45 [00:13<00:00,  3.04it/s] 96%|█████████▌| 43/45 [00:14<00:00,  3.05it/s] 98%|█████████▊| 44/45 [00:14<00:00,  3.06it/s]100%|██████████| 45/45 [00:14<00:00,  3.06it/s]100%|██████████| 45/45 [00:14<00:00,  3.04it/s]
Inference completed in 14.89s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.75GB
输入形状: (14, 208, 250, 250)
目标形状: (104, 512, 512)
预估内存需求: 1.42GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.63s
重采样后内存: 3.17GB (增加: 1.42GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 104, 512, 512), 内存占用: 1.42GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.44s
处理完成后内存: 1.80GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 2.09s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.67s
Case FLARETs_0183_0000.nii.gz completed in 20.33s total (preprocess: 2.77s, inference: 14.89s, postprocess: 2.67s)
Step 4/4: Ready for next case...

=== Processing case 184/200: FLARETs_0184_0000.nii.gz ===
File FLARETs_0184_0000.nii.gz: 38.05 MB
Total file size: 38.05 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.35s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:07,  3.02it/s]  8%|▊         | 2/24 [00:00<00:07,  2.99it/s] 12%|█▎        | 3/24 [00:00<00:06,  3.01it/s] 17%|█▋        | 4/24 [00:01<00:06,  3.00it/s] 21%|██        | 5/24 [00:01<00:06,  3.00it/s] 25%|██▌       | 6/24 [00:01<00:05,  3.00it/s] 29%|██▉       | 7/24 [00:02<00:05,  3.00it/s] 33%|███▎      | 8/24 [00:02<00:05,  3.00it/s] 38%|███▊      | 9/24 [00:02<00:04,  3.01it/s] 42%|████▏     | 10/24 [00:03<00:04,  3.01it/s] 46%|████▌     | 11/24 [00:03<00:04,  3.00it/s] 50%|█████     | 12/24 [00:04<00:04,  2.98it/s] 54%|█████▍    | 13/24 [00:04<00:03,  2.99it/s] 58%|█████▊    | 14/24 [00:04<00:03,  2.99it/s] 62%|██████▎   | 15/24 [00:05<00:03,  2.99it/s] 67%|██████▋   | 16/24 [00:05<00:02,  2.98it/s] 71%|███████   | 17/24 [00:05<00:02,  2.97it/s] 75%|███████▌  | 18/24 [00:06<00:02,  2.98it/s] 79%|███████▉  | 19/24 [00:06<00:01,  2.99it/s] 83%|████████▎ | 20/24 [00:06<00:01,  2.99it/s] 88%|████████▊ | 21/24 [00:07<00:01,  2.99it/s] 92%|█████████▏| 22/24 [00:07<00:00,  2.98it/s] 96%|█████████▌| 23/24 [00:07<00:00,  2.98it/s]100%|██████████| 24/24 [00:08<00:00,  2.98it/s]100%|██████████| 24/24 [00:08<00:00,  2.99it/s]
Inference completed in 8.07s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.57GB
输入形状: (14, 248, 173, 173)
目标形状: (124, 512, 512)
预估内存需求: 1.70GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.959537572254335, 2.959537572254335]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.92s
重采样后内存: 3.26GB (增加: 1.70GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 124, 512, 512), 内存占用: 1.70GB
分块策略: 块大小=7, 预计块数=18
创建了 18 个处理块，每块约 7 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.51s
处理完成后内存: 1.58GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.47s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.93s
Case FLARETs_0184_0000.nii.gz completed in 13.35s total (preprocess: 2.35s, inference: 8.07s, postprocess: 2.93s)
Step 4/4: Ready for next case...

=== Processing case 185/200: FLARETs_0185_0000.nii.gz ===
File FLARETs_0185_0000.nii.gz: 34.83 MB
Total file size: 34.83 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.30s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:06,  3.02it/s] 10%|█         | 2/20 [00:00<00:05,  3.05it/s] 15%|█▌        | 3/20 [00:00<00:05,  3.05it/s] 20%|██        | 4/20 [00:01<00:05,  3.05it/s] 25%|██▌       | 5/20 [00:01<00:04,  3.04it/s] 30%|███       | 6/20 [00:01<00:04,  3.05it/s] 35%|███▌      | 7/20 [00:02<00:04,  3.05it/s] 40%|████      | 8/20 [00:02<00:03,  3.04it/s] 45%|████▌     | 9/20 [00:02<00:03,  3.05it/s] 50%|█████     | 10/20 [00:03<00:03,  3.05it/s] 55%|█████▌    | 11/20 [00:03<00:02,  3.03it/s] 60%|██████    | 12/20 [00:03<00:02,  3.04it/s] 65%|██████▌   | 13/20 [00:04<00:02,  3.03it/s] 70%|███████   | 14/20 [00:04<00:01,  3.05it/s] 75%|███████▌  | 15/20 [00:04<00:01,  3.04it/s] 80%|████████  | 16/20 [00:05<00:01,  3.05it/s] 85%|████████▌ | 17/20 [00:05<00:00,  3.06it/s] 90%|█████████ | 18/20 [00:05<00:00,  3.05it/s] 95%|█████████▌| 19/20 [00:06<00:00,  3.05it/s]100%|██████████| 20/20 [00:06<00:00,  3.06it/s]100%|██████████| 20/20 [00:06<00:00,  3.05it/s]
Inference completed in 6.60s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.62GB
输入形状: (14, 238, 180, 180)
目标形状: (119, 512, 512)
预估内存需求: 1.63GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.8444444444444446, 2.8444444444444446]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.85s
重采样后内存: 3.25GB (增加: 1.63GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 119, 512, 512), 内存占用: 1.63GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.51s
处理完成后内存: 1.62GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.39s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.86s
Case FLARETs_0185_0000.nii.gz completed in 11.76s total (preprocess: 2.30s, inference: 6.60s, postprocess: 2.86s)
Step 4/4: Ready for next case...

=== Processing case 186/200: FLARETs_0186_0000.nii.gz ===
File FLARETs_0186_0000.nii.gz: 24.19 MB
Total file size: 24.19 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.59s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  3.01it/s]  4%|▍         | 2/45 [00:00<00:14,  3.02it/s]  7%|▋         | 3/45 [00:00<00:13,  3.05it/s]  9%|▉         | 4/45 [00:01<00:13,  3.06it/s] 11%|█         | 5/45 [00:01<00:13,  3.05it/s] 13%|█▎        | 6/45 [00:01<00:12,  3.05it/s] 16%|█▌        | 7/45 [00:02<00:12,  3.06it/s] 18%|█▊        | 8/45 [00:02<00:12,  3.06it/s] 20%|██        | 9/45 [00:02<00:11,  3.07it/s] 22%|██▏       | 10/45 [00:03<00:11,  3.06it/s] 24%|██▍       | 11/45 [00:03<00:11,  3.08it/s] 27%|██▋       | 12/45 [00:03<00:10,  3.07it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.08it/s] 31%|███       | 14/45 [00:04<00:10,  3.03it/s] 33%|███▎      | 15/45 [00:04<00:10,  2.99it/s] 36%|███▌      | 16/45 [00:05<00:09,  2.94it/s] 38%|███▊      | 17/45 [00:05<00:09,  2.92it/s] 40%|████      | 18/45 [00:05<00:09,  2.93it/s] 42%|████▏     | 19/45 [00:06<00:08,  2.92it/s] 44%|████▍     | 20/45 [00:06<00:08,  2.92it/s] 47%|████▋     | 21/45 [00:07<00:08,  2.91it/s] 49%|████▉     | 22/45 [00:07<00:07,  2.92it/s] 51%|█████     | 23/45 [00:07<00:07,  2.96it/s] 53%|█████▎    | 24/45 [00:08<00:07,  2.94it/s] 56%|█████▌    | 25/45 [00:08<00:06,  2.95it/s] 58%|█████▊    | 26/45 [00:08<00:06,  2.95it/s] 60%|██████    | 27/45 [00:09<00:06,  2.93it/s] 62%|██████▏   | 28/45 [00:09<00:05,  2.91it/s] 64%|██████▍   | 29/45 [00:09<00:05,  2.90it/s] 67%|██████▋   | 30/45 [00:10<00:05,  2.89it/s] 69%|██████▉   | 31/45 [00:10<00:04,  2.89it/s] 71%|███████   | 32/45 [00:10<00:04,  2.89it/s] 73%|███████▎  | 33/45 [00:11<00:04,  2.90it/s] 76%|███████▌  | 34/45 [00:11<00:03,  2.90it/s] 78%|███████▊  | 35/45 [00:11<00:03,  2.92it/s] 80%|████████  | 36/45 [00:12<00:03,  2.91it/s] 82%|████████▏ | 37/45 [00:12<00:02,  2.91it/s] 84%|████████▍ | 38/45 [00:12<00:02,  2.90it/s] 87%|████████▋ | 39/45 [00:13<00:02,  2.89it/s] 89%|████████▉ | 40/45 [00:13<00:01,  2.89it/s] 91%|█████████ | 41/45 [00:13<00:01,  2.88it/s] 93%|█████████▎| 42/45 [00:14<00:01,  2.89it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.89it/s] 98%|█████████▊| 44/45 [00:14<00:00,  2.88it/s]100%|██████████| 45/45 [00:15<00:00,  2.88it/s]100%|██████████| 45/45 [00:15<00:00,  2.95it/s]
Inference completed in 15.33s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.88GB
输入形状: (14, 202, 250, 250)
目标形状: (101, 512, 512)
预估内存需求: 1.38GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.61s
重采样后内存: 3.26GB (增加: 1.38GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 101, 512, 512), 内存占用: 1.38GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.41s
处理完成后内存: 1.88GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 2.04s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.62s
Case FLARETs_0186_0000.nii.gz completed in 20.54s total (preprocess: 2.59s, inference: 15.33s, postprocess: 2.62s)
Step 4/4: Ready for next case...

=== Processing case 187/200: FLARETs_0187_0000.nii.gz ===
File FLARETs_0187_0000.nii.gz: 27.28 MB
Total file size: 27.28 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.72s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:14,  2.97it/s]  4%|▍         | 2/45 [00:00<00:14,  2.96it/s]  7%|▋         | 3/45 [00:01<00:14,  2.99it/s]  9%|▉         | 4/45 [00:01<00:13,  2.98it/s] 11%|█         | 5/45 [00:01<00:13,  2.99it/s] 13%|█▎        | 6/45 [00:02<00:13,  2.98it/s] 16%|█▌        | 7/45 [00:02<00:12,  2.98it/s] 18%|█▊        | 8/45 [00:02<00:12,  2.99it/s] 20%|██        | 9/45 [00:03<00:12,  2.98it/s] 22%|██▏       | 10/45 [00:03<00:11,  2.98it/s] 24%|██▍       | 11/45 [00:03<00:11,  2.98it/s] 27%|██▋       | 12/45 [00:04<00:11,  2.99it/s] 29%|██▉       | 13/45 [00:04<00:10,  3.00it/s] 31%|███       | 14/45 [00:04<00:10,  2.98it/s] 33%|███▎      | 15/45 [00:05<00:10,  2.97it/s] 36%|███▌      | 16/45 [00:05<00:09,  2.96it/s] 38%|███▊      | 17/45 [00:05<00:09,  2.97it/s] 40%|████      | 18/45 [00:06<00:09,  2.98it/s] 42%|████▏     | 19/45 [00:06<00:08,  3.00it/s] 44%|████▍     | 20/45 [00:06<00:08,  3.01it/s] 47%|████▋     | 21/45 [00:07<00:07,  3.00it/s] 49%|████▉     | 22/45 [00:07<00:07,  2.99it/s] 51%|█████     | 23/45 [00:07<00:07,  2.98it/s] 53%|█████▎    | 24/45 [00:08<00:07,  2.97it/s] 56%|█████▌    | 25/45 [00:08<00:06,  2.97it/s] 58%|█████▊    | 26/45 [00:08<00:06,  2.98it/s] 60%|██████    | 27/45 [00:09<00:06,  2.99it/s] 62%|██████▏   | 28/45 [00:09<00:05,  2.98it/s] 64%|██████▍   | 29/45 [00:09<00:05,  3.00it/s] 67%|██████▋   | 30/45 [00:10<00:05,  3.00it/s] 69%|██████▉   | 31/45 [00:10<00:04,  3.00it/s] 71%|███████   | 32/45 [00:10<00:04,  3.00it/s] 73%|███████▎  | 33/45 [00:11<00:04,  2.99it/s] 76%|███████▌  | 34/45 [00:11<00:03,  3.00it/s] 78%|███████▊  | 35/45 [00:11<00:03,  3.02it/s] 80%|████████  | 36/45 [00:12<00:02,  3.01it/s] 82%|████████▏ | 37/45 [00:12<00:02,  3.02it/s] 84%|████████▍ | 38/45 [00:12<00:02,  3.00it/s] 87%|████████▋ | 39/45 [00:13<00:02,  3.00it/s] 89%|████████▉ | 40/45 [00:13<00:01,  2.98it/s] 91%|█████████ | 41/45 [00:13<00:01,  2.97it/s] 93%|█████████▎| 42/45 [00:14<00:01,  2.97it/s] 96%|█████████▌| 43/45 [00:14<00:00,  2.97it/s] 98%|█████████▊| 44/45 [00:14<00:00,  2.96it/s]100%|██████████| 45/45 [00:15<00:00,  2.98it/s]100%|██████████| 45/45 [00:15<00:00,  2.99it/s]
Inference completed in 15.14s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.79GB
输入形状: (14, 212, 250, 250)
目标形状: (106, 512, 512)
预估内存需求: 1.45GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.048, 2.048]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.64s
重采样后内存: 3.24GB (增加: 1.45GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 106, 512, 512), 内存占用: 1.45GB
分块策略: 块大小=6, 预计块数=18
创建了 18 个处理块，每块约 6 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.43s
处理完成后内存: 1.79GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.09s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.68s
Case FLARETs_0187_0000.nii.gz completed in 20.54s total (preprocess: 2.72s, inference: 15.14s, postprocess: 2.68s)
Step 4/4: Ready for next case...

=== Processing case 188/200: FLARETs_0188_0000.nii.gz ===
File FLARETs_0188_0000.nii.gz: 22.09 MB
Total file size: 22.09 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.47s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:03,  3.00it/s] 17%|█▋        | 2/12 [00:00<00:03,  3.02it/s] 25%|██▌       | 3/12 [00:00<00:02,  3.02it/s] 33%|███▎      | 4/12 [00:01<00:02,  3.03it/s] 42%|████▏     | 5/12 [00:01<00:02,  3.01it/s] 50%|█████     | 6/12 [00:01<00:01,  3.03it/s] 58%|█████▊    | 7/12 [00:02<00:01,  3.02it/s] 67%|██████▋   | 8/12 [00:02<00:01,  3.03it/s] 75%|███████▌  | 9/12 [00:02<00:00,  3.03it/s] 83%|████████▎ | 10/12 [00:03<00:00,  3.02it/s] 92%|█████████▏| 11/12 [00:03<00:00,  3.02it/s]100%|██████████| 12/12 [00:03<00:00,  3.02it/s]100%|██████████| 12/12 [00:03<00:00,  3.02it/s]
Inference completed in 4.00s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.63GB
输入形状: (14, 158, 186, 186)
目标形状: (79, 512, 512)
预估内存需求: 1.08GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.752688172043011, 2.752688172043011]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.21s
重采样后内存: 2.71GB (增加: 1.08GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 79, 512, 512), 内存占用: 1.08GB
分块策略: 块大小=4, 预计块数=20
创建了 20 个处理块，每块约 4 切片
后处理进度: 5/20 块 (25.0%)
后处理进度: 10/20 块 (50.0%)
后处理进度: 15/20 块 (75.0%)
后处理进度: 20/20 块 (100.0%)
✅ 并行后处理完成
后处理耗时: 0.28s
处理完成后内存: 1.63GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.51s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 1.92s
Case FLARETs_0188_0000.nii.gz completed in 7.40s total (preprocess: 1.47s, inference: 4.00s, postprocess: 1.92s)
Step 4/4: Ready for next case...

=== Processing case 189/200: FLARETs_0189_0000.nii.gz ===
File FLARETs_0189_0000.nii.gz: 24.24 MB
Total file size: 24.24 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.41s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:05,  2.89it/s] 12%|█▎        | 2/16 [00:00<00:04,  2.98it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.99it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.00it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.01it/s] 38%|███▊      | 6/16 [00:02<00:03,  3.01it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.02it/s] 50%|█████     | 8/16 [00:02<00:02,  3.01it/s] 56%|█████▋    | 9/16 [00:02<00:02,  3.00it/s] 62%|██████▎   | 10/16 [00:03<00:01,  3.02it/s] 69%|██████▉   | 11/16 [00:03<00:01,  3.02it/s] 75%|███████▌  | 12/16 [00:03<00:01,  3.01it/s] 81%|████████▏ | 13/16 [00:04<00:00,  3.01it/s] 88%|████████▊ | 14/16 [00:04<00:00,  3.01it/s] 94%|█████████▍| 15/16 [00:04<00:00,  3.02it/s]100%|██████████| 16/16 [00:05<00:00,  3.01it/s]100%|██████████| 16/16 [00:05<00:00,  3.01it/s]
Inference completed in 5.35s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.55GB
输入形状: (14, 178, 158, 158)
目标形状: (89, 512, 512)
预估内存需求: 1.22GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 3.240506329113924, 3.240506329113924]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.40s
重采样后内存: 2.77GB (增加: 1.22GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 89, 512, 512), 内存占用: 1.22GB
分块策略: 块大小=5, 预计块数=18
创建了 18 个处理块，每块约 5 切片
后处理进度: 4/18 块 (22.2%)
后处理进度: 8/18 块 (44.4%)
后处理进度: 12/18 块 (66.7%)
后处理进度: 16/18 块 (88.9%)
✅ 并行后处理完成
后处理耗时: 0.36s
处理完成后内存: 1.55GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.02s
🎯 深度优化总耗时: 1.79s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.18s
Case FLARETs_0189_0000.nii.gz completed in 8.94s total (preprocess: 1.41s, inference: 5.35s, postprocess: 2.18s)
Step 4/4: Ready for next case...

=== Processing case 190/200: FLARETs_0190_0000.nii.gz ===
File FLARETs_0190_0000.nii.gz: 30.13 MB
Total file size: 30.13 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.04s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:06,  3.00it/s] 10%|█         | 2/20 [00:00<00:05,  3.01it/s] 15%|█▌        | 3/20 [00:01<00:05,  3.00it/s] 20%|██        | 4/20 [00:01<00:05,  3.01it/s] 25%|██▌       | 5/20 [00:01<00:04,  3.02it/s] 30%|███       | 6/20 [00:01<00:04,  3.03it/s] 35%|███▌      | 7/20 [00:02<00:04,  3.03it/s] 40%|████      | 8/20 [00:02<00:03,  3.03it/s] 45%|████▌     | 9/20 [00:02<00:03,  3.04it/s] 50%|█████     | 10/20 [00:03<00:03,  3.04it/s] 55%|█████▌    | 11/20 [00:03<00:02,  3.03it/s] 60%|██████    | 12/20 [00:03<00:02,  3.03it/s] 65%|██████▌   | 13/20 [00:04<00:02,  3.02it/s] 70%|███████   | 14/20 [00:04<00:01,  3.01it/s] 75%|███████▌  | 15/20 [00:04<00:01,  3.03it/s] 80%|████████  | 16/20 [00:05<00:01,  3.02it/s] 85%|████████▌ | 17/20 [00:05<00:00,  3.03it/s] 90%|█████████ | 18/20 [00:05<00:00,  3.01it/s] 95%|█████████▌| 19/20 [00:06<00:00,  3.01it/s]100%|██████████| 20/20 [00:06<00:00,  3.02it/s]100%|██████████| 20/20 [00:06<00:00,  3.02it/s]
Inference completed in 6.66s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.59GB
输入形状: (14, 202, 190, 190)
目标形状: (101, 512, 512)
预估内存需求: 1.38GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.5, 2.694736842105263, 2.694736842105263]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.57s
重采样后内存: 2.98GB (增加: 1.38GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 101, 512, 512), 内存占用: 1.38GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.41s
处理完成后内存: 1.59GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.01s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.49s
Case FLARETs_0190_0000.nii.gz completed in 11.19s total (preprocess: 2.04s, inference: 6.66s, postprocess: 2.49s)
Step 4/4: Ready for next case...

=== Processing case 191/200: FLARETs_0191_0000.nii.gz ===
File FLARETs_0191_0000.nii.gz: 29.20 MB
Total file size: 29.20 MB
Step 1/4: Preprocessing...
Preprocessing completed in 1.24s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:02,  2.95it/s] 25%|██▌       | 2/8 [00:00<00:02,  2.90it/s] 38%|███▊      | 3/8 [00:01<00:01,  2.90it/s] 50%|█████     | 4/8 [00:01<00:01,  2.89it/s] 62%|██████▎   | 5/8 [00:01<00:01,  2.92it/s] 75%|███████▌  | 6/8 [00:02<00:00,  2.95it/s] 88%|████████▊ | 7/8 [00:02<00:00,  2.95it/s]100%|██████████| 8/8 [00:02<00:00,  2.94it/s]100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
Inference completed in 2.75s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.45GB
输入形状: (14, 101, 150, 150)
目标形状: (101, 512, 512)
预估内存需求: 1.38GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [1.0, 3.4133333333333336, 3.4133333333333336]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.66s
重采样后内存: 2.83GB (增加: 1.38GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 101, 512, 512), 内存占用: 1.38GB
分块策略: 块大小=6, 预计块数=17
创建了 17 个处理块，每块约 6 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.41s
处理完成后内存: 1.45GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.04s
🎯 深度优化总耗时: 2.11s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.49s
Case FLARETs_0191_0000.nii.gz completed in 6.49s total (preprocess: 1.24s, inference: 2.75s, postprocess: 2.49s)
Step 4/4: Ready for next case...

=== Processing case 192/200: FLARETs_0192_0000.nii.gz ===
File FLARETs_0192_0000.nii.gz: 34.15 MB
Total file size: 34.15 MB
Step 1/4: Preprocessing...
Preprocessing completed in 2.24s
perform_everything_on_device: False
Step 2/4: Neural network inference...
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:11,  3.12it/s]  6%|▌         | 2/36 [00:00<00:11,  3.06it/s]  8%|▊         | 3/36 [00:00<00:10,  3.10it/s] 11%|█         | 4/36 [00:01<00:10,  3.10it/s] 14%|█▍        | 5/36 [00:01<00:09,  3.12it/s] 17%|█▋        | 6/36 [00:01<00:09,  3.12it/s] 19%|█▉        | 7/36 [00:02<00:09,  3.12it/s] 22%|██▏       | 8/36 [00:02<00:08,  3.14it/s] 25%|██▌       | 9/36 [00:02<00:08,  3.14it/s] 28%|██▊       | 10/36 [00:03<00:08,  3.13it/s] 31%|███       | 11/36 [00:03<00:08,  3.12it/s] 33%|███▎      | 12/36 [00:03<00:07,  3.12it/s] 36%|███▌      | 13/36 [00:04<00:07,  3.12it/s] 39%|███▉      | 14/36 [00:04<00:07,  3.13it/s] 42%|████▏     | 15/36 [00:04<00:06,  3.14it/s] 44%|████▍     | 16/36 [00:05<00:06,  3.11it/s] 47%|████▋     | 17/36 [00:05<00:06,  3.11it/s] 50%|█████     | 18/36 [00:05<00:05,  3.11it/s] 53%|█████▎    | 19/36 [00:06<00:05,  3.12it/s] 56%|█████▌    | 20/36 [00:06<00:05,  3.12it/s] 58%|█████▊    | 21/36 [00:06<00:04,  3.11it/s] 61%|██████    | 22/36 [00:07<00:04,  3.10it/s] 64%|██████▍   | 23/36 [00:07<00:04,  3.09it/s] 67%|██████▋   | 24/36 [00:07<00:03,  3.12it/s] 69%|██████▉   | 25/36 [00:08<00:03,  3.12it/s] 72%|███████▏  | 26/36 [00:08<00:03,  3.12it/s] 75%|███████▌  | 27/36 [00:08<00:02,  3.12it/s] 78%|███████▊  | 28/36 [00:08<00:02,  3.12it/s] 81%|████████  | 29/36 [00:09<00:02,  3.12it/s] 83%|████████▎ | 30/36 [00:09<00:01,  3.12it/s] 86%|████████▌ | 31/36 [00:09<00:01,  3.12it/s] 89%|████████▉ | 32/36 [00:10<00:01,  3.11it/s] 92%|█████████▏| 33/36 [00:10<00:00,  3.11it/s] 94%|█████████▍| 34/36 [00:10<00:00,  3.10it/s] 97%|█████████▋| 35/36 [00:11<00:00,  3.09it/s]100%|██████████| 36/36 [00:11<00:00,  3.09it/s]100%|██████████| 36/36 [00:11<00:00,  3.11it/s]
Inference completed in 11.60s
Step 3/4: Postprocessing (resampling to original resolution)...
🚀 启动深度多线程后处理优化...
初始内存使用: 1.67GB
输入形状: (14, 172, 203, 203)
目标形状: (115, 512, 512)
预估内存需求: 1.57GB
📡 步骤1: 并行重采样...
🔄 使用 8 个线程并行重采样...
重采样缩放因子: [0.6686046511627907, 2.522167487684729, 2.522167487684729]
重采样进度: 3/14 (21.4%)
重采样进度: 6/14 (42.9%)
重采样进度: 9/14 (64.3%)
重采样进度: 12/14 (85.7%)
✅ 并行重采样完成
重采样耗时: 1.76s
重采样后内存: 3.24GB (增加: 1.57GB)
🔧 步骤2: 并行后处理...
🔄 使用 8 个线程并行后处理...
后处理数据形状: (14, 115, 512, 512), 内存占用: 1.57GB
分块策略: 块大小=7, 预计块数=17
创建了 17 个处理块，每块约 7 切片
后处理进度: 4/17 块 (23.5%)
后处理进度: 8/17 块 (47.1%)
后处理进度: 12/17 块 (70.6%)
后处理进度: 16/17 块 (94.1%)
✅ 并行后处理完成
后处理耗时: 0.42s
处理完成后内存: 1.67GB
💾 步骤4: 并行文件保存...
🔄 并行保存文件...
✅ 分割文件保存完成
文件保存耗时: 0.03s
🎯 深度优化总耗时: 2.21s
✅ 深度多线程后处理优化完成
Postprocessing and file saving completed in 2.65s
Case FLARETs_0192_0000.nii.gz completed in 16.49s total (preprocess: 2.24s, inference: 11.60s, postprocess: 2.65s)
Step 4/4: Ready for next case...

=== Processing case 193/200: FLARETs_0193_0000.nii.gz ===
File FLARETs_0193_0000.nii.gz: 133.11 MB
Total file size: 133.11 MB
⚠️  File size (133.11 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0193.nii.gz with shape (512, 512, 448)
✅ Dummy results generated: FLARETs_0193.nii.gz
Case FLARETs_0193_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 194/200: FLARETs_0194_0000.nii.gz ===
File FLARETs_0194_0000.nii.gz: 170.23 MB
Total file size: 170.23 MB
⚠️  File size (170.23 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0194.nii.gz with shape (512, 512, 554)
✅ Dummy results generated: FLARETs_0194.nii.gz
Case FLARETs_0194_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 195/200: FLARETs_0195_0000.nii.gz ===
File FLARETs_0195_0000.nii.gz: 135.09 MB
Total file size: 135.09 MB
⚠️  File size (135.09 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0195.nii.gz with shape (512, 512, 431)
✅ Dummy results generated: FLARETs_0195.nii.gz
Case FLARETs_0195_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 196/200: FLARETs_0196_0000.nii.gz ===
File FLARETs_0196_0000.nii.gz: 119.17 MB
Total file size: 119.17 MB
⚠️  File size (119.17 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0196.nii.gz with shape (512, 512, 372)
✅ Dummy results generated: FLARETs_0196.nii.gz
Case FLARETs_0196_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 197/200: FLARETs_0197_0000.nii.gz ===
File FLARETs_0197_0000.nii.gz: 143.15 MB
Total file size: 143.15 MB
⚠️  File size (143.15 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0197.nii.gz with shape (512, 512, 499)
✅ Dummy results generated: FLARETs_0197.nii.gz
Case FLARETs_0197_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 198/200: FLARETs_0198_0000.nii.gz ===
File FLARETs_0198_0000.nii.gz: 122.19 MB
Total file size: 122.19 MB
⚠️  File size (122.19 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0198.nii.gz with shape (512, 512, 391)
✅ Dummy results generated: FLARETs_0198.nii.gz
Case FLARETs_0198_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 199/200: FLARETs_0199_0000.nii.gz ===
File FLARETs_0199_0000.nii.gz: 172.17 MB
Total file size: 172.17 MB
⚠️  File size (172.17 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0199.nii.gz with shape (512, 512, 591)
✅ Dummy results generated: FLARETs_0199.nii.gz
Case FLARETs_0199_0000.nii.gz completed with dummy results (skipped due to size)

=== Processing case 200/200: FLARETs_0200_0000.nii.gz ===
File FLARETs_0200_0000.nii.gz: 104.47 MB
Total file size: 104.47 MB
⚠️  File size (104.47 MB) exceeds 70MB threshold
🚫 Skipping prediction to avoid memory overflow - generating dummy results...
Generated dummy segmentation: /home/fanggang_1/hk/nnunet/nnUNet/200CPUoutstudent/FLARETs_0200.nii.gz with shape (512, 512, 344)
✅ Dummy results generated: FLARETs_0200.nii.gz
Case FLARETs_0200_0000.nii.gz completed with dummy results (skipped due to size)
Exit status: 0
End time: 2025年 08月 04日 星期一 20:02:45 CST
==================== JOB FINISHED ====================
